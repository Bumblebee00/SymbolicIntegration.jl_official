file_rules = [
#(* ::Subsection::Closed:: *)
#(* 4.1.9 trig^m (a+b sin^n+c sin^(2 n))^p *)
("4_1_9_1",
@rule ∫(((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~p)) ?
1⨸(4^(~p)*(~c)^(~p))*∫(((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_2",
@rule ∫(((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~p)) ?
1⨸(4^(~p)*(~c)^(~p))*∫(((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_3",
@rule ∫(((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~p))) ?
((~a) + (~b)*sin((~d) + (~e)*(~x))^(~n) + (~c)*sin((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p))* ∫((~u)*((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_4",
@rule ∫(((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~p))) ?
((~a) + (~b)*cos((~d) + (~e)*(~x))^(~n) + (~c)*cos((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p))* ∫((~u)*((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_5",
@rule ∫(1/((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2)),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) ?
2*(~c)⨸rt((~b)^2 - 4*(~a)*(~c), 2)*∫(1⨸((~b) - rt((~b)^2 - 4*(~a)*(~c), 2) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n)), (~x)) - 2*(~c)⨸rt((~b)^2 - 4*(~a)*(~c), 2)*∫(1⨸((~b) + rt((~b)^2 - 4*(~a)*(~c), 2) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n)), (~x)) : nothing)

("4_1_9_6",
@rule ∫(1/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2)),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) ?
2*(~c)⨸rt((~b)^2 - 4*(~a)*(~c), 2)*∫(1⨸((~b) - rt((~b)^2 - 4*(~a)*(~c), 2) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n)), (~x)) - 2*(~c)⨸rt((~b)^2 - 4*(~a)*(~c), 2)*∫(1⨸((~b) + rt((~b)^2 - 4*(~a)*(~c), 2) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n)), (~x)) : nothing)

("4_1_9_7",
@rule ∫(sin((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~p)) ?
1⨸(4^(~p)*(~c)^(~p))*∫(sin((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_8",
@rule ∫(cos((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~p)) ?
1⨸(4^(~p)*(~c)^(~p))*∫(cos((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_9",
@rule ∫(sin((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~p))) ?
((~a) + (~b)*sin((~d) + (~e)*(~x))^(~n) + (~c)*sin((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p))* ∫(sin((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_10",
@rule ∫(cos((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~p))) ?
((~a) + (~b)*cos((~d) + (~e)*(~x))^(~n) + (~c)*cos((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p))* ∫(cos((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

# ("4_1_9_11",
# @rule ∫(sin((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~n2))^ (~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
#     eq((~n2), 2*(~n)) &&
#     ext_isinteger((~m)/2) &&
#     !eq((~b)^2 - 4*(~a)*(~c), 0) &&
#     ext_isinteger((~n)/2) &&
#     ext_isinteger((~p)) ?
# Module[{(~f) = free_factors(cot((~d) + (~e)*(~x)), (~x))}, -(~f)⨸(~e)* int_and_subst( expand_to_sum((~c) + (~b)*(1 + (~x)^2)^((~n)⨸2) + (~a)*(1 + (~x)^2)^(~n),  (~x))^ (~p)⨸(1 + (~f)^2*(~x)^2)^((~m)⨸2 + (~n)*(~p) + 1), (~x), (~x), cot((~d) + (~e)*(~x))⨸(~f), "4_1_9_11")] : nothing)
# 
# ("4_1_9_12",
# @rule ∫(cos((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~n2))^ (~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
#     eq((~n2), 2*(~n)) &&
#     ext_isinteger((~m)/2) &&
#     !eq((~b)^2 - 4*(~a)*(~c), 0) &&
#     ext_isinteger((~n)/2) &&
#     ext_isinteger((~p)) ?
# Module[{(~f) = free_factors(tan((~d) + (~e)*(~x)), (~x))}, (~f)⨸(~e)* int_and_subst( expand_to_sum((~c) + (~b)*(1 + (~x)^2)^((~n)⨸2) + (~a)*(1 + (~x)^2)^(~n),  (~x))^ (~p)⨸(1 + (~f)^2*(~x)^2)^((~m)⨸2 + (~n)*(~p) + 1), (~x), (~x), tan((~d) + (~e)*(~x))⨸(~f), "4_1_9_12")] : nothing)

("4_1_9_13",
@rule ∫(sin((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~m), (~n), (~p)) ?
∫(ext_expand( sin((~d) + (~e)*(~x))^(~m)*((~a) + (~b)*sin((~d) + (~e)*(~x))^(~n) + (~c)*sin((~d) + (~e)*(~x))^(2*(~n)))^(~p), (~x)), (~x)) : nothing)

("4_1_9_14",
@rule ∫(cos((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~m), (~n), (~p)) ?
∫(ext_expand( cos((~d) + (~e)*(~x))^(~m)*((~a) + (~b)*cos((~d) + (~e)*(~x))^(~n) + (~c)*cos((~d) + (~e)*(~x))^(2*(~n)))^(~p), (~x)), (~x)) : nothing)

# ("4_1_9_15",
# @rule ∫(cos((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*((~!f)*sin((~!d) + (~!e)*(~x)))^(~!n) + (~!c)*((~!f)*sin((~!d) + (~!e)*(~x)))^(~!n2))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~p), (~x)) &&
#     eq((~n2), 2*(~n)) &&
#     ext_isinteger(((~m) - 1)/2) ?
# Module[{(~g) = free_factors(sin((~d) + (~e)*(~x)), (~x))}, (~g)⨸(~e)* int_and_subst((1 - (~g)^2*(~x)^2)^(((~m) - 1)⨸2)*((~a) + (~b)*((~f)*(~g)*(~x))^(~n) + (~c)*((~f)*(~g)*(~x))^(2*(~n)))^(~p),  (~x), (~x), sin((~d) + (~e)*(~x))⨸(~g), "4_1_9_15")] : nothing)
# 
# ("4_1_9_16",
# @rule ∫(sin((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*((~!f)*cos((~!d) + (~!e)*(~x)))^(~!n) + (~!c)*((~!f)*cos((~!d) + (~!e)*(~x)))^(~!n2))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~p), (~x)) &&
#     eq((~n2), 2*(~n)) &&
#     ext_isinteger(((~m) - 1)/2) ?
# Module[{(~g) = free_factors(cos((~d) + (~e)*(~x)), (~x))}, -(~g)⨸(~e)* int_and_subst((1 - (~g)^2*(~x)^2)^(((~m) - 1)⨸2)*((~a) + (~b)*((~f)*(~g)*(~x))^(~n) + (~c)*((~f)*(~g)*(~x))^(2*(~n)))^(~p),  (~x), (~x), cos((~d) + (~e)*(~x))⨸(~g), "4_1_9_16")] : nothing)

("4_1_9_17",
@rule ∫(cos((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~p)) ?
1⨸(4^(~p)*(~c)^(~p))*∫(cos((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_18",
@rule ∫(sin((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~p)) ?
1⨸(4^(~p)*(~c)^(~p))*∫(sin((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_19",
@rule ∫(cos((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^ (~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~p))) ?
((~a) + (~b)*sin((~d) + (~e)*(~x))^(~n) + (~c)*sin((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p))* ∫(cos((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_20",
@rule ∫(sin((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^ (~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~p))) ?
((~a) + (~b)*cos((~d) + (~e)*(~x))^(~n) + (~c)*cos((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p))* ∫(sin((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

# ("4_1_9_21",
# @rule ∫(cos((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~n2))^ (~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
#     eq((~n2), 2*(~n)) &&
#     ext_isinteger((~m)/2) &&
#     !eq((~b)^2 - 4*(~a)*(~c), 0) &&
#     ext_isinteger((~n)/2) &&
#     ext_isinteger((~p)) ?
# Module[{(~f) = free_factors(cot((~d) + (~e)*(~x)), (~x))}, -(~f)^((~m) + 1)⨸(~e)* int_and_subst( (~x)^(~m)*expand_to_sum((~c) + (~b)*(1 + (~x)^2)^((~n)⨸2) + (~a)*(1 + (~x)^2)^(~n),  (~x))^ (~p)⨸(1 + (~f)^2*(~x)^2)^((~m)⨸2 + (~n)*(~p) + 1), (~x), (~x), cot((~d) + (~e)*(~x))⨸(~f), "4_1_9_21")] : nothing)
# 
# ("4_1_9_22",
# @rule ∫(sin((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~n2))^ (~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
#     eq((~n2), 2*(~n)) &&
#     ext_isinteger((~m)/2) &&
#     !eq((~b)^2 - 4*(~a)*(~c), 0) &&
#     ext_isinteger((~n)/2) &&
#     ext_isinteger((~p)) ?
# Module[{(~f) = free_factors(tan((~d) + (~e)*(~x)), (~x))}, (~f)^((~m) + 1)⨸(~e)* int_and_subst( (~x)^(~m)*expand_to_sum((~c) + (~b)*(1 + (~x)^2)^((~n)⨸2) + (~a)*(1 + (~x)^2)^(~n),  (~x))^ (~p)⨸(1 + (~f)^2*(~x)^2)^((~m)⨸2 + (~n)*(~p) + 1), (~x), (~x), tan((~d) + (~e)*(~x))⨸(~f), "4_1_9_22")] : nothing)

("4_1_9_23",
@rule ∫(cos((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~n2), 2*(~n)) &&
    ext_isinteger((~m)/2) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~n), (~p)) ?
∫(ext_expand((1 - sin((~d) + (~e)*(~x))^2)^((~m)⨸2)*((~a) + (~b)*sin((~d) + (~e)*(~x))^(~n) + (~c)*sin((~d) + (~e)*(~x))^(2*(~n)))^(~p), (~x)), (~x)) : nothing)

("4_1_9_24",
@rule ∫(sin((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~n2), 2*(~n)) &&
    ext_isinteger((~m)/2) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~n), (~p)) ?
∫(ext_expand((1 - cos((~d) + (~e)*(~x))^2)^((~m)⨸2)*((~a) + (~b)*cos((~d) + (~e)*(~x))^(~n) + (~c)*cos((~d) + (~e)*(~x))^(2*(~n)))^(~p), (~x)), (~x)) : nothing)

# ("4_1_9_25",
# @rule ∫(tan((~!d) + (~!e)*(~x))^ (~!m)*((~a) + (~!b)*((~!f)*sin((~!d) + (~!e)*(~x)))^(~n) + (~!c)*((~!f)*sin((~!d) + (~!e)*(~x)))^(~!n2))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~x)) &&
#     ext_isinteger(((~m) - 1)/2) &&
#     ext_isinteger(2*(~p)) ?
# Module[{(~g) = free_factors(sin((~d) + (~e)*(~x)), (~x))}, (~g)^((~m) + 1)⨸(~e)* int_and_subst( (~x)^(~m)*((~a) + (~b)*((~f)*(~g)*(~x))^(~n) + (~c)*((~f)*(~g)*(~x))^(2*(~n)))^ (~p)⨸(1 - (~g)^2*(~x)^2)^(((~m) + 1)⨸2),  (~x), (~x), sin((~d) + (~e)*(~x))⨸(~g), "4_1_9_25")] : nothing)
# 
# ("4_1_9_26",
# @rule ∫(cot((~!d) + (~!e)*(~x))^ (~!m)*((~a) + (~!b)*((~!f)*cos((~!d) + (~!e)*(~x)))^(~n) + (~!c)*((~!f)*cos((~!d) + (~!e)*(~x)))^(~!n2))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~x)) &&
#     ext_isinteger(((~m) - 1)/2) &&
#     ext_isinteger(2*(~p)) ?
# Module[{(~g) = free_factors(cos((~d) + (~e)*(~x)), (~x))}, -(~g)^((~m) + 1)⨸(~e)* int_and_subst( (~x)^(~m)*((~a) + (~b)*((~f)*(~g)*(~x))^(~n) + (~c)*((~f)*(~g)*(~x))^(2*(~n)))^ (~p)⨸(1 - (~g)^2*(~x)^2)^(((~m) + 1)⨸2),  (~x), (~x), cos((~d) + (~e)*(~x))⨸(~g), "4_1_9_26")] : nothing)

("4_1_9_27",
@rule ∫(tan((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~p)) ?
1⨸(4^(~p)*(~c)^(~p))*∫(tan((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_28",
@rule ∫(cot((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~p)) ?
1⨸(4^(~p)*(~c)^(~p))*∫(cot((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_29",
@rule ∫(tan((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^ (~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~p))) ?
((~a) + (~b)*sin((~d) + (~e)*(~x))^(~n) + (~c)*sin((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p))* ∫(tan((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_30",
@rule ∫(cot((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^ (~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~p))) ?
((~a) + (~b)*cos((~d) + (~e)*(~x))^(~n) + (~c)*cos((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p))* ∫(cot((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

# ("4_1_9_31",
# @rule ∫(tan((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~n2))^ (~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~x)) &&
#     eq((~n2), 2*(~n)) &&
#     !(ext_isinteger(((~m) - 1)/2)) &&
#     !eq((~b)^2 - 4*(~a)*(~c), 0) &&
#     ext_isinteger((~n)/2) &&
#     ext_isinteger((~p)) ?
# Module[{(~f) = free_factors(tan((~d) + (~e)*(~x)), (~x))}, (~f)^((~m) + 1)⨸(~e)* int_and_subst( (~x)^(~m)*expand_to_sum( (~c)*(~x)^(2*(~n)) + (~b)*(~x)^(~n)*(1 + (~x)^2)^((~n)⨸2) + (~a)*(1 + (~x)^2)^(~n),  (~x))^ (~p)⨸(1 + (~f)^2*(~x)^2)^((~n)*(~p) + 1), (~x), (~x), tan((~d) + (~e)*(~x))⨸(~f), "4_1_9_31")] : nothing)
# 
# ("4_1_9_32",
# @rule ∫(cot((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~n2))^ (~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~x)) &&
#     eq((~n2), 2*(~n)) &&
#     !(ext_isinteger(((~m) - 1)/2)) &&
#     !eq((~b)^2 - 4*(~a)*(~c), 0) &&
#     ext_isinteger((~n)/2) &&
#     ext_isinteger((~p)) ?
# Module[{(~f) = free_factors(cot((~d) + (~e)*(~x)), (~x))}, -(~f)^((~m) + 1)⨸(~e)* int_and_subst( (~x)^(~m)*expand_to_sum( (~c)*(~x)^(2*(~n)) + (~b)*(~x)^(~n)*(1 + (~x)^2)^((~n)⨸2) + (~a)*(1 + (~x)^2)^(~n),  (~x))^ (~p)⨸(1 + (~f)^2*(~x)^2)^((~n)*(~p) + 1), (~x), (~x), cot((~d) + (~e)*(~x))⨸(~f), "4_1_9_32")] : nothing)

("4_1_9_33",
@rule ∫(tan((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~n2), 2*(~n)) &&
    ext_isinteger((~m)/2) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~n), (~p)) ?
∫(ext_expand( sin((~d) + (~e)*(~x))^ (~m)*((~a) + (~b)*sin((~d) + (~e)*(~x))^(~n) + (~c)*sin((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸(1 - sin((~d) + (~e)*(~x))^2)^((~m)⨸2), (~x)), (~x)) : nothing)

("4_1_9_34",
@rule ∫(cot((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~n2), 2*(~n)) &&
    ext_isinteger((~m)/2) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~n), (~p)) ?
∫(ext_expand( cos((~d) + (~e)*(~x))^ (~m)*((~a) + (~b)*cos((~d) + (~e)*(~x))^(~n) + (~c)*cos((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸(1 - cos((~d) + (~e)*(~x))^2)^((~m)⨸2), (~x)), (~x)) : nothing)

# ("4_1_9_35",
# @rule ∫(cot((~!d) + (~!e)*(~x))^ (~!m)*((~a) + (~!b)*((~!f)*sin((~!d) + (~!e)*(~x)))^(~n) + (~!c)*((~!f)*sin((~!d) + (~!e)*(~x)))^(~!n2))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~x)) &&
#     ext_isinteger(((~m) - 1)/2) &&
#     ext_isinteger(2*(~p)) ?
# Module[{(~g) = free_factors(sin((~d) + (~e)*(~x)), (~x))}, (~g)^((~m) + 1)⨸(~e)* int_and_subst((1 - (~g)^2*(~x)^2)^(((~m) - 1)⨸ 2)*((~a) + (~b)*((~f)*(~g)*(~x))^(~n) + (~c)*((~f)*(~g)*(~x))^(2*(~n)))^(~p)⨸(~x)^(~m),  (~x), (~x), sin((~d) + (~e)*(~x))⨸(~g), "4_1_9_35")] : nothing)
# 
# ("4_1_9_36",
# @rule ∫(tan((~!d) + (~!e)*(~x))^ (~!m)*((~a) + (~!b)*((~!f)*cos((~!d) + (~!e)*(~x)))^(~n) + (~!c)*((~!f)*cos((~!d) + (~!e)*(~x)))^(~!n2))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~x)) &&
#     ext_isinteger(((~m) - 1)/2) &&
#     ext_isinteger(2*(~p)) ?
# Module[{(~g) = free_factors(cos((~d) + (~e)*(~x)), (~x))}, -(~g)^((~m) + 1)⨸(~e)* int_and_subst((1 - (~g)^2*(~x)^2)^(((~m) - 1)⨸ 2)*((~a) + (~b)*((~f)*(~g)*(~x))^(~n) + (~c)*((~f)*(~g)*(~x))^(2*(~n)))^(~p)⨸(~x)^(~m),  (~x), (~x), cos((~d) + (~e)*(~x))⨸(~g), "4_1_9_36")] : nothing)

("4_1_9_37",
@rule ∫(cot((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~p)) ?
1⨸(4^(~p)*(~c)^(~p))*∫(cot((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_38",
@rule ∫(tan((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~p)) ?
1⨸(4^(~p)*(~c)^(~p))*∫(tan((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_39",
@rule ∫(cot((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^ (~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~p))) ?
((~a) + (~b)*sin((~d) + (~e)*(~x))^(~n) + (~c)*sin((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p))* ∫(cot((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*sin((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

("4_1_9_40",
@rule ∫(tan((~!d) + (~!e)*(~x))^ (~m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^ (~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) &&
    eq((~n2), 2*(~n)) &&
    !(ext_isinteger(((~m) - 1)/2)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~p))) ?
((~a) + (~b)*cos((~d) + (~e)*(~x))^(~n) + (~c)*cos((~d) + (~e)*(~x))^(2*(~n)))^ (~p)⨸((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p))* ∫(tan((~d) + (~e)*(~x))^(~m)*((~b) + 2*(~c)*cos((~d) + (~e)*(~x))^(~n))^(2*(~p)), (~x)) : nothing)

# ("4_1_9_41",
# @rule ∫(cot((~!d) + (~!e)*(~x))^ (~!m)*((~a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~n2))^ (~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~x)) &&
#     eq((~n2), 2*(~n)) &&
#     ext_isinteger((~n)/2) &&
#     ext_isinteger((~p)) ?
# Module[{(~f) = free_factors(cot((~d) + (~e)*(~x)), (~x))}, -(~f)^((~m) + 1)⨸(~e)* int_and_subst( (~x)^(~m)*expand_to_sum((~c) + (~b)*(1 + (~f)^2*(~x)^2)^((~n)⨸2) + (~a)*(1 + (~f)^2*(~x)^2)^(~n),  (~x))^(~p)⨸(1 + (~f)^2*(~x)^2)^((~n)*(~p) + 1), (~x), (~x), cot((~d) + (~e)*(~x))⨸(~f), "4_1_9_41")] : nothing)
# 
# ("4_1_9_42",
# @rule ∫(tan((~!d) + (~!e)*(~x))^ (~!m)*((~a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~n2))^ (~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~x)) &&
#     eq((~n2), 2*(~n)) &&
#     ext_isinteger((~n)/2) &&
#     ext_isinteger((~p)) ?
# Module[{(~f) = free_factors(tan((~d) + (~e)*(~x)), (~x))}, (~f)^((~m) + 1)⨸(~e)* int_and_subst( (~x)^(~m)*expand_to_sum((~c) + (~b)*(1 + (~f)^2*(~x)^2)^((~n)⨸2) + (~a)*(1 + (~f)^2*(~x)^2)^(~n),  (~x))^(~p)⨸(1 + (~f)^2*(~x)^2)^((~n)*(~p) + 1), (~x), (~x), tan((~d) + (~e)*(~x))⨸(~f), "4_1_9_42")] : nothing)

("4_1_9_43",
@rule ∫(cot((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x))^(~!n) + (~!c)*sin((~!d) + (~!e)*(~x))^(~!n2))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~n2), 2*(~n)) &&
    ext_isinteger((~m)/2) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~n), (~p)) ?
∫(ext_expand((1 - sin((~d) + (~e)*(~x))^2)^((~m)⨸ 2)*((~a) + (~b)*sin((~d) + (~e)*(~x))^(~n) + (~c)*sin((~d) + (~e)*(~x))^(2*(~n)))^(~p)⨸ sin((~d) + (~e)*(~x))^(~m), (~x)), (~x)) : nothing)

("4_1_9_44",
@rule ∫(tan((~!d) + (~!e)*(~x))^ (~!m)*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x))^(~!n) + (~!c)*cos((~!d) + (~!e)*(~x))^(~!n2))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~n2), 2*(~n)) &&
    ext_isinteger((~m)/2) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~n), (~p)) ?
∫(ext_expand((1 - cos((~d) + (~e)*(~x))^2)^((~m)⨸ 2)*((~a) + (~b)*cos((~d) + (~e)*(~x))^(~n) + (~c)*cos((~d) + (~e)*(~x))^(2*(~n)))^(~p)⨸ cos((~d) + (~e)*(~x))^(~m), (~x)), (~x)) : nothing)

("4_1_9_45",
@rule ∫(((~A) + (~!B)*sin((~!d) + (~!e)*(~x)))*((~a) + (~!b)*sin((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))^2)^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~n)) ?
1⨸(4^(~n)*(~c)^(~n))* ∫(((~A) + (~B)*sin((~d) + (~e)*(~x)))*((~b) + 2*(~c)*sin((~d) + (~e)*(~x)))^(2*(~n)), (~x)) : nothing)

("4_1_9_46",
@rule ∫(((~A) + (~!B)*cos((~!d) + (~!e)*(~x)))*((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*cos((~!d) + (~!e)*(~x))^2)^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~n)) ?
1⨸(4^(~n)*(~c)^(~n))* ∫(((~A) + (~B)*cos((~d) + (~e)*(~x)))*((~b) + 2*(~c)*cos((~d) + (~e)*(~x)))^(2*(~n)), (~x)) : nothing)

("4_1_9_47",
@rule ∫(((~A) + (~!B)*sin((~!d) + (~!e)*(~x)))*((~a) + (~!b)*sin((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))^2)^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~n))) ?
((~a) + (~b)*sin((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))^2)^ (~n)⨸((~b) + 2*(~c)*sin((~d) + (~e)*(~x)))^(2*(~n))* ∫(((~A) + (~B)*sin((~d) + (~e)*(~x)))*((~b) + 2*(~c)*sin((~d) + (~e)*(~x)))^(2*(~n)), (~x)) : nothing)

("4_1_9_48",
@rule ∫(((~A) + (~!B)*cos((~!d) + (~!e)*(~x)))*((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*cos((~!d) + (~!e)*(~x))^2)^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    eq((~b)^2 - 4*(~a)*(~c), 0) &&
    !(ext_isinteger((~n))) ?
((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*cos((~d) + (~e)*(~x))^2)^ (~n)⨸((~b) + 2*(~c)*cos((~d) + (~e)*(~x)))^(2*(~n))* ∫(((~A) + (~B)*cos((~d) + (~e)*(~x)))*((~b) + 2*(~c)*cos((~d) + (~e)*(~x)))^(2*(~n)), (~x)) : nothing)

("4_1_9_49",
@rule ∫(((~A) + (~!B)*sin((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*sin((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))^2),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) ?
((~B) + ((~b)*(~B) - 2*(~A)*(~c))⨸rt((~b)^2 - 4*(~a)*(~c), 2))*∫(1⨸((~b) + rt((~b)^2 - 4*(~a)*(~c), 2) + 2*(~c)*sin((~d) + (~e)*(~x))), (~x)) + ((~B) - ((~b)*(~B) - 2*(~A)*(~c))⨸rt((~b)^2 - 4*(~a)*(~c), 2))*∫(1⨸((~b) - rt((~b)^2 - 4*(~a)*(~c), 2) + 2*(~c)*sin((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_9_50",
@rule ∫(((~A) + (~!B)*cos((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*cos((~!d) + (~!e)*(~x))^2),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) ?
((~B) + ((~b)*(~B) - 2*(~A)*(~c))⨸rt((~b)^2 - 4*(~a)*(~c), 2))*∫(1⨸((~b) + rt((~b)^2 - 4*(~a)*(~c), 2) + 2*(~c)*cos((~d) + (~e)*(~x))), (~x)) + ((~B) - ((~b)*(~B) - 2*(~A)*(~c))⨸rt((~b)^2 - 4*(~a)*(~c), 2))*∫(1⨸((~b) - rt((~b)^2 - 4*(~a)*(~c), 2) + 2*(~c)*cos((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_9_51",
@rule ∫(((~A) + (~!B)*sin((~!d) + (~!e)*(~x)))*((~!a) + (~!b)*sin((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))^2)^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~n)) ?
∫(ext_expand(((~A) + (~B)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*sin((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))^2)^(~n), (~x)), (~x)) : nothing)

("4_1_9_52",
@rule ∫(((~A) + (~!B)*cos((~!d) + (~!e)*(~x)))*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*cos((~!d) + (~!e)*(~x))^2)^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    !eq((~b)^2 - 4*(~a)*(~c), 0) &&
    ext_isinteger((~n)) ?
∫(ext_expand(((~A) + (~B)*cos((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*cos((~d) + (~e)*(~x))^2)^(~n), (~x)), (~x)) : nothing)


]
