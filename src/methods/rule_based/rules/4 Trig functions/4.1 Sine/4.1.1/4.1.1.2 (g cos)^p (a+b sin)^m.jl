file_rules = [
#(* ::Subsection::Closed:: *)
#(* 4.1.1.2 (g cos)^p (a+b sin)^m *)
("4_1_1_2_1",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~!p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~!m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~m), (~x)) &&
    ext_isinteger(((~p) - 1)/2) &&
    eq((~a)^2 - (~b)^2, 0) &&
    (
        ge((~p), -1) ||
        !(ext_isinteger((~m) + 1/2))
    ) ?
1⨸((~b)^(~p)*(~f))* int_and_subst(((~a) + (~x))^((~m) + ((~p) - 1)⨸2)*((~a) - (~x))^(((~p) - 1)⨸2),  (~x), (~x), (~b)*sin((~e) + (~f)*(~x)), "4_1_1_2_1") : nothing)

("4_1_1_2_2",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~!p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~!m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~m), (~x)) &&
    ext_isinteger(((~p) - 1)/2) &&
    !eq((~a)^2 - (~b)^2, 0) ?
1⨸((~b)^(~p)*(~f))* int_and_subst(((~a) + (~x))^(~m)*((~b)^2 - (~x)^2)^(((~p) - 1)⨸2),  (~x), (~x), (~b)*sin((~e) + (~f)*(~x)), "4_1_1_2_2") : nothing)

("4_1_1_2_3",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~p), (~x)) &&
    (
        ext_isinteger(2*(~p)) ||
        !eq((~a)^2 - (~b)^2, 0)
    ) ?
-(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)⨸((~f)*(~g)*((~p) + 1)) + (~a)*∫(((~g)*cos((~e) + (~f)*(~x)))^(~p), (~x)) : nothing)

("4_1_1_2_4",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m)) &&
    lt((~p), -1) &&
    ge(2*(~m) + (~p), 0) ?
((~a)⨸(~g))^(2*(~m))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(2*(~m) + (~p))⨸((~a) - (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) : nothing)

("4_1_1_2_5",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    eq(simplify((~m) + (~p) + 1), 0) &&
    !(ilt((~p), 0)) ?
(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)⨸((~a)*(~f)*(~g)*(~m)) : nothing)

("4_1_1_2_6",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ilt(simplify((~m) + (~p) + 1), 0) &&
    !eq(2*(~m) + (~p) + 1, 0) &&
    !(igt((~m), 0)) ?
(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸((~a)*(~f)*(~g)*simplify(2*(~m) + (~p) + 1)) + simplify((~m) + (~p) + 1)⨸((~a)*simplify(2*(~m) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1), (~x)) : nothing)

("4_1_1_2_7",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    eq(2*(~m) + (~p) - 1, 0) &&
    !eq((~m), 1) ?
(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)⨸((~f)* (~g)*((~m) - 1)) : nothing)

("4_1_1_2_8",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    igt(simplify((2*(~m) + (~p) - 1)/2), 0) &&
    !eq((~m) + (~p), 0) ?
-(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)⨸((~f)* (~g)*((~m) + (~p))) + (~a)*(2*(~m) + (~p) - 1)⨸((~m) + (~p))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1), (~x)) : nothing)

("4_1_1_2_9",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    gt((~m), 0) &&
    le((~p), -2*(~m)) &&
    ext_isinteger((~m) + 1/2, 2*(~p)) ?
-(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸((~a)*(~f)*(~g)*((~p) + 1)) + (~a)*((~m) + (~p) + 1)⨸((~g)^2*((~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1), (~x)) : nothing)

("4_1_1_2_10",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    gt((~m), 1) &&
    lt((~p), -1) &&
    ext_isinteger(2*(~m), 2*(~p)) ?
-2*(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)⨸((~f)* (~g)*((~p) + 1)) + (~b)^2*(2*(~m) + (~p) - 1)⨸((~g)^2*((~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 2), (~x)) : nothing)

("4_1_1_2_11",
@rule ∫(sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))/sqrt((~!g)*cos((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) ?
(~a)*sqrt(1 + cos((~e) + (~f)*(~x)))* sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸((~a) + (~a)*cos((~e) + (~f)*(~x)) + (~b)*sin((~e) + (~f)*(~x)))* ∫(sqrt(1 + cos((~e) + (~f)*(~x)))⨸sqrt((~g)*cos((~e) + (~f)*(~x))), (~x)) + (~b)*sqrt(1 + cos((~e) + (~f)*(~x)))* sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸((~a) + (~a)*cos((~e) + (~f)*(~x)) + (~b)*sin((~e) + (~f)*(~x)))* ∫(sin((~e) + (~f)*(~x))⨸(sqrt((~g)*cos((~e) + (~f)*(~x)))*sqrt(1 + cos((~e) + (~f)*(~x)))), (~x)) : nothing)

("4_1_1_2_12",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    gt((~m), 0) &&
    !eq((~m) + (~p), 0) &&
    ext_isinteger(2*(~m), 2*(~p)) ?
-(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)⨸((~f)* (~g)*((~m) + (~p))) + (~a)*(2*(~m) + (~p) - 1)⨸((~m) + (~p))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1), (~x)) : nothing)

("4_1_1_2_13",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    lt((~m), -1) &&
    gt((~p), 1) &&
    (
        gt((~m), -2) ||
        eq(2*(~m) + (~p) + 1, 0) ||
        eq((~m), -2) &&
        ext_isinteger((~p))
    ) &&
    !eq((~m) + (~p), 0) &&
    ext_isinteger(2*(~m), 2*(~p)) ?
(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~b)* (~f)*((~m) + (~p))) + (~g)^2*((~p) - 1)⨸((~a)*((~m) + (~p)))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1), (~x)) : nothing)

("4_1_1_2_14",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    le((~m), -2) &&
    gt((~p), 1) &&
    !eq(2*(~m) + (~p) + 1, 0) &&
    !(ilt((~m) + (~p) + 1, 0)) &&
    ext_isinteger(2*(~m), 2*(~p)) ?
2*(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~b)* (~f)*(2*(~m) + (~p) + 1)) + (~g)^2*((~p) - 1)⨸((~b)^2*(2*(~m) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 2), (~x)) : nothing)

("4_1_1_2_15",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    lt((~m), -1) &&
    !eq(2*(~m) + (~p) + 1, 0) &&
    ext_isinteger(2*(~m), 2*(~p)) ?
(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸((~a)*(~f)*(~g)*(2*(~m) + (~p) + 1)) + ((~m) + (~p) + 1)⨸((~a)*(2*(~m) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1), (~x)) : nothing)

("4_1_1_2_16",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    gt((~p), 1) &&
    ext_isinteger(2*(~p)) ?
(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)⨸((~b)*(~f)*((~p) - 1)) + (~g)^2⨸(~a)*∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2), (~x)) : nothing)

("4_1_1_2_17",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !(ge((~p), 1)) &&
    ext_isinteger(2*(~p)) ?
(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)⨸((~a)*(~f)*(~g)*((~p) - 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))) + (~p)⨸((~a)*((~p) - 1))*∫(((~g)*cos((~e) + (~f)*(~x)))^(~p), (~x)) : nothing)

("4_1_1_2_18",
@rule ∫(sqrt((~!g)*cos((~!e) + (~!f)*(~x)))/sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) ?
(~g)*sqrt(1 + cos((~e) + (~f)*(~x)))* sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸((~a) + (~a)*cos((~e) + (~f)*(~x)) + (~b)*sin((~e) + (~f)*(~x)))* ∫(sqrt(1 + cos((~e) + (~f)*(~x)))⨸sqrt((~g)*cos((~e) + (~f)*(~x))), (~x)) - (~g)*sqrt(1 + cos((~e) + (~f)*(~x)))* sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸((~b) + (~b)*cos((~e) + (~f)*(~x)) + (~a)*sin((~e) + (~f)*(~x)))* ∫(sin((~e) + (~f)*(~x))⨸(sqrt((~g)*cos((~e) + (~f)*(~x)))*sqrt(1 + cos((~e) + (~f)*(~x)))), (~x)) : nothing)

("4_1_1_2_19",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(3//2)/sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) ?
(~g)*sqrt((~g)*cos((~e) + (~f)*(~x)))*sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸((~b)*(~f)) + (~g)^2⨸(2*(~a))*∫(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸sqrt((~g)*cos((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_1_2_20",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)/sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    gt((~p), 2) &&
    ext_isinteger(2*(~p)) ?
-2*(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)⨸((~f)* (~g)*(2*(~p) - 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(3⨸2)) + 2*(~a)*((~p) - 2)⨸(2*(~p) - 1)* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)⨸((~a) + (~b)*sin((~e) + (~f)*(~x)))^(3⨸2), (~x)) : nothing)

("4_1_1_2_21",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)/sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    lt((~p), -1) &&
    ext_isinteger(2*(~p)) ?
-(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)⨸((~a)*(~f)*(~g)*((~p) + 1)* sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))) + (~a)*(2*(~p) + 1)⨸(2*(~g)^2*((~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)⨸((~a) + (~b)*sin((~e) + (~f)*(~x)))^(3⨸2), (~x)) : nothing)

("4_1_1_2_22",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~!m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m)) ?
(~a)^(~m)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)⨸((~f)* (~g)*(1 + sin((~e) + (~f)*(~x)))^(((~p) + 1)⨸2)*(1 - sin((~e) + (~f)*(~x)))^(((~p) + 1)⨸2))* int_and_subst((1 + (~b)⨸(~a)*(~x))^((~m) + ((~p) - 1)⨸2)*(1 - (~b)⨸(~a)*(~x))^(((~p) - 1)⨸2),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_1_2_22") : nothing)

("4_1_1_2_23",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~!m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !(ext_isinteger((~m))) ?
(~a)^2*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)⨸((~f)* (~g)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(((~p) + 1)⨸2)*((~a) - (~b)*sin((~e) + (~f)*(~x)))^(((~p) + 1)⨸2))* int_and_subst(((~a) + (~b)*(~x))^((~m) + ((~p) - 1)⨸2)*((~a) - (~b)*(~x))^(((~p) - 1)⨸2),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_1_2_23") : nothing)

("4_1_1_2_24",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    lt(0, (~m), 1) &&
    lt((~p), -1) &&
    (
        ext_isinteger(2*(~m), 2*(~p)) ||
        ext_isinteger((~m))
    ) ?
-((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)* sin((~e) + (~f)*(~x))⨸((~f)*(~g)*((~p) + 1)) + 1⨸((~g)^2*((~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~a)*((~p) + 2) + (~b)*((~m) + (~p) + 2)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_1_2_25",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    gt((~m), 1) &&
    lt((~p), -1) &&
    (
        ext_isinteger(2*(~m), 2*(~p)) ||
        ext_isinteger((~m))
    ) ?
-((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~b) + (~a)*sin((~e) + (~f)*(~x)))⨸((~f)*(~g)*((~p) + 1)) + 1⨸((~g)^2*((~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 2)*((~b)^2*((~m) - 1) + (~a)^2*((~p) + 2) + (~a)*(~b)*((~m) + (~p) + 1)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_1_2_26",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    gt((~m), 1) &&
    !eq((~m) + (~p), 0) &&
    (
        ext_isinteger(2*(~m), 2*(~p)) ||
        ext_isinteger((~m))
    ) ?
-(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)⨸((~f)* (~g)*((~m) + (~p))) + 1⨸((~m) + (~p))* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 2)*((~b)^2*((~m) - 1) + (~a)^2*((~m) + (~p)) + (~a)*(~b)*(2*(~m) + (~p) - 1)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_1_2_27",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    lt((~m), -1) &&
    gt((~p), 1) &&
    ext_isinteger(2*(~m), 2*(~p)) ?
(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~b)* (~f)*((~m) + 1)) + (~g)^2*((~p) - 1)⨸((~b)*((~m) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)* sin((~e) + (~f)*(~x)), (~x)) : nothing)

("4_1_1_2_28",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    lt((~m), -1) &&
    ext_isinteger(2*(~m), 2*(~p)) ?
-(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~f)* (~g)*((~a)^2 - (~b)^2)*((~m) + 1)) + 1⨸(((~a)^2 - (~b)^2)*((~m) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~a)*((~m) + 1) - (~b)*((~m) + (~p) + 2)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_1_2_29",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    gt((~p), 1) &&
    !eq((~m) + (~p), 0) &&
    ext_isinteger(2*(~m), 2*(~p)) ?
(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~b)* (~f)*((~m) + (~p))) + (~g)^2*((~p) - 1)⨸((~b)*((~m) + (~p)))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~b) + (~a)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_1_2_30",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    lt((~p), -1) &&
    ext_isinteger(2*(~m), 2*(~p)) ?
((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~b) - (~a)*sin((~e) + (~f)*(~x)))⨸((~f)*(~g)*((~a)^2 - (~b)^2)*((~p) + 1)) + 1⨸((~g)^2*((~a)^2 - (~b)^2)*((~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~a)^2*((~p) + 2) - (~b)^2*((~m) + (~p) + 2) + (~a)*(~b)*((~m) + (~p) + 3)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_1_2_31",
@rule ∫(1/(sqrt((~!g)*cos((~!e) + (~!f)*(~x)))*sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) ?
2*sqrt(2)*sqrt((~g)*cos((~e) + (~f)*(~x)))* sqrt(((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸(((~a) - (~b))*(1 - sin((~e) + (~f)*(~x)))))⨸ ((~f)*(~g)*sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))* sqrt((1 + cos((~e) + (~f)*(~x)) + sin((~e) + (~f)*(~x)))⨸(1 + cos((~e) + (~f)*(~x)) - sin((~e) + (~f)*(~x)))))* int_and_subst(1⨸sqrt(1 + ((~a) + (~b))*(~x)^4⨸((~a) - (~b))),  (~x), (~x), sqrt((1 + cos((~e) + (~f)*(~x)) + sin((~e) + (~f)*(~x)))⨸(1 + cos((~e) + (~f)*(~x)) - sin((~e) + (~f)*(~x)))), "4_1_1_2_31") : nothing)

("4_1_1_2_32",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    eq((~m) + (~p) + 1, 0) ?
(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)*(1 - sin((~e) + (~f)*(~x)))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*(-((~a) - (~b))*(1 - sin((~e) + (~f)*(~x)))⨸(((~a) + (~b))*(1 + sin((~e) + (~f)*(~x)))))^((~m)⨸2)⨸ ((~f)*((~a) + (~b))*((~m) + 1))* hypergeometric2f1((~m) + 1, (~m)⨸2 + 1, (~m) + 2, 2*((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸(((~a) + (~b))*(1 + sin((~e) + (~f)*(~x))))) : nothing)

("4_1_1_2_33",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    eq((~m) + (~p) + 2, 0) ?
((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~f)* (~g)*((~a) - (~b))*((~p) + 1)) + (~a)⨸((~g)^2*((~a) - (~b)))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸(1 - sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_1_2_34",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ilt((~m) + (~p) + 2, 0) ?
((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~f)* (~g)*((~a) - (~b))*((~p) + 1)) - (~b)*((~m) + (~p) + 2)⨸((~g)^2*((~a) - (~b))*((~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) + (~a)⨸((~g)^2*((~a) - (~b)))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸(1 - sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_1_2_35",
@rule ∫(sqrt((~!g)*cos((~!e) + (~!f)*(~x)))/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) ?
(~a)*(~g)⨸(2*(~b))*∫(1⨸(sqrt((~g)*cos((~e) + (~f)*(~x)))*(rt(-(~a)^2 + (~b)^2, 2) + (~b)*cos((~e) + (~f)*(~x)))), (~x)) - (~a)*(~g)⨸(2*(~b))* ∫(1⨸(sqrt((~g)*cos((~e) + (~f)*(~x)))*(rt(-(~a)^2 + (~b)^2, 2) - (~b)*cos((~e) + (~f)*(~x)))), (~x)) + (~b)*(~g)⨸(~f)* int_and_subst(sqrt((~x))⨸((~g)^2*((~a)^2 - (~b)^2) + (~b)^2*(~x)^2),  (~x), (~x), (~g)*cos((~e) + (~f)*(~x)), "4_1_1_2_35") : nothing)

("4_1_1_2_36",
@rule ∫(1/(sqrt((~!g)*cos((~!e) + (~!f)*(~x)))*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) ?
-(~a)⨸(2*rt(-(~a)^2 + (~b)^2, 2))* ∫(1⨸(sqrt((~g)*cos((~e) + (~f)*(~x)))*(rt(-(~a)^2 + (~b)^2, 2) + (~b)*cos((~e) + (~f)*(~x)))), (~x)) - (~a)⨸(2*rt(-(~a)^2 + (~b)^2, 2))* ∫(1⨸(sqrt((~g)*cos((~e) + (~f)*(~x)))*(rt(-(~a)^2 + (~b)^2, 2) - (~b)*cos((~e) + (~f)*(~x)))), (~x)) + (~b)*(~g)⨸(~f)* int_and_subst(1⨸(sqrt((~x))*((~g)^2*((~a)^2 - (~b)^2) + (~b)^2*(~x)^2)),  (~x), (~x), (~g)*cos((~e) + (~f)*(~x)), "4_1_1_2_36") : nothing)

("4_1_1_2_37",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ilt((~m), 0) &&
    !(igt((~m) + (~p) + 1, 0)) ?
(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸ ((~b)* (~f)*((~m) + (~p))*(-(~b)*(1 - sin((~e) + (~f)*(~x)))⨸((~a) + (~b)*sin((~e) + (~f)*(~x))))^(((~p) - 1)⨸ 2)*((~b)*(1 + sin((~e) + (~f)*(~x)))⨸((~a) + (~b)*sin((~e) + (~f)*(~x))))^(((~p) - 1)⨸2))* appell_f1(-(~p) - (~m), (1 - (~p))⨸2, (1 - (~p))⨸2, 1 - (~p) - (~m), ((~a) + (~b))⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), ((~a) - (~b))⨸((~a) + (~b)*sin((~e) + (~f)*(~x)))) : nothing)

("4_1_1_2_38",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !(igt((~m), 0)) ?
(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)⨸((~f)*(1 - ((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸((~a) - (~b)))^(((~p) - 1)⨸ 2)*(1 - ((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸((~a) + (~b)))^(((~p) - 1)⨸2))* int_and_subst((-(~b)⨸((~a) - (~b)) - (~b)*(~x)⨸((~a) - (~b)))^(((~p) - 1)⨸2)*((~b)⨸((~a) + (~b)) - (~b)*(~x)⨸((~a) + (~b)))^(((~p) - 1)⨸2)*((~a) + (~b)*(~x))^(~m),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_1_2_38") : nothing)

("4_1_1_2_39",
@rule ∫(((~!g)*sec((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~!m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    !(ext_isinteger((~p))) ?
(~g)^(2*intpart((~p)))*((~g)*cos((~e) + (~f)*(~x)))^fracpart((~p))*((~g)*sec((~e) + (~f)*(~x)))^ fracpart((~p))*∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)⨸((~g)*cos((~e) + (~f)*(~x)))^(~p), (~x)) : nothing)


]
