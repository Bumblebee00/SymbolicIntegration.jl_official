file_rules = [
#(* ::Subsection::Closed:: *)
#(* 4.1.5 trig^m (a cos+b sin)^n *)
("4_1_5_1",
@rule ∫(((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~n), (~x)) &&
    eq((~a)^2 + (~b)^2, 0) ?
(~a)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^(~n)⨸((~b)*(~d)*(~n)) : nothing)

("4_1_5_2",
@rule ∫(((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    igt(((~n) - 1)/2, 0) ?
-1⨸(~d)*int_and_subst(((~a)^2 + (~b)^2 - (~x)^2)^(((~n) - 1)⨸2),  (~x), (~x), (~b)*cos((~c) + (~d)*(~x)) - (~a)*sin((~c) + (~d)*(~x)), "4_1_5_2") : nothing)

("4_1_5_3",
@rule ∫(((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    !(ext_isinteger(((~n) - 1)/2)) &&
    gt((~n), 1) ?
-((~b)*cos((~c) + (~d)*(~x)) - (~a)*sin((~c) + (~d)*(~x)))*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 1)⨸((~d)* (~n)) + ((~n) - 1)*((~a)^2 + (~b)^2)⨸(~n)* ∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 2), (~x)) : nothing)

("4_1_5_4",
@rule ∫(1/((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) ?
-1⨸(~d)*int_and_subst(1⨸((~a)^2 + (~b)^2 - (~x)^2),  (~x), (~x), (~b)*cos((~c) + (~d)*(~x)) - (~a)*sin((~c) + (~d)*(~x)), "4_1_5_4") : nothing)

("4_1_5_5",
@rule ∫(1/((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^2,(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) ?
sin((~c) + (~d)*(~x))⨸((~a)*(~d)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))) : nothing)

("4_1_5_6",
@rule ∫(((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    lt((~n), -1) &&
    !eq((~n), -2) ?
((~b)*cos((~c) + (~d)*(~x)) - (~a)*sin((~c) + (~d)*(~x)))*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 1)⨸((~d)*((~n) + 1)*((~a)^2 + (~b)^2)) + ((~n) + 2)⨸(((~n) + 1)*((~a)^2 + (~b)^2))* ∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 2), (~x)) : nothing)

("4_1_5_7",
@rule ∫(((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~n), (~x)) &&
    !(
        ge((~n), 1) ||
        le((~n), -1)
    ) &&
    gt((~a)^2 + (~b)^2, 0) ?
((~a)^2 + (~b)^2)^((~n)⨸2)*∫((cos((~c) + (~d)*(~x) - atan((~a), (~b))))^(~n), (~x)) : nothing)

("4_1_5_8",
@rule ∫(((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~n), (~x)) &&
    !(
        ge((~n), 1) ||
        le((~n), -1)
    ) &&
    !(
        gt((~a)^2 + (~b)^2, 0) ||
        eq((~a)^2 + (~b)^2, 0)
    ) ?
((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^ (~n)⨸(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))⨸sqrt((~a)^2 + (~b)^2))^(~n)* ∫(cos((~c) + (~d)*(~x) - atan((~a), (~b)))^(~n), (~x)) : nothing)

("4_1_5_9",
@rule ∫(sin((~!c) + (~!d)*(~x))^ (~m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~m) + (~n), 0) &&
    eq((~a)^2 + (~b)^2, 0) &&
    gt((~n), 1) ?
-(~a)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 1)⨸((~d)*((~n) - 1)* sin((~c) + (~d)*(~x))^((~n) - 1)) + 2*(~b)* ∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 1)⨸ sin((~c) + (~d)*(~x))^((~n) - 1), (~x)) : nothing)

("4_1_5_10",
@rule ∫(cos((~!c) + (~!d)*(~x))^ (~m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~m) + (~n), 0) &&
    eq((~a)^2 + (~b)^2, 0) &&
    gt((~n), 1) ?
(~b)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 1)⨸((~d)*((~n) - 1)* cos((~c) + (~d)*(~x))^((~n) - 1)) + 2*(~a)* ∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 1)⨸ cos((~c) + (~d)*(~x))^((~n) - 1), (~x)) : nothing)

("4_1_5_11",
@rule ∫(sin((~!c) + (~!d)*(~x))^ (~!m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~m) + (~n), 0) &&
    eq((~a)^2 + (~b)^2, 0) &&
    lt((~n), 0) ?
(~a)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^(~n)⨸(2*(~b)*(~d)*(~n)*sin((~c) + (~d)*(~x))^(~n)) + 1⨸(2*(~b))* ∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 1)⨸ sin((~c) + (~d)*(~x))^((~n) + 1), (~x)) : nothing)

("4_1_5_12",
@rule ∫(cos((~!c) + (~!d)*(~x))^ (~!m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~m) + (~n), 0) &&
    eq((~a)^2 + (~b)^2, 0) &&
    lt((~n), 0) ?
-(~b)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^(~n)⨸(2*(~a)*(~d)*(~n)*cos((~c) + (~d)*(~x))^(~n)) + 1⨸(2*(~a))* ∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 1)⨸ cos((~c) + (~d)*(~x))^((~n) + 1), (~x)) : nothing)

("4_1_5_13",
@rule ∫(sin((~!c) + (~!d)*(~x))^ (~!m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~n), (~x)) &&
    eq((~m) + (~n), 0) &&
    eq((~a)^2 + (~b)^2, 0) &&
    !(ext_isinteger((~n))) ?
(~a)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^(~n)⨸(2*(~b)*(~d)*(~n)*sin((~c) + (~d)*(~x))^(~n))* hypergeometric2f1(1, (~n), (~n) + 1, ((~b) + (~a)*cot((~c) + (~d)*(~x)))⨸(2*(~b))) : nothing)

("4_1_5_14",
@rule ∫(cos((~!c) + (~!d)*(~x))^ (~!m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~n), (~x)) &&
    eq((~m) + (~n), 0) &&
    eq((~a)^2 + (~b)^2, 0) &&
    !(ext_isinteger((~n))) ?
-(~b)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^(~n)⨸(2*(~a)*(~d)*(~n)*cos((~c) + (~d)*(~x))^(~n))* hypergeometric2f1(1, (~n), (~n) + 1, ((~a) + (~b)*tan((~c) + (~d)*(~x)))⨸(2*(~a))) : nothing)

("4_1_5_15",
@rule ∫(sin((~!c) + (~!d)*(~x))^ (~m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~m) + (~n), 0) &&
    ext_isinteger((~n)) &&
    !eq((~a)^2 + (~b)^2, 0) ?
∫(((~b) + (~a)*cot((~c) + (~d)*(~x)))^(~n), (~x)) : nothing)

("4_1_5_16",
@rule ∫(cos((~!c) + (~!d)*(~x))^ (~m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~m) + (~n), 0) &&
    ext_isinteger((~n)) &&
    !eq((~a)^2 + (~b)^2, 0) ?
∫(((~a) + (~b)*tan((~c) + (~d)*(~x)))^(~n), (~x)) : nothing)

("4_1_5_17",
@rule ∫(sin((~!c) + (~!d)*(~x))^ (~!m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    ext_isinteger((~n)) &&
    ext_isinteger(((~m) + (~n))/2) &&
    !eq((~n), -1) &&
    !(
        gt((~n), 0) &&
        gt((~m), 1)
    ) ?
1⨸(~d)*int_and_subst((~x)^(~m)*((~a) + (~b)*(~x))^(~n)⨸(1 + (~x)^2)^(((~m) + (~n) + 2)⨸2),  (~x), (~x), tan((~c) + (~d)*(~x)), "4_1_5_17") : nothing)

("4_1_5_18",
@rule ∫(cos((~!c) + (~!d)*(~x))^ (~!m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    ext_isinteger((~n)) &&
    ext_isinteger(((~m) + (~n))/2) &&
    !eq((~n), -1) &&
    !(
        gt((~n), 0) &&
        gt((~m), 1)
    ) ?
-1⨸(~d)*int_and_subst((~x)^(~m)*((~b) + (~a)*(~x))^(~n)⨸(1 + (~x)^2)^(((~m) + (~n) + 2)⨸2),  (~x), (~x), cot((~c) + (~d)*(~x)), "4_1_5_18") : nothing)

("4_1_5_19",
@rule ∫(sin((~!c) + (~!d)*(~x))^ (~!m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    ext_isinteger((~m)) &&
    igt((~n), 0) ?
∫(ext_expand(sin((~c) + (~d)*(~x))^(~m)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^(~n), (~x)), (~x)) : nothing)

("4_1_5_20",
@rule ∫(cos((~!c) + (~!d)*(~x))^ (~!m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    ext_isinteger((~m)) &&
    igt((~n), 0) ?
∫(ext_expand(cos((~c) + (~d)*(~x))^(~m)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^(~n), (~x)), (~x)) : nothing)

("4_1_5_21",
@rule ∫(sin((~!c) + (~!d)*(~x))^ (~!m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~m), (~x)) &&
    eq((~a)^2 + (~b)^2, 0) &&
    ilt((~n), 0) ?
(~a)^(~n)*(~b)^(~n)* ∫(sin((~c) + (~d)*(~x))^(~m)*((~b)*cos((~c) + (~d)*(~x)) + (~a)*sin((~c) + (~d)*(~x)))^(-(~n)), (~x)) : nothing)

("4_1_5_22",
@rule ∫(cos((~!c) + (~!d)*(~x))^ (~!m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~m), (~x)) &&
    eq((~a)^2 + (~b)^2, 0) &&
    ilt((~n), 0) ?
(~a)^(~n)*(~b)^(~n)* ∫(cos((~c) + (~d)*(~x))^(~m)*((~b)*cos((~c) + (~d)*(~x)) + (~a)*sin((~c) + (~d)*(~x)))^(-(~n)), (~x)) : nothing)

("4_1_5_23",
@rule ∫(((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n)/ sin((~!c) + (~!d)*(~x)),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    lt((~n), -1) ?
(~a)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 1)⨸((~d)*((~n) - 1)) + (~b)*∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 1), (~x)) + (~a)^2* ∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 2)⨸sin((~c) + (~d)*(~x)), (~x)) : nothing)

("4_1_5_24",
@rule ∫(((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n)/ cos((~!c) + (~!d)*(~x)),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    lt((~n), -1) ?
-(~b)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 1)⨸((~d)*((~n) - 1)) + (~a)*∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 1), (~x)) + (~b)^2* ∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 2)⨸cos((~c) + (~d)*(~x)), (~x)) : nothing)

("4_1_5_25",
@rule ∫(sin((~!c) + (~!d)*(~x))^ (~m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    gt((~n), 1) &&
    lt((~m), -1) ?
-((~a)^2 + (~b)^2)* ∫(sin((~c) + (~d)*(~x))^((~m) + 2)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 2), (~x)) + 2*(~b)* ∫(sin((~c) + (~d)*(~x))^((~m) + 1)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 1), (~x)) + (~a)^2* ∫(sin((~c) + (~d)*(~x))^(~m)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 2), (~x)) : nothing)

("4_1_5_26",
@rule ∫(cos((~!c) + (~!d)*(~x))^ (~m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    gt((~n), 1) &&
    lt((~m), -1) ?
-((~a)^2 + (~b)^2)* ∫(cos((~c) + (~d)*(~x))^((~m) + 2)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 2), (~x)) + 2*(~a)* ∫(cos((~c) + (~d)*(~x))^((~m) + 1)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 1), (~x)) + (~b)^2* ∫(cos((~c) + (~d)*(~x))^(~m)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) - 2), (~x)) : nothing)

("4_1_5_27",
@rule ∫(sin((~!c) + (~!d)*(~x))/((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) ?
(~b)*(~x)⨸((~a)^2 + (~b)^2) - (~a)⨸((~a)^2 + (~b)^2)* ∫(((~b)*cos((~c) + (~d)*(~x)) - (~a)*sin((~c) + (~d)*(~x)))⨸((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x))), (~x)) : nothing)

("4_1_5_28",
@rule ∫(cos((~!c) + (~!d)*(~x))/((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) ?
(~a)*(~x)⨸((~a)^2 + (~b)^2) + (~b)⨸((~a)^2 + (~b)^2)* ∫(((~b)*cos((~c) + (~d)*(~x)) - (~a)*sin((~c) + (~d)*(~x)))⨸((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x))), (~x)) : nothing)

("4_1_5_29",
@rule ∫(sin((~!c) + (~!d)*(~x))^ (~m)/((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    gt((~m), 1) ?
-(~a)*sin((~c) + (~d)*(~x))^((~m) - 1)⨸((~d)*((~a)^2 + (~b)^2)*((~m) - 1)) + (~b)⨸((~a)^2 + (~b)^2)*∫(sin((~c) + (~d)*(~x))^((~m) - 1), (~x)) + (~a)^2⨸((~a)^2 + (~b)^2)* ∫(sin((~c) + (~d)*(~x))^((~m) - 2)⨸((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x))), (~x)) : nothing)

("4_1_5_30",
@rule ∫(cos((~!c) + (~!d)*(~x))^ (~m)/((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    gt((~m), 1) ?
(~b)*cos((~c) + (~d)*(~x))^((~m) - 1)⨸((~d)*((~a)^2 + (~b)^2)*((~m) - 1)) + (~a)⨸((~a)^2 + (~b)^2)*∫(cos((~c) + (~d)*(~x))^((~m) - 1), (~x)) + (~b)^2⨸((~a)^2 + (~b)^2)* ∫(cos((~c) + (~d)*(~x))^((~m) - 2)⨸((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x))), (~x)) : nothing)

("4_1_5_31",
@rule ∫(1/(sin( (~!c) + (~!d)*(~x))*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) ?
1⨸(~a)*∫(cot((~c) + (~d)*(~x)), (~x)) - 1⨸(~a)* ∫(((~b)*cos((~c) + (~d)*(~x)) - (~a)*sin((~c) + (~d)*(~x)))⨸((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x))), (~x)) : nothing)

("4_1_5_32",
@rule ∫(1/(cos( (~!c) + (~!d)*(~x))*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) ?
1⨸(~b)*∫(tan((~c) + (~d)*(~x)), (~x)) + 1⨸(~b)* ∫(((~b)*cos((~c) + (~d)*(~x)) - (~a)*sin((~c) + (~d)*(~x)))⨸((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x))), (~x)) : nothing)

("4_1_5_33",
@rule ∫(sin((~!c) + (~!d)*(~x))^ (~m)/((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    lt((~m), -1) ?
sin((~c) + (~d)*(~x))^((~m) + 1)⨸((~a)*(~d)*((~m) + 1)) - (~b)⨸(~a)^2*∫(sin((~c) + (~d)*(~x))^((~m) + 1), (~x)) + ((~a)^2 + (~b)^2)⨸(~a)^2* ∫(sin((~c) + (~d)*(~x))^((~m) + 2)⨸((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x))), (~x)) : nothing)

("4_1_5_34",
@rule ∫(cos((~!c) + (~!d)*(~x))^ (~m)/((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    lt((~m), -1) ?
-cos((~c) + (~d)*(~x))^((~m) + 1)⨸((~b)*(~d)*((~m) + 1)) - (~a)⨸(~b)^2*∫(cos((~c) + (~d)*(~x))^((~m) + 1), (~x)) + ((~a)^2 + (~b)^2)⨸(~b)^2* ∫(cos((~c) + (~d)*(~x))^((~m) + 2)⨸((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x))), (~x)) : nothing)

("4_1_5_35",
@rule ∫(((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n)/ sin((~!c) + (~!d)*(~x)),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    lt((~n), -1) ?
-((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 1)⨸((~a)*(~d)*((~n) + 1)) - (~b)⨸(~a)^2*∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 1), (~x)) + 1⨸(~a)^2* ∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 2)⨸sin((~c) + (~d)*(~x)), (~x)) : nothing)

("4_1_5_36",
@rule ∫(((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n)/ cos((~!c) + (~!d)*(~x)),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    lt((~n), -1) ?
((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 1)⨸((~b)*(~d)*((~n) + 1)) - (~a)⨸(~b)^2*∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 1), (~x)) + 1⨸(~b)^2* ∫(((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 2)⨸cos((~c) + (~d)*(~x)), (~x)) : nothing)

("4_1_5_37",
@rule ∫(sin((~!c) + (~!d)*(~x))^ (~m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    lt((~n), -1) &&
    lt((~m), -1) ?
((~a)^2 + (~b)^2)⨸(~a)^2* ∫(sin((~c) + (~d)*(~x))^((~m) + 2)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^(~n), (~x)) - 2*(~b)⨸(~a)^2* ∫(sin((~c) + (~d)*(~x))^((~m) + 1)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 1), (~x)) + 1⨸(~a)^2* ∫(sin((~c) + (~d)*(~x))^(~m)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 2), (~x)) : nothing)

("4_1_5_38",
@rule ∫(cos((~!c) + (~!d)*(~x))^ (~m)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    lt((~n), -1) &&
    lt((~m), -1) ?
((~a)^2 + (~b)^2)⨸(~b)^2* ∫(cos((~c) + (~d)*(~x))^((~m) + 2)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^(~n), (~x)) - 2*(~a)⨸(~b)^2* ∫(cos((~c) + (~d)*(~x))^((~m) + 1)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 1), (~x)) + 1⨸(~b)^2* ∫(cos((~c) + (~d)*(~x))^(~m)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~n) + 2), (~x)) : nothing)

("4_1_5_39",
@rule ∫(cos((~!c) + (~!d)*(~x))^(~!m)* sin((~!c) + (~!d)*(~x))^ (~!n)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~x)) &&
    igt((~p), 0) ?
∫(ext_expand( cos((~c) + (~d)*(~x))^(~m)*sin((~c) + (~d)*(~x))^(~n)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^(~p), (~x)), (~x)) : nothing)

("4_1_5_40",
@rule ∫(cos((~!c) + (~!d)*(~x))^(~!m)* sin((~!c) + (~!d)*(~x))^ (~!n)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~x)) &&
    eq((~a)^2 + (~b)^2, 0) &&
    ilt((~p), 0) ?
(~a)^(~p)*(~b)^(~p)* ∫(cos((~c) + (~d)*(~x))^(~m)* sin((~c) + (~d)*(~x))^(~n)*((~b)*cos((~c) + (~d)*(~x)) + (~a)*sin((~c) + (~d)*(~x)))^(-(~p)), (~x)) : nothing)

("4_1_5_41",
@rule ∫(cos((~!c) + (~!d)*(~x))^(~!m)* sin((~!c) + (~!d)*(~x))^ (~!n)/((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    igt((~m), 0) &&
    igt((~n), 0) ?
(~b)⨸((~a)^2 + (~b)^2)*∫(cos((~c) + (~d)*(~x))^(~m)*sin((~c) + (~d)*(~x))^((~n) - 1), (~x)) + (~a)⨸((~a)^2 + (~b)^2)*∫(cos((~c) + (~d)*(~x))^((~m) - 1)*sin((~c) + (~d)*(~x))^(~n), (~x)) - (~a)*(~b)⨸((~a)^2 + (~b)^2)* ∫(cos((~c) + (~d)*(~x))^((~m) - 1)* sin((~c) + (~d)*(~x))^((~n) - 1)⨸((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x))), (~x)) : nothing)

("4_1_5_42",
@rule ∫(cos((~!c) + (~!d)*(~x))^(~!m)* sin((~!c) + (~!d)*(~x))^ (~!n)/((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~x)) &&
    ext_isinteger((~m), (~n)) ?
∫(ext_expand( cos((~c) + (~d)*(~x))^(~m)*sin((~c) + (~d)*(~x))^(~n)⨸((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x))), (~x)), (~x)) : nothing)

("4_1_5_43",
@rule ∫(cos((~!c) + (~!d)*(~x))^(~!m)* sin((~!c) + (~!d)*(~x))^ (~!n)*((~!a)*cos((~!c) + (~!d)*(~x)) + (~!b)*sin((~!c) + (~!d)*(~x)))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    igt((~m), 0) &&
    igt((~n), 0) &&
    ilt((~p), 0) ?
(~b)⨸((~a)^2 + (~b)^2)* ∫(cos((~c) + (~d)*(~x))^(~m)* sin((~c) + (~d)*(~x))^((~n) - 1)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~p) + 1), (~x)) + (~a)⨸((~a)^2 + (~b)^2)* ∫(cos((~c) + (~d)*(~x))^((~m) - 1)* sin((~c) + (~d)*(~x))^(~n)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^((~p) + 1), (~x)) - (~a)*(~b)⨸((~a)^2 + (~b)^2)* ∫(cos((~c) + (~d)*(~x))^((~m) - 1)* sin((~c) + (~d)*(~x))^((~n) - 1)*((~a)*cos((~c) + (~d)*(~x)) + (~b)*sin((~c) + (~d)*(~x)))^(~p), (~x)) : nothing)


]
