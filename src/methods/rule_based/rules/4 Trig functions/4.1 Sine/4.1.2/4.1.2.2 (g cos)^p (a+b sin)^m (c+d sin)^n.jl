file_rules = [
#(* ::Subsection::Closed:: *)
#(* 4.1.2.2 (g cos)^p (a+b sin)^m (c+d sin)^n *)
("4_1_2_2_1",
@rule ∫(cos((~!e) + (~!f)*(~x))*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~m), (~n), (~x)) ?
1⨸((~b)*(~f))*int_and_subst(((~a) + (~x))^(~m)*((~c) + (~d)⨸(~b)*(~x))^(~n),  (~x), (~x), (~b)*sin((~e) + (~f)*(~x)), "4_1_2_2_1") : nothing)

("4_1_2_2_2",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~!n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~n), (~p), (~x)) &&
    ext_isinteger(((~p) - 1)/2) &&
    ext_isinteger( (~n)) &&
    (
        lt((~p), 0) &&
        !eq((~a)^2 - (~b)^2, 0) ||
        lt(0, (~n), (~p) - 1) ||
        lt((~p) + 1, -(~n), 2*(~p) + 1)
    ) ?
(~a)*∫(cos((~e) + (~f)*(~x))^(~p)*((~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) + (~b)⨸(~d)*∫(cos((~e) + (~f)*(~x))^(~p)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1), (~x)) : nothing)

("4_1_2_2_3",
@rule ∫(cos((~!e) + (~!f)*(~x))^ (~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^(~!n)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~n), (~p), (~x)) &&
    ext_isinteger(((~p) - 1)/2) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger( (~n)) &&
    (
        lt(0, (~n), ((~p) + 1)/2) ||
        le((~p), -(~n)) &&
        lt(-(~n), 2*(~p) - 3) ||
        gt((~n), 0) &&
        le((~n), -(~p))
    ) ?
1⨸(~a)*∫(cos((~e) + (~f)*(~x))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) - 1⨸((~b)*(~d))*∫(cos((~e) + (~f)*(~x))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1), (~x)) : nothing)

("4_1_2_2_4",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~c), (~d), (~m), (~n), (~x)) &&
    ext_isinteger(((~p) - 1)/2) &&
    eq((~a)^2 - (~b)^2, 0) ?
1⨸((~b)^(~p)*(~f))* int_and_subst(((~a) + (~x))^((~m) + ((~p) - 1)⨸2)*((~a) - (~x))^(((~p) - 1)⨸2)*((~c) + (~d)⨸(~b)*(~x))^ (~n),  (~x), (~x), (~b)*sin((~e) + (~f)*(~x)), "4_1_2_2_4") : nothing)

("4_1_2_2_5",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    ext_isinteger(((~p) - 1)/2) &&
    !eq((~a)^2 - (~b)^2, 0) ?
1⨸((~b)^(~p)*(~f))* int_and_subst(((~a) + (~x))^(~m)*((~c) + (~d)⨸(~b)*(~x))^(~n)*((~b)^2 - (~x)^2)^(((~p) - 1)⨸2),  (~x), (~x), (~b)*sin((~e) + (~f)*(~x)), "4_1_2_2_5") : nothing)

("4_1_2_2_6",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~!n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) ?
(~a)*∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) + (~b)⨸(~d)*∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1), (~x)) : nothing)

("4_1_2_2_7",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^ (~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^(~!n)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) ?
(~g)^2⨸(~a)*∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) - (~g)^2⨸((~b)*(~d))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1), (~x)) : nothing)

("4_1_2_2_8",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m)) &&
    !(
        ext_isinteger((~n)) &&
        lt((~n)^2, (~m)^2)
    ) ?
(~a)^(~m)*(~c)^(~m)⨸(~g)^(2*(~m))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(2*(~m) + (~p))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) - (~m)), (~x)) : nothing)

("4_1_2_2_9",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~p)/2) ?
1⨸((~a)^((~p)⨸2)*(~c)^((~p)⨸2))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + (~p)⨸2)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + (~p)⨸2), (~x)) : nothing)

("4_1_2_2_10",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^ (~p)/(sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))* sqrt((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) ?
(~g)*cos((~e) + (~f)*(~x))⨸(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))*sqrt((~c) + (~d)*sin((~e) + (~f)*(~x))))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1), (~x)) : nothing)

("4_1_2_2_11",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    eq(2*(~m) + (~p) - 1, 0) &&
    eq((~m) - (~n) - 1, 0) ?
(~a)^intpart((~m))* (~c)^intpart((~m))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ fracpart((~m))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^fracpart((~m))⨸ ((~g)^(2*intpart((~m)))*((~g)*cos((~e) + (~f)*(~x)))^(2*fracpart((~m))))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(2*(~m) + (~p))⨸((~c) + (~d)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_12",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    eq(2*(~m) + (~p) - 1, 0) &&
    !eq((~m) - (~n) - 1, 0) ?
(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~f)*(~g)*((~m) - (~n) - 1)) : nothing)

("4_1_2_2_13",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    igt(simplify((~m) + (~p)/2 - 1/2), 0) &&
    lt((~n), -1) &&
    !eq(2*(~n) + (~p) + 1, 0) &&
    !(
        ilt(simplify((~m) + (~n) + (~p)), 0) &&
        gt(simplify(2*(~m) + (~n) + 3*(~p)/2 + 1), 0)
    ) ?
-2*(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~f)*(~g)*(2*(~n) + (~p) + 1)) - (~b)*(2*(~m) + (~p) - 1)⨸((~d)*(2*(~n) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1), (~x)) : nothing)

("4_1_2_2_14",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    igt(simplify((~m) + (~p)/2 - 1/2), 0) &&
    !(lt((~n), -1)) &&
    !(
        igt(simplify((~n) + (~p)/2 - 1/2), 0) &&
        gt((~m) - (~n), 0)
    ) &&
    !(
        ilt(simplify((~m) + (~n) + (~p)), 0) &&
        gt(simplify(2*(~m) + (~n) + 3*(~p)/2 + 1), 0)
    ) ?
-(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~f)*(~g)*((~m) + (~n) + (~p))) + (~a)*(2*(~m) + (~p) - 1)⨸((~m) + (~n) + (~p))* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) : nothing)

("4_1_2_2_15",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    eq(2*(~m) + (~p) + 1, 0) ?
(~a)^intpart((~m))* (~c)^intpart((~m))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ fracpart((~m))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^fracpart((~m))⨸ ((~g)^(2*intpart((~m)))*((~g)*cos((~e) + (~f)*(~x)))^(2*fracpart((~m))))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(2*(~m) + (~p)), (~x)) : nothing)

("4_1_2_2_16",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    eq((~m) + (~n) + (~p) + 1, 0) &&
    !eq((~m), (~n)) ?
(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~a)*(~f)*(~g)*((~m) - (~n))) : nothing)

("4_1_2_2_17",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ilt(simplify((~m) + (~n) + (~p) + 1), 0) &&
    !eq(2*(~m) + (~p) + 1, 0) &&
    (
        sumsimpler((~m), 1) ||
        !(sumsimpler((~n), 1))
    ) ?
(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~a)*(~f)*(~g)*(2*(~m) + (~p) + 1)) + ((~m) + (~n) + (~p) + 1)⨸((~a)*(2*(~m) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) : nothing)

("4_1_2_2_18",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    gt((~m), 0) &&
    lt((~n), -1) &&
    !eq(2*(~n) + (~p) + 1, 0) &&
    ext_isinteger(2*(~m), 2*(~n), 2*(~p)) ?
-2*(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~f)*(~g)*(2*(~n) + (~p) + 1)) - (~b)*(2*(~m) + (~p) - 1)⨸((~d)*(2*(~n) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1), (~x)) : nothing)

("4_1_2_2_19",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    gt((~m), 0) &&
    !eq((~m) + (~n) + (~p), 0) &&
    !(lt(0, (~n), (~m))) &&
    ext_isinteger(2*(~m), 2*(~n), 2*(~p)) ?
-(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~f)*(~g)*((~m) + (~n) + (~p))) + (~a)*(2*(~m) + (~p) - 1)⨸((~m) + (~n) + (~p))* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) : nothing)

("4_1_2_2_20",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    lt((~m), -1) &&
    !eq(2*(~m) + (~p) + 1, 0) &&
    !(lt((~m), (~n), -1)) &&
    ext_isinteger(2*(~m), 2*(~n), 2*(~p)) ?
(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~a)*(~f)*(~g)*(2*(~m) + (~p) + 1)) + ((~m) + (~n) + (~p) + 1)⨸((~a)*(2*(~m) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) : nothing)

("4_1_2_2_21",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    (
        isfraction((~m)) ||
        !(isfraction((~n)))
    ) ?
(~a)^intpart((~m))* (~c)^intpart((~m))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ fracpart((~m))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^fracpart((~m))⨸ ((~g)^(2*intpart((~m)))*((~g)*cos((~e) + (~f)*(~x)))^(2*fracpart((~m))))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(2*(~m) + (~p))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) - (~m)), (~x)) : nothing)

("4_1_2_2_22",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    eq((~a)*(~d)*(~m) + (~b)*(~c)*((~m) + (~p) + 1), 0) ?
-(~d)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸((~f)*(~g)*((~m) + (~p) + 1)) : nothing)

("4_1_2_2_23",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    gt((~m), -1) &&
    lt((~p), -1) ?
-((~b)*(~c) + (~a)*(~d))*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸((~a)*(~f)*(~g)*((~p) + 1)) + (~b)*((~a)*(~d)*(~m) + (~b)*(~c)*((~m) + (~p) + 1))⨸((~a)*(~g)^2*((~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1), (~x)) : nothing)

("4_1_2_2_24",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    igt(simplify((2*(~m) + (~p) + 1)/2), 0) &&
    !eq((~m) + (~p) + 1, 0) ?
-(~d)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸((~f)*(~g)*((~m) + (~p) + 1)) + ((~a)*(~d)*(~m) + (~b)*(~c)*((~m) + (~p) + 1))⨸((~b)*((~m) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) : nothing)

("4_1_2_2_25",
@rule ∫(cos((~!e) + (~!f)*(~x))^2*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    lt((~m), -3/2) ?
2*((~b)*(~c) - (~a)*(~d))* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~b)^2*(~f)*(2*(~m) + 3)) + 1⨸((~b)^3*(2*(~m) + 3))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 2)*((~b)*(~c) + 2*(~a)*(~d)*((~m) + 1) - (~b)*(~d)*(2*(~m) + 3)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_26",
@rule ∫(cos((~!e) + (~!f)*(~x))^2*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ge((~m), -3/2) &&
    lt((~m), 0) ?
(~d)*cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 2)⨸((~b)^2*(~f)*((~m) + 3)) - 1⨸((~b)^2*((~m) + 3))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~b)*(~d)*((~m) + 2) - (~a)*(~c)*((~m) + 3) + ((~b)*(~c)*((~m) + 3) - (~a)*(~d)*((~m) + 4))*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_27",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    (
        lt((~m), -1) ||
        ilt(simplify((~m) + (~p)), 0)
    ) &&
    !eq(2*(~m) + (~p) + 1, 0) ?
((~b)*(~c) - (~a)*(~d))*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸((~a)*(~f)*(~g)*(2*(~m) + (~p) + 1)) + ((~a)*(~d)*(~m) + (~b)*(~c)*((~m) + (~p) + 1))⨸((~a)*(~b)*(2*(~m) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1), (~x)) : nothing)

("4_1_2_2_28",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~m) + (~p) + 1, 0) ?
-(~d)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸((~f)*(~g)*((~m) + (~p) + 1)) + ((~a)*(~d)*(~m) + (~b)*(~c)*((~m) + (~p) + 1))⨸((~b)*((~m) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) : nothing)

("4_1_2_2_29",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    gt((~m), 0) &&
    lt((~p), -1) &&
    ext_isinteger(2*(~m)) &&
    !(
        eq((~m), 1) &&
        !eq((~c)^2 - (~d)^2, 0) &&
        simpler((~c) + (~d)*(~x), (~a) + (~b)*(~x))
    ) ?
-((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~d) + (~c)*sin((~e) + (~f)*(~x)))⨸((~f)*(~g)*((~p) + 1)) + 1⨸((~g)^2*((~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)* simp((~a)*(~c)*((~p) + 2) + (~b)*(~d)*(~m) + (~b)*(~c)*((~m) + (~p) + 2)*sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_2_2_30",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    gt((~m), 0) &&
    !(lt((~p), -1)) &&
    ext_isinteger(2*(~m)) &&
    !(
        eq((~m), 1) &&
        !eq((~c)^2 - (~d)^2, 0) &&
        simpler((~c) + (~d)*(~x), (~a) + (~b)*(~x))
    ) ?
-(~d)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸((~f)*(~g)*((~m) + (~p) + 1)) + 1⨸((~m) + (~p) + 1)* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)* simp((~a)*(~c)*((~m) + (~p) + 1) + (~b)*(~d)*(~m) + ((~a)*(~d)*(~m) + (~b)*(~c)*((~m) + (~p) + 1))*sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_2_2_31",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    lt((~m), -1) &&
    gt((~p), 1) &&
    !eq((~m) + (~p) + 1, 0) &&
    ext_isinteger(2*(~m)) ?
(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~b)*(~c)*((~m) + (~p) + 1) - (~a)*(~d)*(~p) + (~b)*(~d)*((~m) + 1)*sin((~e) + (~f)*(~x)))⨸((~b)^2* (~f)*((~m) + 1)*((~m) + (~p) + 1)) + (~g)^2*((~p) - 1)⨸((~b)^2*((~m) + 1)*((~m) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)* simp((~b)*(~d)*((~m) + 1) + ((~b)*(~c)*((~m) + (~p) + 1) - (~a)*(~d)*(~p))*sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_2_2_32",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    lt((~m), -1) &&
    ext_isinteger(2*(~m)) ?
-((~b)*(~c) - (~a)*(~d))*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~f)*(~g)*((~a)^2 - (~b)^2)*((~m) + 1)) + 1⨸(((~a)^2 - (~b)^2)*((~m) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)* simp(((~a)*(~c) - (~b)*(~d))*((~m) + 1) - ((~b)*(~c) - (~a)*(~d))*((~m) + (~p) + 2)*sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_2_2_33",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    gt((~p), 1) &&
    !eq((~m) + (~p), 0) &&
    !eq((~m) + (~p) + 1, 0) &&
    ext_isinteger(2*(~m)) ?
(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~b)*(~c)*((~m) + (~p) + 1) - (~a)*(~d)*(~p) + (~b)*(~d)*((~m) + (~p))*sin((~e) + (~f)*(~x)))⨸((~b)^2* (~f)*((~m) + (~p))*((~m) + (~p) + 1)) + (~g)^2*((~p) - 1)⨸((~b)^2*((~m) + (~p))*((~m) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)* simp((~b)*((~a)*(~d)*(~m) + (~b)*(~c)*((~m) + (~p) + 1)) + ((~a)*(~b)*(~c)*((~m) + (~p) + 1) - (~d)*((~a)^2*(~p) - (~b)^2*((~m) + (~p))))*sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_2_2_34",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    lt((~p), -1) &&
    ext_isinteger(2*(~m)) ?
((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~b)*(~c) - (~a)*(~d) - ((~a)*(~c) - (~b)*(~d))*sin((~e) + (~f)*(~x)))⨸((~f)*(~g)*((~a)^2 - (~b)^2)*((~p) + 1)) + 1⨸((~g)^2*((~a)^2 - (~b)^2)*((~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)* simp((~c)*((~a)^2*((~p) + 2) - (~b)^2*((~m) + (~p) + 2)) + (~a)*(~b)*(~d)*(~m) + (~b)*((~a)*(~c) - (~b)*(~d))*((~m) + (~p) + 3)*sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_2_2_35",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^ (~p)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) ?
(~d)⨸(~b)*∫(((~g)*cos((~e) + (~f)*(~x)))^(~p), (~x)) + ((~b)*(~c) - (~a)*(~d))⨸(~b)* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_36",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~m), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    eq((~c)^2 - (~d)^2, 0) ?
(~c)*(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)⨸((~f)*(1 + sin((~e) + (~f)*(~x)))^(((~p) - 1)⨸2)*(1 - sin((~e) + (~f)*(~x)))^(((~p) - 1)⨸2))* int_and_subst((1 + (~d)⨸(~c)*(~x))^(((~p) + 1)⨸2)*(1 - (~d)⨸(~c)*(~x))^(((~p) - 1)⨸2)*((~a) + (~b)*(~x))^(~m),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_2_2_36") : nothing)

("4_1_2_2_37",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m), (~p)) &&
    eq(2*(~m) + (~p), 0) ?
(~a)^(2*(~m))*∫(((~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~a) - (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) : nothing)

("4_1_2_2_38",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)* sin((~!e) + (~!f)*(~x))^2*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    eq((~m) - (~p), 0) ?
-((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸(2*(~b)*(~f)* (~g)*((~m) + 1)) + (~a)⨸(2*(~g)^2)* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1), (~x)) : nothing)

("4_1_2_2_39",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)* sin((~!e) + (~!f)*(~x))^2*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    eq((~m) + (~p) + 1, 0) ?
(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)⨸((~a)*(~f)*(~g)*(~m)) - 1⨸(~g)^2*∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) : nothing)

("4_1_2_2_40",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m), (~n), (~p)/2) &&
    (
        gt((~m), 0) &&
        gt((~p), 0) &&
        lt(-(~m) - (~p), (~n), -1) ||
        gt((~m), 2) &&
        lt((~p), 0) &&
        gt((~m) + (~p)/2, 0)
    ) ?
1⨸(~a)^(~p)* ∫(ext_expand(((~d)*sin((~e) + (~f)*(~x)))^ (~n)*((~a) - (~b)*sin((~e) + (~f)*(~x)))^((~p)⨸2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + (~p)⨸2), (~x)), (~x)) : nothing)

("4_1_2_2_41",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    igt((~m), 0) ?
∫(ext_expand(((~g)*cos((~e) + (~f)*(~x)))^ (~p), ((~d)*sin((~e) + (~f)*(~x)))^(~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)), (~x)) : nothing)

("4_1_2_2_42",
@rule ∫(cos((~!e) + (~!f)*(~x))^2*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    (
        ilt((~m), 0) ||
        !(igt((~n), 0))
    ) ?
1⨸(~b)^2* ∫(((~d)*sin((~e) + (~f)*(~x)))^ (~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~a) - (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_43",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ilt((~m), 0) ?
((~a)⨸(~g))^(2*(~m))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(2*(~m) + (~p))*((~d)*sin((~e) + (~f)*(~x)))^ (~n)⨸((~a) - (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) : nothing)

("4_1_2_2_44",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m)) &&
    isrational((~p)) &&
    (
        eq(2*(~m) + (~p), 0) ||
        gt(2*(~m) + (~p), 0) &&
        lt((~p), -1)
    ) ?
((~a)⨸(~g))^(2*(~m))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(2*(~m) + (~p))*((~d)*sin((~e) + (~f)*(~x)))^ (~n)⨸((~a) - (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) : nothing)

("4_1_2_2_45",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)* sin((~!e) + (~!f)*(~x))^2*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    le((~m), -1/2) &&
    !eq(2*(~m) + (~p) + 1, 0) ?
(~b)*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)⨸((~a)*(~f)*(~g)*(2*(~m) + (~p) + 1)) - 1⨸((~a)^2*(2*(~m) + (~p) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~a)*(~m) - (~b)*(2*(~m) + (~p) + 1)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_46",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)* sin((~!e) + (~!f)*(~x))^2*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~m), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~m) + (~p) + 2, 0) ?
-((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~b)*(~f)* (~g)*((~m) + (~p) + 2)) + 1⨸((~b)*((~m) + (~p) + 2))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~b)*((~m) + 1) - (~a)*((~p) + 1)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_47",
@rule ∫(cos((~!e) + (~!f)*(~x))^2*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~m), 2*(~n)) ?
1⨸(~b)^2* ∫(((~d)*sin((~e) + (~f)*(~x)))^ (~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~a) - (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_48",
@rule ∫(cos((~!e) + (~!f)*(~x))^4*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    lt((~m), -1) ?
-2⨸((~a)*(~b)*(~d))* ∫(((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 2), (~x)) + 1⨸(~a)^2* ∫(((~d)*sin((~e) + (~f)*(~x)))^ (~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 2)*(1 + sin((~e) + (~f)*(~x))^2), (~x)) : nothing)

("4_1_2_2_49",
@rule ∫(cos((~!e) + (~!f)*(~x))^4*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !(igt((~m), 0)) ?
1⨸(~d)^4*∫(((~d)*sin((~e) + (~f)*(~x)))^((~n) + 4)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) + ∫(((~d)*sin((~e) + (~f)*(~x)))^(~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*(1 - 2*sin((~e) + (~f)*(~x))^2), (~x)) : nothing)

("4_1_2_2_50",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~p)/2) &&
    ext_isinteger((~m)) ?
(~a)^(~m)*cos( (~e) + (~f)*(~x))⨸((~f)*sqrt(1 + sin((~e) + (~f)*(~x)))*sqrt(1 - sin((~e) + (~f)*(~x))))* int_and_subst(((~d)*(~x))^(~n)*(1 + (~b)⨸(~a)*(~x))^((~m) + ((~p) - 1)⨸2)*(1 - (~b)⨸(~a)*(~x))^(((~p) - 1)⨸2),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_2_2_50") : nothing)

("4_1_2_2_51",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~p)/2) &&
    !(ext_isinteger((~m))) ?
cos((~e) + (~f)*(~x))⨸((~a)^((~p) - 2)*(~f)*sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))* sqrt((~a) - (~b)*sin((~e) + (~f)*(~x))))* int_and_subst(((~d)*(~x))^(~n)*((~a) + (~b)*(~x))^((~m) + (~p)⨸2 - 1⨸2)*((~a) - (~b)*(~x))^((~p)⨸2 - 1⨸2),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_2_2_51") : nothing)

("4_1_2_2_52",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    igt((~m), 0) &&
    (
        ext_isinteger((~p)) ||
        igt((~n), 0)
    ) ?
∫(ext_expand(((~g)*cos((~e) + (~f)*(~x)))^ (~p), ((~d)*sin((~e) + (~f)*(~x)))^(~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)), (~x)) : nothing)

("4_1_2_2_53",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~n), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m)) ?
(~a)^(~m)*(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)⨸((~f)*(1 + sin((~e) + (~f)*(~x)))^(((~p) - 1)⨸2)*(1 - sin((~e) + (~f)*(~x)))^(((~p) - 1)⨸2))* int_and_subst(((~d)*(~x))^(~n)*(1 + (~b)⨸(~a)*(~x))^((~m) + ((~p) - 1)⨸2)*(1 - (~b)⨸(~a)*(~x))^(((~p) - 1)⨸2),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_2_2_53") : nothing)

("4_1_2_2_54",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~m), (~n), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !(ext_isinteger((~m))) ?
(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)⨸((~f)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(((~p) - 1)⨸2)*((~a) - (~b)*sin((~e) + (~f)*(~x)))^(((~p) - 1)⨸2))* int_and_subst(((~d)*(~x))^(~n)*((~a) + (~b)*(~x))^((~m) + ((~p) - 1)⨸2)*((~a) - (~b)*(~x))^(((~p) - 1)⨸2),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_2_2_54") : nothing)

("4_1_2_2_55",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)/ sqrt((~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    lt((~m), -1) &&
    eq((~m) + (~p) + 1/2, 0) ?
-(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)* sqrt((~d)*sin((~e) + (~f)*(~x)))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~a)*(~d)* (~f)*((~m) + 1)) + (~g)^2*(2*(~m) + 3)⨸(2*(~a)*((~m) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸ sqrt((~d)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_56",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)/ sqrt((~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    gt((~m), 0) &&
    eq((~m) + (~p) + 3/2, 0) ?
2*((~g)*cos((~e) + (~f)*(~x)))^((~p) + 1)* sqrt((~d)*sin((~e) + (~f)*(~x)))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)⨸((~d)*(~f)*(~g)*(2*(~m) + 1)) + 2*(~a)*(~m)⨸((~g)^2*(2*(~m) + 1))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)⨸ sqrt((~d)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_57",
@rule ∫(cos((~!e) + (~!f)*(~x))^2*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    (
        igt((~m), 0) ||
        ext_isinteger(2*(~m), 2*(~n))
    ) ?
∫(((~d)*sin((~e) + (~f)*(~x)))^(~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*(1 - sin((~e) + (~f)*(~x))^2), (~x)) : nothing)

#(* Int[cos[e_.+f_.*x_]^4*sin[e_.+f_.*x_]^n_*(a_+b_.*sin[e_.+f_.*x_])^ m_,x_Symbol] := (a^2-b^2)*Cos[e+f*x]*Sin[e+f*x]^(n+1)*(a+b*Sin[e+f*x])^(m+1)/(a*b^2* d*(m+1)) - (a^2*(n+1)-b^2*(m+n+2))*Cos[e+f*x]*Sin[e+f*x]^(n+1)*(a+b*Sin[e+f*x]) ^(m+2)/(a^2*b^2*d*(n+1)*(m+1)) + 1/(a^2*b*(n+1)*(m+1))*Int[Sin[e+f*x]^(n+1)*(a+b*Sin[e+f*x])^(m+1)* Simp[a^2*(n+1)*(n+2)-b^2*(m+n+2)*(m+n+3)+a*b*(m+1)*Sin[e+f*x]-(a^ 2*(n+1)*(n+3)-b^2*(m+n+2)*(m+n+4))*Sin[e+f*x]^2,x],x] /; FreeQ[{a,b,d,e,f},x] && NeQ[a^2-b^2,0] && IntegersQ[2*m,2*n] &&  LtQ[m,-1] && LtQ[n,-1] *)
("4_1_2_2_58",
@rule ∫(cos((~!e) + (~!f)*(~x))^4*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~m), 2*(~n)) &&
    lt((~m), -1) &&
    lt((~n), -1) ?
cos((~e) + (~f)*(~x))*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~a)*(~d)* (~f)*((~n) + 1)) - ((~a)^2*((~n) + 1) - (~b)^2*((~m) + (~n) + 2))* cos((~e) + (~f)*(~x))*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~a)^2*(~b)*(~d)^2*(~f)*((~n) + 1)*((~m) + 1)) + 1⨸((~a)^2*(~b)*(~d)*((~n) + 1)*((~m) + 1))* ∫(((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)* simp((~a)^2*((~n) + 1)*((~n) + 2) - (~b)^2*((~m) + (~n) + 2)*((~m) + (~n) + 3) + (~a)*(~b)*((~m) + 1)* sin((~e) + (~f)*(~x)) - ((~a)^2*((~n) + 1)*((~n) + 3) - (~b)^2*((~m) + (~n) + 2)*((~m) + (~n) + 4))*sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_2_2_59",
@rule ∫(cos((~!e) + (~!f)*(~x))^4*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~n), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~m), 2*(~n)) &&
    lt((~m), -1) &&
    !(lt((~n), -1)) &&
    (
        lt((~m), -2) ||
        eq((~m) + (~n) + 4, 0)
    ) ?
((~a)^2 - (~b)^2)* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~a)*(~b)^2*(~d)*(~f)*((~m) + 1)) + ((~a)^2*((~n) - (~m) + 1) - (~b)^2*((~m) + (~n) + 2))* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 2)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~a)^2*(~b)^2*(~d)*(~f)*((~m) + 1)*((~m) + 2)) - 1⨸((~a)^2*(~b)^2*((~m) + 1)*((~m) + 2))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 2)*((~d)*sin((~e) + (~f)*(~x)))^(~n)* simp((~a)^2*((~n) + 1)*((~n) + 3) - (~b)^2*((~m) + (~n) + 2)*((~m) + (~n) + 3) + (~a)*(~b)*((~m) + 2)* sin((~e) + (~f)*(~x)) - ((~a)^2*((~n) + 2)*((~n) + 3) - (~b)^2*((~m) + (~n) + 2)*((~m) + (~n) + 4))*sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_2_2_60",
@rule ∫(cos((~!e) + (~!f)*(~x))^4*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~n), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~m), 2*(~n)) &&
    lt((~m), -1) &&
    !(lt((~n), -1)) &&
    !eq((~m) + (~n) + 4, 0) ?
((~a)^2 - (~b)^2)* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~a)*(~b)^2*(~d)*(~f)*((~m) + 1)) - cos( (~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 2)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~b)^2*(~d)*(~f)*((~m) + (~n) + 4)) - 1⨸((~a)*(~b)^2*((~m) + 1)*((~m) + (~n) + 4))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~d)*sin((~e) + (~f)*(~x)))^(~n)* simp((~a)^2*((~n) + 1)*((~n) + 3) - (~b)^2*((~m) + (~n) + 2)*((~m) + (~n) + 4) + (~a)*(~b)*((~m) + 1)* sin((~e) + (~f)*(~x)) - ((~a)^2*((~n) + 2)*((~n) + 3) - (~b)^2*((~m) + (~n) + 3)*((~m) + (~n) + 4))*sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_2_2_61",
@rule ∫(cos((~!e) + (~!f)*(~x))^4*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~m), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    (
        igt((~m), 0) ||
        ext_isinteger(2*(~m), 2*(~n))
    ) &&
    !((~m) < -1) &&
    lt((~n), -1) &&
    (
        lt((~n), -2) ||
        eq((~m) + (~n) + 4, 0)
    ) ?
cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~a)*(~d)* (~f)*((~n) + 1)) - (~b)*((~m) + (~n) + 2)* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 2)⨸((~a)^2*(~d)^2*(~f)*((~n) + 1)*((~n) + 2)) - 1⨸((~a)^2*(~d)^2*((~n) + 1)*((~n) + 2))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 2)* simp((~a)^2*(~n)*((~n) + 2) - (~b)^2*((~m) + (~n) + 2)*((~m) + (~n) + 3) + (~a)*(~b)*(~m)*sin( (~e) + (~f)*(~x)) - ((~a)^2*((~n) + 1)*((~n) + 2) - (~b)^2*((~m) + (~n) + 2)*((~m) + (~n) + 4))*sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_2_2_62",
@rule ∫(cos((~!e) + (~!f)*(~x))^4*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~m), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    (
        igt((~m), 0) ||
        ext_isinteger(2*(~m), 2*(~n))
    ) &&
    !((~m) < -1) &&
    lt((~n), -1) &&
    !eq((~m) + (~n) + 4, 0) ?
cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~a)*(~d)* (~f)*((~n) + 1)) - cos( (~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 2)⨸((~b)*(~d)^2*(~f)*((~m) + (~n) + 4)) + 1⨸((~a)*(~b)*(~d)*((~n) + 1)*((~m) + (~n) + 4))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)* simp((~a)^2*((~n) + 1)*((~n) + 2) - (~b)^2*((~m) + (~n) + 2)*((~m) + (~n) + 4) + (~a)*(~b)*((~m) + 3)* sin((~e) + (~f)*(~x)) - ((~a)^2*((~n) + 1)*((~n) + 3) - (~b)^2*((~m) + (~n) + 3)*((~m) + (~n) + 4))*sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_2_2_63",
@rule ∫(cos((~!e) + (~!f)*(~x))^4*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    (
        igt((~m), 0) ||
        ext_isinteger(2*(~m), 2*(~n))
    ) &&
    !((~m) < -1) &&
    !(lt((~n), -1)) &&
    !eq((~m) + (~n) + 3, 0) &&
    !eq((~m) + (~n) + 4, 0) ?
(~a)*((~n) + 3)* cos((~e) + (~f)*(~x))*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~b)^2*(~d)* (~f)*((~m) + (~n) + 3)*((~m) + (~n) + 4)) - cos( (~e) + (~f)*(~x))*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~b)*(~d)^2*(~f)*((~m) + (~n) + 4)) - 1⨸((~b)^2*((~m) + (~n) + 3)*((~m) + (~n) + 4))* ∫(((~d)*sin((~e) + (~f)*(~x)))^(~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)* simp((~a)^2*((~n) + 1)*((~n) + 3) - (~b)^2*((~m) + (~n) + 3)*((~m) + (~n) + 4) + (~a)*(~b)*(~m)*sin( (~e) + (~f)*(~x)) - ((~a)^2*((~n) + 2)*((~n) + 3) - (~b)^2*((~m) + (~n) + 3)*((~m) + (~n) + 5))*sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_2_2_64",
@rule ∫(cos((~!e) + (~!f)*(~x))^6*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~m), 2*(~n)) &&
    !eq((~n), -1) &&
    !eq((~n), -2) &&
    !eq((~m) + (~n) + 5, 0) &&
    !eq((~m) + (~n) + 6, 0) &&
    !(igt((~m), 0)) ?
cos((~e) + (~f)*(~x))*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~a)*(~d)* (~f)*((~n) + 1)) - (~b)*((~m) + (~n) + 2)* cos((~e) + (~f)*(~x))*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~a)^2*(~d)^2*(~f)*((~n) + 1)*((~n) + 2)) - (~a)*((~n) + 5)* cos((~e) + (~f)*(~x))*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 3)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~b)^2*(~d)^3* (~f)*((~m) + (~n) + 5)*((~m) + (~n) + 6)) + cos( (~e) + (~f)*(~x))*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 4)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)⨸((~b)*(~d)^4*(~f)*((~m) + (~n) + 6)) + 1⨸((~a)^2*(~b)^2*(~d)^2*((~n) + 1)*((~n) + 2)*((~m) + (~n) + 5)*((~m) + (~n) + 6))* ∫(((~d)*sin((~e) + (~f)*(~x)))^((~n) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)* simp((~a)^4*((~n) + 1)*((~n) + 2)*((~n) + 3)*((~n) + 5) - (~a)^2*(~b)^2*((~n) + 2)*(2*(~n) + 1)*((~m) + (~n) + 5)*((~m) + (~n) + 6) + (~b)^4*((~m) + (~n) + 2)*((~m) + (~n) + 3)*((~m) + (~n) + 5)*((~m) + (~n) + 6) + (~a)*(~b)*(~m)*((~a)^2*((~n) + 1)*((~n) + 2) - (~b)^2*((~m) + (~n) + 5)*((~m) + (~n) + 6))* sin((~e) + (~f)*(~x)) - ((~a)^4*((~n) + 1)*((~n) + 2)*(4 + (~n))*((~n) + 5) + (~b)^4*((~m) + (~n) + 2)*((~m) + (~n) + 4)*((~m) + (~n) + 5)*((~m) + (~n) + 6) - (~a)^2*(~b)^2*((~n) + 1)*((~n) + 2)*((~m) + (~n) + 5)*(2*(~n) + 2*(~m) + 13))* sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_2_2_65",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m), 2*(~n), (~p)/2) &&
    (
        lt((~m), -1) ||
        eq((~m), -1) &&
        gt((~p), 0)
    ) ?
∫(ext_expand(((~d)*sin((~e) + (~f)*(~x)))^(~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*(1 - sin((~e) + (~f)*(~x))^2)^((~p)⨸2), (~x)), (~x)) : nothing)

("4_1_2_2_66",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)* sin((~!e) + (~!f)*(~x))^(~n)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~n)) &&
    (
        lt((~n), 0) ||
        igt((~p) + 1/2, 0)
    ) ?
∫(ext_expand(((~g)*cos((~e) + (~f)*(~x)))^(~p), sin((~e) + (~f)*(~x))^(~n)⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)), (~x)) : nothing)

("4_1_2_2_67",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^ (~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^(~n)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~n), 2*(~p)) &&
    gt((~p), 1) &&
    (
        le((~n), -2) ||
        eq((~n), -3/2) &&
        eq((~p), 3/2)
    ) ?
(~g)^2⨸(~a)*∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) - (~b)*(~g)^2⨸((~a)^2*(~d))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1), (~x)) - (~g)^2*((~a)^2 - (~b)^2)⨸((~a)^2*(~d)^2)* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 2)⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_68",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^ (~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^(~n)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~n), 2*(~p)) &&
    gt((~p), 1) &&
    (
        lt((~n), -1) ||
        eq((~p), 3/2) &&
        eq((~n), -1/2)
    ) ?
(~g)^2⨸((~a)*(~b))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^ (~n)*((~b) - (~a)*sin((~e) + (~f)*(~x))), (~x)) + (~g)^2*((~a)^2 - (~b)^2)⨸((~a)*(~b)*(~d))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_69",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^ (~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^(~n)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~n), 2*(~p)) &&
    gt((~p), 1) ?
(~g)^2⨸(~b)^2* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^ (~n)*((~a) - (~b)*sin((~e) + (~f)*(~x))), (~x)) - (~g)^2*((~a)^2 - (~b)^2)⨸(~b)^2* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^ (~n)⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

#(* Int[(g_.*cos[e_.+f_.*x_])^p_*(d_.*sin[e_.+f_.*x_])^n_/(a_+b_.*sin[ e_.+f_.*x_]),x_Symbol] := g^2*Int[(g*Cos[e+f*x])^(p-2)*(d*Sin[e+f*x])^n/(a+b*Sin[e+f*x]),x] -   g^2/d^2*Int[(g*Cos[e+f*x])^(p-2)*(d*Sin[e+f*x])^(n+2)/(a+b*Sin[e+f* x]),x] /; FreeQ[{a,b,d,e,f,g},x] && NeQ[a^2-b^2,0] && IntegersQ[2*n,2*p] &&  GtQ[p,1] *)
("4_1_2_2_70",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^ (~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^(~n)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~n), 2*(~p)) &&
    lt((~p), -1) &&
    gt((~n), 1) ?
(~a)*(~d)^2⨸((~a)^2 - (~b)^2)* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~d)*sin((~e) + (~f)*(~x)))^((~n) - 2), (~x)) - (~b)*(~d)⨸((~a)^2 - (~b)^2)* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~d)*sin((~e) + (~f)*(~x)))^((~n) - 1), (~x)) - (~a)^2*(~d)^2⨸((~g)^2*((~a)^2 - (~b)^2))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~d)*sin((~e) + (~f)*(~x)))^((~n) - 2)⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_71",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^ (~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^(~n)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~n), 2*(~p)) &&
    lt((~p), -1) &&
    gt((~n), 0) ?
-(~d)⨸((~a)^2 - (~b)^2)* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~d)*sin((~e) + (~f)*(~x)))^((~n) - 1)*((~b) - (~a)*sin((~e) + (~f)*(~x))), (~x)) + (~a)*(~b)*(~d)⨸((~g)^2*((~a)^2 - (~b)^2))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~d)*sin((~e) + (~f)*(~x)))^((~n) - 1)⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_72",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^ (~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^(~n)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~n), 2*(~p)) &&
    lt((~p), -1) ?
1⨸((~a)^2 - (~b)^2)* ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~d)*sin((~e) + (~f)*(~x)))^(~n)*((~a) - (~b)*sin((~e) + (~f)*(~x))), (~x)) - (~b)^2⨸((~g)^2*((~a)^2 - (~b)^2))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) + 2)*((~d)*sin((~e) + (~f)*(~x)))^ (~n)⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_73",
@rule ∫(sqrt( (~!g)*cos((~!e) + (~!f)*(~x)))/(sqrt( sin((~!e) + (~!f)*(~x)))*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) ?
-4*sqrt(2)*(~g)⨸(~f)* int_and_subst((~x)^2⨸((((~a) + (~b))*(~g)^2 + ((~a) - (~b))*(~x)^4)*sqrt(1 - (~x)^4⨸(~g)^2)),  (~x), (~x), sqrt((~g)*cos((~e) + (~f)*(~x)))⨸sqrt(1 + sin((~e) + (~f)*(~x))), "4_1_2_2_73") : nothing)

("4_1_2_2_74",
@rule ∫(sqrt( (~!g)*cos((~!e) + (~!f)*(~x)))/(sqrt( (~d)*sin((~!e) + (~!f)*(~x)))*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) ?
sqrt(sin((~e) + (~f)*(~x)))⨸sqrt((~d)*sin((~e) + (~f)*(~x)))* ∫(sqrt((~g)*cos((~e) + (~f)*(~x)))⨸(sqrt(sin((~e) + (~f)*(~x)))*((~a) + (~b)*sin((~e) + (~f)*(~x)))), (~x)) : nothing)

("4_1_2_2_75",
@rule ∫(sqrt( (~!d)*sin((~!e) + (~!f)*(~x)))/(sqrt( cos((~!e) + (~!f)*(~x)))*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) ?
2*sqrt(2)*(~d)*((~b) + rt(-(~a)^2 + (~b)^2, 2))⨸((~f)*rt(-(~a)^2 + (~b)^2, 2))* int_and_subst(1⨸(((~d)*((~b) + rt(-(~a)^2 + (~b)^2,  2)) + (~a)*(~x)^2)*sqrt(1 - (~x)^4⨸(~d)^2)), (~x), (~x), sqrt((~d)*sin((~e) + (~f)*(~x)))⨸sqrt(1 + cos((~e) + (~f)*(~x))), "4_1_2_2_75") - 2*sqrt(2)*(~d)*((~b) - rt(-(~a)^2 + (~b)^2, 2))⨸((~f)*rt(-(~a)^2 + (~b)^2, 2))* int_and_subst(1⨸(((~d)*((~b) - rt(-(~a)^2 + (~b)^2,  2)) + (~a)*(~x)^2)*sqrt(1 - (~x)^4⨸(~d)^2)), (~x), (~x), sqrt((~d)*sin((~e) + (~f)*(~x)))⨸sqrt(1 + cos((~e) + (~f)*(~x))), "4_1_2_2_75") : nothing)

("4_1_2_2_76",
@rule ∫(sqrt( (~!d)*sin((~!e) + (~!f)*(~x)))/(sqrt( (~!g)*cos((~!e) + (~!f)*(~x)))*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) ?
sqrt(cos((~e) + (~f)*(~x)))⨸sqrt((~g)*cos((~e) + (~f)*(~x)))* ∫(sqrt((~d)*sin((~e) + (~f)*(~x)))⨸(sqrt(cos((~e) + (~f)*(~x)))*((~a) + (~b)*sin((~e) + (~f)*(~x)))), (~x)) : nothing)

("4_1_2_2_77",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^ (~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^(~n)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~n), 2*(~p)) &&
    lt(-1, (~p), 1) &&
    gt((~n), 0) ?
(~d)⨸(~b)*∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~d)*sin((~e) + (~f)*(~x)))^((~n) - 1), (~x)) - (~a)*(~d)⨸(~b)* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~d)*sin((~e) + (~f)*(~x)))^((~n) - 1)⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_78",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^ (~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^(~n)/((~a) + (~!b)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~n), 2*(~p)) &&
    lt(-1, (~p), 1) &&
    lt((~n), 0) ?
1⨸(~a)*∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) - (~b)⨸((~a)*(~d))* ∫(((~g)*cos((~e) + (~f)*(~x)))^ (~p)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_79",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^2,(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) ?
2*(~a)*(~b)⨸(~d)*∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1), (~x)) + ∫(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~d)*sin((~e) + (~f)*(~x)))^ (~n)*((~a)^2 + (~b)^2*sin((~e) + (~f)*(~x))^2), (~x)) : nothing)

("4_1_2_2_80",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m)) &&
    (
        gt((~m), 0) ||
        ext_isinteger((~n))
    ) ?
∫(ext_expand(((~g)*cos((~e) + (~f)*(~x)))^ (~p), ((~d)*sin((~e) + (~f)*(~x)))^(~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)), (~x)) : nothing)

("4_1_2_2_81",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~g), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m), 2*(~n), 2*(~p)) &&
    lt((~m), 0) &&
    gt((~p), 1) &&
    (
        le((~n), -2) ||
        eq((~m), -1) &&
        eq((~n), -3/2) &&
        eq((~p), 3/2)
    ) ?
(~g)^2⨸(~a)* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^ (~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1), (~x)) - (~b)*(~g)^2⨸((~a)^2*(~d))* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1), (~x)) - (~g)^2*((~a)^2 - (~b)^2)⨸((~a)^2*(~d)^2)* ∫(((~g)*cos((~e) + (~f)*(~x)))^((~p) - 2)*((~d)*sin((~e) + (~f)*(~x)))^((~n) + 2)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) : nothing)

("4_1_2_2_82",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m), (~p)) &&
    eq(2*(~m) + (~p), 0) ?
(~a)^(2*(~m))*∫(((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~a) - (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) : nothing)

("4_1_2_2_83",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m)) &&
    (
        eq(2*(~m) + (~p), 0) ||
        gt(2*(~m) + (~p), 0) &&
        lt((~p), -1)
    ) ?
((~a)⨸(~g))^(2*(~m))* ∫(((~g)*cos((~e) + (~f)*(~x)))^(2*(~m) + (~p))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^ (~n)⨸((~a) - (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) : nothing)

("4_1_2_2_84",
@rule ∫(cos((~!e) + (~!f)*(~x))^2*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~m), 2*(~n)) ?
1⨸(~b)^2* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^ (~n)*((~a) - (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_2_2_85",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~p)/2) &&
    ext_isinteger((~m)) ?
(~a)^(~m)*cos( (~e) + (~f)*(~x))⨸((~f)*sqrt(1 + sin((~e) + (~f)*(~x)))*sqrt(1 - sin((~e) + (~f)*(~x))))* int_and_subst((1 + (~b)⨸(~a)*(~x))^((~m) + ((~p) - 1)⨸2)*(1 - (~b)⨸(~a)*(~x))^(((~p) - 1)⨸2)*((~c) + (~d)*(~x))^ (~n),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_2_2_85") : nothing)

("4_1_2_2_86",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~p)/2) &&
    !(ext_isinteger((~m))) ?
cos((~e) + (~f)*(~x))⨸((~a)^((~p) - 2)*(~f)*sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))* sqrt((~a) - (~b)*sin((~e) + (~f)*(~x))))* int_and_subst(((~a) + (~b)*(~x))^((~m) + (~p)⨸2 - 1⨸2)*((~a) - (~b)*(~x))^((~p)⨸2 - 1⨸2)*((~c) + (~d)*(~x))^(~n),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_2_2_86") : nothing)

("4_1_2_2_87",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~n), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    igt((~m), 0) &&
    (
        ext_isinteger((~p)) ||
        igt((~n), 0)
    ) ?
∫(ext_expand(((~g)*cos((~e) + (~f)*(~x)))^ (~p), ((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)), (~x)) : nothing)

("4_1_2_2_88",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m)) ?
(~a)^(~m)*(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)⨸((~f)*(1 + sin((~e) + (~f)*(~x)))^(((~p) - 1)⨸2)*(1 - sin((~e) + (~f)*(~x)))^(((~p) - 1)⨸2))* int_and_subst((1 + (~b)⨸(~a)*(~x))^((~m) + ((~p) - 1)⨸2)*(1 - (~b)⨸(~a)*(~x))^(((~p) - 1)⨸2)*((~c) + (~d)*(~x))^ (~n),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_2_2_88") : nothing)

("4_1_2_2_89",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~m), (~n), (~p), (~x)) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !(ext_isinteger((~m))) ?
(~g)*((~g)*cos((~e) + (~f)*(~x)))^((~p) - 1)⨸((~f)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(((~p) - 1)⨸2)*((~a) - (~b)*sin((~e) + (~f)*(~x)))^(((~p) - 1)⨸2))* int_and_subst(((~a) + (~b)*(~x))^((~m) + ((~p) - 1)⨸2)*((~a) - (~b)*(~x))^(((~p) - 1)⨸2)*((~c) + (~d)*(~x))^(~n),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_2_2_89") : nothing)

("4_1_2_2_90",
@rule ∫(cos((~!e) + (~!f)*(~x))^2*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    (
        igt((~m), 0) ||
        ext_isinteger(2*(~m), 2*(~n))
    ) ?
∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^ (~n)*(1 - sin((~e) + (~f)*(~x))^2), (~x)) : nothing)

("4_1_2_2_91",
@rule ∫(cos((~!e) + (~!f)*(~x))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~m), (~n), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    igt((~p)/2, 0) &&
    (
        igt((~m), 0) ||
        ext_isinteger(2*(~m), 2*(~n))
    ) ?
∫(ext_expand(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^ (~n)*(1 - sin((~e) + (~f)*(~x))^2)^((~p)⨸2), (~x)), (~x)) : nothing)

("4_1_2_2_92",
@rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~p), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger(2*(~m), 2*(~n)) ?
∫(ext_expand(((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)), (~x)) : nothing)

# ("4_1_2_2_93",
# @rule ∫(((~!g)*cos((~!e) + (~!f)*(~x)))^(~p)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~!n),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~n), (~p), (~x)) &&
#     !eq((~a)^2 - (~b)^2, 0) ?
# Unintegrable[((~g)*cos((~e) + (~f)*(~x)))^(~p)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)] : nothing)

("4_1_2_2_94",
@rule ∫(((~!g)*sec((~!e) + (~!f)*(~x)))^(~p)*((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~n), (~p), (~x)) &&
    !(ext_isinteger((~p))) ?
(~g)^(2*intpart((~p)))*((~g)*cos((~e) + (~f)*(~x)))^fracpart((~p))*((~g)*sec((~e) + (~f)*(~x)))^ fracpart((~p))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~g)*cos((~e) + (~f)*(~x)))^(~p), (~x)) : nothing)

("4_1_2_2_95",
@rule ∫(((~!g)*csc((~!e) + (~!f)*(~x)))^(~p)*((~!a) + (~!b)*cos((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*cos((~!e) + (~!f)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~m), (~n), (~p), (~x)) &&
    !(ext_isinteger((~p))) ?
(~g)^(2*intpart((~p)))*((~g)*sin((~e) + (~f)*(~x)))^fracpart((~p))*((~g)*csc((~e) + (~f)*(~x)))^ fracpart((~p))* ∫(((~a) + (~b)*cos((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*cos((~e) + (~f)*(~x)))^(~n)⨸((~g)*sin((~e) + (~f)*(~x)))^(~p), (~x)) : nothing)


]
