file_rules = [
#(* ::Subsection::Closed:: *)
#(* 4.1.3.1 (a+b sin)^m (c+d sin)^n (A+B sin) *)
("4_1_3_1",
@rule ∫(sin((~!e) + (~!f)*(~x))^(~!n)*((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~A), (~B), (~x)) &&
    eq((~A)*(~b) + (~a)*(~B), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m)) &&
    ext_isinteger((~n)) ?
∫(ext_expand( sin((~e) + (~f)*(~x))^(~n)*((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*((~A) + (~B)*sin((~e) + (~f)*(~x))), (~x)), (~x)) : nothing)

("4_1_3_2",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~!m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~!n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~n), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    ext_isinteger((~m)) &&
    !(
        ext_isinteger( (~n)) &&
        (
            lt((~m), 0) &&
            gt((~n), 0) ||
            lt(0, (~n), (~m)) ||
            lt((~m), (~n), 0)
        )
    ) ?
(~a)^(~m)*(~c)^(~m)* ∫(cos((~e) + (~f)*(~x))^(2*(~m))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) - (~m))*((~A) + (~B)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_3_3",
@rule ∫(((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) ?
∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~A)*(~c) + ((~B)*(~c) + (~A)*(~d))*sin((~e) + (~f)*(~x)) + (~B)*(~d)*sin((~e) + (~f)*(~x))^2), (~x)) : nothing)

("4_1_3_4",
@rule ∫(((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))* sqrt((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) ?
((~A)*(~b) + (~a)*(~B))⨸(2*(~a)*(~b))* ∫(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸sqrt((~c) + (~d)*sin((~e) + (~f)*(~x))), (~x)) + ((~B)*(~c) + (~A)*(~d))⨸(2*(~c)*(~d))* ∫(sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))⨸sqrt((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_3_5",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~!n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~n), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    eq((~A)*(~b)*((~m) + (~n) + 1) + (~a)*(~B)*((~m) - (~n)), 0) &&
    !eq((~m), -1/2) ?
-(~B)*cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~f)*((~m) + (~n) + 1)) : nothing)

("4_1_3_6",
@rule ∫(sqrt((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~n), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) ?
(~B)⨸(~d)*∫(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1), (~x)) - ((~B)*(~c) - (~A)*(~d))⨸(~d)* ∫(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) : nothing)

("4_1_3_7",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~!n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~n), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    (
        lt((~m), -1/2) ||
        ilt((~m) + (~n), 0) &&
        !(sumsimpler((~n), 1))
    ) &&
    !eq(2*(~m) + 1, 0) ?
((~A)*(~b) - (~a)*(~B))* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~a)*(~f)*(2*(~m) + 1)) + ((~a)*(~B)*((~m) - (~n)) + (~A)*(~b)*((~m) + (~n) + 1))⨸((~a)*(~b)*(2*(~m) + 1))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) : nothing)

("4_1_3_8",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~!m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~n), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !(lt((~m), -1/2)) &&
    !eq((~m) + (~n) + 1, 0) ?
-(~B)*cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~f)*((~m) + (~n) + 1)) - ((~B)*(~c)*((~m) - (~n)) - (~A)*(~d)*((~m) + (~n) + 1))⨸((~d)*((~m) + (~n) + 1))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) : nothing)

("4_1_3_9",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    eq((~m) + (~n) + 2, 0) &&
    eq((~A)*((~a)*(~d)*(~m) + (~b)*(~c)*((~n) + 1)) - (~B)*((~a)*(~c)*(~m) + (~b)*(~d)*((~n) + 1)), 0) ?
((~B)*(~c) - (~A)*(~d))* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~f)*((~n) + 1)*((~c)^2 - (~d)^2)) : nothing)

("4_1_3_10",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    gt((~m), 1/2) &&
    lt((~n), -1) &&
    ext_isinteger(2*(~m)) &&
    (
        ext_isinteger(2*(~n)) ||
        eq((~c), 0)
    ) ?
-(~b)^2*((~B)*(~c) - (~A)*(~d))* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~d)*(~f)*((~n) + 1)*((~b)*(~c) + (~a)*(~d))) - (~b)⨸((~d)*((~n) + 1)*((~b)*(~c) + (~a)*(~d)))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)* simp((~a)*(~A)*(~d)*((~m) - (~n) - 2) - (~B)*((~a)*(~c)*((~m) - 1) + (~b)*(~d)*((~n) + 1)) - ((~A)*(~b)*(~d)*((~m) + (~n) + 1) - (~B)*((~b)*(~c)*(~m) - (~a)*(~d)*((~n) + 1)))*sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_3_11",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    gt((~m), 1/2) &&
    !(lt((~n), -1)) &&
    ext_isinteger(2*(~m)) &&
    (
        ext_isinteger(2*(~n)) ||
        eq((~c), 0)
    ) ?
-(~b)*(~B)*cos( (~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~d)*(~f)*((~m) + (~n) + 1)) + 1⨸((~d)*((~m) + (~n) + 1))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)* simp((~a)*(~A)*(~d)*((~m) + (~n) + 1) + (~B)*((~a)*(~c)*((~m) - 1) + (~b)*(~d)*((~n) + 1)) + ((~A)*(~b)*(~d)*((~m) + (~n) + 1) - (~B)*((~b)*(~c)*(~m) - (~a)*(~d)*(2*(~m) + (~n))))*sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_3_12",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    lt((~m), -1/2) &&
    gt((~n), 0) &&
    ext_isinteger(2*(~m)) &&
    (
        ext_isinteger(2*(~n)) ||
        eq((~c), 0)
    ) ?
((~A)*(~b) - (~a)*(~B))* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~a)*(~f)*(2*(~m) + 1)) - 1⨸((~a)*(~b)*(2*(~m) + 1))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) - 1)* simp((~A)*((~a)*(~d)*(~n) - (~b)*(~c)*((~m) + 1)) - (~B)*((~a)*(~c)*(~m) + (~b)*(~d)*(~n)) - (~d)*((~a)*(~B)*((~m) - (~n)) + (~A)*(~b)*((~m) + (~n) + 1))*sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_3_13",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    lt((~m), -1/2) &&
    !(gt((~n), 0)) &&
    ext_isinteger(2*(~m)) &&
    (
        ext_isinteger(2*(~n)) ||
        eq((~c), 0)
    ) ?
(~b)*((~A)*(~b) - (~a)*(~B))* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~a)*(~f)*(2*(~m) + 1)*((~b)*(~c) - (~a)*(~d))) + 1⨸((~a)*(2*(~m) + 1)*((~b)*(~c) - (~a)*(~d)))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)* simp((~B)*((~a)*(~c)*(~m) + (~b)*(~d)*((~n) + 1)) + (~A)*((~b)*(~c)*((~m) + 1) - (~a)*(~d)*(2*(~m) + (~n) + 2)) + (~d)*((~A)*(~b) - (~a)*(~B))*((~m) + (~n) + 2)*sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_3_14",
@rule ∫(sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    eq((~A)*(~b)*(~d)*(2*(~n) + 3) - (~B)*((~b)*(~c) - 2*(~a)*(~d)*((~n) + 1)), 0) ?
-2*(~b)*(~B)* cos((~e) + (~f)*(~x))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~d)*(~f)*(2*(~n) + 3)* sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))) : nothing)

("4_1_3_15",
@rule ∫(sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    lt((~n), -1) ?
-(~b)^2*((~B)*(~c) - (~A)*(~d))* cos((~e) + (~f)*(~x))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~d)* (~f)*((~n) + 1)*((~b)*(~c) + (~a)*(~d))*sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))) + ((~A)*(~b)*(~d)*(2*(~n) + 3) - (~B)*((~b)*(~c) - 2*(~a)*(~d)*((~n) + 1)))⨸(2* (~d)*((~n) + 1)*((~b)*(~c) + (~a)*(~d)))* ∫(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1), (~x)) : nothing)

("4_1_3_16",
@rule ∫(sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    !(lt((~n), -1)) ?
-2*(~b)*(~B)* cos((~e) + (~f)*(~x))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~d)*(~f)*(2*(~n) + 3)* sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))) + ((~A)*(~b)*(~d)*(2*(~n) + 3) - (~B)*((~b)*(~c) - 2*(~a)*(~d)*((~n) + 1)))⨸((~b)*(~d)*(2*(~n) + 3))* ∫(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) : nothing)

("4_1_3_17",
@rule ∫(((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))* sqrt((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) ?
((~A)*(~b) - (~a)*(~B))⨸(~b)* ∫(1⨸(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))*sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))), (~x)) + (~B)⨸(~b)*∫(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸sqrt((~c) + (~d)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_3_18",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    gt((~n), 0) &&
    (
        ext_isinteger((~n)) ||
        eq((~m) + 1/2, 0)
    ) ?
-(~B)*cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~f)*((~m) + (~n) + 1)) + 1⨸((~b)*((~m) + (~n) + 1))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) - 1)* simp((~A)*(~b)*(~c)*((~m) + (~n) + 1) + (~B)*((~a)*(~c)*(~m) + (~b)*(~d)*(~n)) + ((~A)*(~b)*(~d)*((~m) + (~n) + 1) + (~B)*((~a)*(~d)*(~m) + (~b)*(~c)*(~n)))* sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_3_19",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    lt((~n), -1) &&
    (
        ext_isinteger((~n)) ||
        eq((~m) + 1/2, 0)
    ) ?
((~B)*(~c) - (~A)*(~d))* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^ (~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~f)*((~n) + 1)*((~c)^2 - (~d)^2)) + 1⨸((~b)*((~n) + 1)*((~c)^2 - (~d)^2))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)* simp((~A)*((~a)*(~d)*(~m) + (~b)*(~c)*((~n) + 1)) - (~B)*((~a)*(~c)*(~m) + (~b)*(~d)*((~n) + 1)) + (~b)*((~B)*(~c) - (~A)*(~d))*((~m) + (~n) + 2)*sin((~e) + (~f)*(~x)), (~x)), (~x)) : nothing)

("4_1_3_20",
@rule ∫(((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(sqrt( (~a) + (~!b)*sin((~!e) + (~!f)*(~x)))*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) ?
((~A)*(~b) - (~a)*(~B))⨸((~b)*(~c) - (~a)*(~d))*∫(1⨸sqrt((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) + ((~B)*(~c) - (~A)*(~d))⨸((~b)*(~c) - (~a)*(~d))* ∫(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸((~c) + (~d)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_3_21",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))/((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    !eq((~m) + 1/2, 0) ?
(~B)⨸(~d)*∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) - ((~B)*(~c) - (~A)*(~d))⨸(~d)* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)⨸((~c) + (~d)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_3_22",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~!m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    !eq((~A)*(~b) + (~a)*(~B), 0) ?
((~A)*(~b) - (~a)*(~B))⨸(~b)* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) + (~B)⨸(~b)*∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n), (~x)) : nothing)

("4_1_3_23",
@rule ∫(((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))^2*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    lt((~n), -1) ?
((~B)*(~c) - (~A)*(~d))*((~b)*(~c) - (~a)*(~d))^2* cos((~e) + (~f)*(~x))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~f)* (~d)^2*((~n) + 1)*((~c)^2 - (~d)^2)) - 1⨸((~d)^2*((~n) + 1)*((~c)^2 - (~d)^2))*∫(((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)* simp((~d)*((~n) + 1)*((~B)*((~b)*(~c) - (~a)*(~d))^2 - (~A)*(~d)*((~a)^2*(~c) + (~b)^2*(~c) - 2*(~a)*(~b)*(~d))) - (((~B)*(~c) - (~A)*(~d))*((~a)^2*(~d)^2*((~n) + 2) + (~b)^2*((~c)^2 + (~d)^2*((~n) + 1))) + 2*(~a)*(~b)*(~d)*((~A)*(~c)*(~d)*((~n) + 2) - (~B)*((~c)^2 + (~d)^2*((~n) + 1))))* sin((~e) + (~f)*(~x)) - (~b)^2*(~B)*(~d)*((~n) + 1)*((~c)^2 - (~d)^2)*sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_3_24",
@rule ∫(((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    gt((~m), 1) &&
    lt((~n), -1) ?
-((~b)*(~c) - (~a)*(~d))*((~B)*(~c) - (~A)*(~d))* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~d)*(~f)*((~n) + 1)*((~c)^2 - (~d)^2)) + 1⨸((~d)*((~n) + 1)*((~c)^2 - (~d)^2))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 2)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)* simp((~b)*((~b)*(~c) - (~a)*(~d))*((~B)*(~c) - (~A)*(~d))*((~m) - 1) + (~a)*(~d)*((~a)*(~A)*(~c) + (~b)*(~B)*(~c) - ((~A)*(~b) + (~a)*(~B))*(~d))*((~n) + 1) + ((~b)*((~b)*(~d)*((~B)*(~c) - (~A)*(~d)) + (~a)*((~A)*(~c)*(~d) + (~B)*((~c)^2 - 2*(~d)^2)))*((~n) + 1) - (~a)*((~b)*(~c) - (~a)*(~d))*((~B)*(~c) - (~A)*(~d))*((~n) + 2))*sin((~e) + (~f)*(~x)) + (~b)*((~d)*((~A)*(~b)*(~c) + (~a)*(~B)*(~c) - (~a)*(~A)*(~d))*((~m) + (~n) + 1) - (~b)*(~B)*((~c)^2*(~m) + (~d)^2*((~n) + 1)))*sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_3_25",
@rule ∫(((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    gt((~m), 1) &&
    !(
        igt((~n), 1) &&
        (
            !(ext_isinteger((~m))) ||
            eq((~a), 0) &&
            !eq((~c), 0)
        )
    ) ?
-(~b)*(~B)*cos( (~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) + 1)⨸((~d)*(~f)*((~m) + (~n) + 1)) + 1⨸((~d)*((~m) + (~n) + 1))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) - 2)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)* simp((~a)^2*(~A)*(~d)*((~m) + (~n) + 1) + (~b)*(~B)*((~b)*(~c)*((~m) - 1) + (~a)*(~d)*((~n) + 1)) + ((~a)*(~d)*(2*(~A)*(~b) + (~a)*(~B))*((~m) + (~n) + 1) - (~b)*(~B)*((~a)*(~c) - (~b)*(~d)*((~m) + (~n))))*sin((~e) + (~f)*(~x)) + (~b)*((~A)*(~b)*(~d)*((~m) + (~n) + 1) - (~B)*((~b)*(~c)*(~m) - (~a)*(~d)*(2*(~m) + (~n))))* sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_3_26",
@rule ∫(sqrt( (~c) + (~!d)*sin((~!e) + (~!f)*(~x)))*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))/((~!b)*sin((~!e) + (~!f)*(~x)))^(3//2),(~x)) =>
    !contains_var((~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~c)^2 - (~d)^2, 0) ?
(~B)*(~d)⨸(~b)^2*∫(sqrt((~b)*sin((~e) + (~f)*(~x)))⨸sqrt((~c) + (~d)*sin((~e) + (~f)*(~x))), (~x)) + ∫(((~A)*(~c) + ((~B)*(~c) + (~A)*(~d))*sin((~e) + (~f)*(~x)))⨸(((~b)*sin((~e) + (~f)*(~x)))^(3⨸2)* sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))), (~x)) : nothing)

("4_1_3_27",
@rule ∫(sqrt( (~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))/((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(3//2),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) ?
(~B)⨸(~b)*∫(sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))⨸sqrt((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) + ((~A)*(~b) - (~a)*(~B))⨸(~b)* ∫(sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))⨸((~a) + (~b)*sin((~e) + (~f)*(~x)))^(3⨸2), (~x)) : nothing)

("4_1_3_28",
@rule ∫(((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(3//2)* sqrt((~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~a)^2 - (~b)^2, 0) ?
2*((~A)*(~b) - (~a)*(~B))* cos((~e) + (~f)*(~x))⨸((~f)*((~a)^2 - (~b)^2)*sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))* sqrt((~d)*sin((~e) + (~f)*(~x)))) + (~d)⨸((~a)^2 - (~b)^2)* ∫(((~A)*(~b) - (~a)*(~B) + ((~a)*(~A) - (~b)*(~B))*sin((~e) + (~f)*(~x)))⨸(sqrt( (~a) + (~b)*sin((~e) + (~f)*(~x)))*((~d)*sin((~e) + (~f)*(~x)))^(3⨸2)), (~x)) : nothing)

("4_1_3_29",
@rule ∫(((~A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(((~!b)*sin((~!e) + (~!f)*(~x)))^(3//2)* sqrt((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    eq((~A), (~B)) &&
    pos(((~c) + (~d))/(~b)) ?
-2*(~A)*((~c) - (~d))*tan((~e) + (~f)*(~x))⨸((~f)*(~b)*(~c)^2)*rt(((~c) + (~d))⨸(~b), 2)* sqrt((~c)*(1 + csc((~e) + (~f)*(~x)))⨸((~c) - (~d)))* sqrt((~c)*(1 - csc((~e) + (~f)*(~x)))⨸((~c) + (~d)))* elliptic_e( asin(sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))⨸sqrt((~b)*sin((~e) + (~f)*(~x)))⨸ rt(((~c) + (~d))⨸(~b), 2)), -((~c) + (~d))⨸((~c) - (~d))) : nothing)

("4_1_3_30",
@rule ∫(((~A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(((~!b)*sin((~!e) + (~!f)*(~x)))^(3//2)* sqrt((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    eq((~A), (~B)) &&
    neg(((~c) + (~d))/(~b)) ?
-sqrt(-(~b)*sin((~e) + (~f)*(~x)))⨸sqrt((~b)*sin((~e) + (~f)*(~x)))* ∫(((~A) + (~B)*sin((~e) + (~f)*(~x)))⨸((-(~b)*sin((~e) + (~f)*(~x)))^(3⨸2)* sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))), (~x)) : nothing)

("4_1_3_31",
@rule ∫(((~A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(3//2)* sqrt((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    eq((~A), (~B)) &&
    pos(((~a) + (~b))/((~c) + (~d))) ?
-2*(~A)*((~c) - (~d))*((~a) + (~b)*sin((~e) + (~f)*(~x)))⨸((~f)*((~b)*(~c) - (~a)*(~d))^2*rt(((~a) + (~b))⨸((~c) + (~d)), 2)* cos((~e) + (~f)*(~x)))* sqrt(((~b)*(~c) - (~a)*(~d))*(1 + sin((~e) + (~f)*(~x)))⨸(((~c) - (~d))*((~a) + (~b)*sin((~e) + (~f)*(~x)))))* sqrt(-((~b)*(~c) - (~a)*(~d))*(1 - sin((~e) + (~f)*(~x)))⨸(((~c) + (~d))*((~a) + (~b)*sin((~e) + (~f)*(~x)))))* elliptic_e( asin(rt(((~a) + (~b))⨸((~c) + (~d)), 2)* sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))⨸sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))), ((~a) - (~b))*((~c) + (~d))⨸(((~a) + (~b))*((~c) - (~d)))) : nothing)

("4_1_3_32",
@rule ∫(((~A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(3//2)* sqrt((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    eq((~A), (~B)) &&
    neg(((~a) + (~b))/((~c) + (~d))) ?
sqrt(-(~c) - (~d)*sin((~e) + (~f)*(~x)))⨸sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))* ∫(((~A) + (~B)*sin((~e) + (~f)*(~x)))⨸(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(3⨸2)* sqrt(-(~c) - (~d)*sin((~e) + (~f)*(~x)))), (~x)) : nothing)

("4_1_3_33",
@rule ∫(((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(3//2)* sqrt((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    !eq((~A), (~B)) ?
((~A) - (~B))⨸((~a) - (~b))* ∫(1⨸(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))*sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))), (~x)) - ((~A)*(~b) - (~a)*(~B))⨸((~a) - (~b))* ∫((1 + sin((~e) + (~f)*(~x)))⨸(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(3⨸2)* sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))), (~x)) : nothing)

("4_1_3_34",
@rule ∫(((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    lt((~m), -1) &&
    gt((~n), 0) ?
((~B)*(~a) - (~A)*(~b))* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^ (~n)⨸((~f)*((~m) + 1)*((~a)^2 - (~b)^2)) + 1⨸(((~m) + 1)*((~a)^2 - (~b)^2))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) - 1)* simp((~c)*((~a)*(~A) - (~b)*(~B))*((~m) + 1) + (~d)*(~n)*((~A)*(~b) - (~a)*(~B)) + ((~d)*((~a)*(~A) - (~b)*(~B))*((~m) + 1) - (~c)*((~A)*(~b) - (~a)*(~B))*((~m) + 2))*sin((~e) + (~f)*(~x)) - (~d)*((~A)*(~b) - (~a)*(~B))*((~m) + (~n) + 2)*sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_3_35",
@rule ∫(((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    isrational((~m)) &&
    (~m) < -1 &&
    (
        eq((~a), 0) &&
        ext_isinteger((~m)) &&
        !(ext_isinteger((~n))) ||
        !(
            ext_isinteger(2*(~n)) &&
            lt((~n), -1) &&
            (
                ext_isinteger((~n)) &&
                !(ext_isinteger((~m))) ||
                eq((~a), 0)
            )
        )
    ) ?
-((~A)*(~b)^2 - (~a)*(~b)*(~B))* cos((~e) + (~f)*(~x))*((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(1 + (~n))⨸((~f)*((~m) + 1)*((~b)*(~c) - (~a)*(~d))*((~a)^2 - (~b)^2)) + 1⨸(((~m) + 1)*((~b)*(~c) - (~a)*(~d))*((~a)^2 - (~b)^2))* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^((~m) + 1)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)* simp(((~a)*(~A) - (~b)*(~B))*((~b)*(~c) - (~a)*(~d))*((~m) + 1) + (~b)*(~d)*((~A)*(~b) - (~a)*(~B))*((~m) + (~n) + 2) + ((~A)*(~b) - (~a)*(~B))*((~a)*(~d)*((~m) + 1) - (~b)*(~c)*((~m) + 2))*sin((~e) + (~f)*(~x)) - (~b)*(~d)*((~A)*(~b) - (~a)*(~B))*((~m) + (~n) + 3)*sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_3_36",
@rule ∫(((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) ?
((~A)*(~b) - (~a)*(~B))⨸((~b)*(~c) - (~a)*(~d))* ∫(1⨸((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) + ((~B)*(~c) - (~A)*(~d))⨸((~b)*(~c) - (~a)*(~d))* ∫(1⨸((~c) + (~d)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_3_37",
@rule ∫(((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))^ (~m)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))/((~!c) + (~!d)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) ?
(~B)⨸(~d)*∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m), (~x)) - ((~B)*(~c) - (~A)*(~d))⨸(~d)* ∫(((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)⨸((~c) + (~d)*sin((~e) + (~f)*(~x))), (~x)) : nothing)

("4_1_3_38",
@rule ∫(sqrt((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) &&
    eq((~n)^2, 1/4) ?
-2*(~B)*cos((~e) + (~f)*(~x))* sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))*((~c) + (~d)*sin((~e) + (~f)*(~x)))^(~n)⨸((~f)*(2*(~n) + 3)) + 1⨸(2*(~n) + 3)* ∫(((~c) + (~d)*sin((~e) + (~f)*(~x)))^((~n) - 1)⨸sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))* simp((~a)*(~A)*(~c)*(2*(~n) + 3) + (~B)*((~b)*(~c) + 2*(~a)*(~d)*(~n)) + ((~B)*((~a)*(~c) + (~b)*(~d))*(2*(~n) + 1) + (~A)*((~b)*(~c) + (~a)*(~d))*(2*(~n) + 3))* sin((~e) + (~f)*(~x)) + ((~A)*(~b)*(~d)*(2*(~n) + 3) + (~B)*((~a)*(~d) + 2*(~b)*(~c)*(~n)))*sin((~e) + (~f)*(~x))^2, (~x)), (~x)) : nothing)

("4_1_3_39",
@rule ∫(((~A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(sqrt(sin((~!e) + (~!f)*(~x)))* sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~A), (~B), (~x)) &&
    gt((~b), 0) &&
    gt((~b)^2 - (~a)^2, 0) &&
    eq((~A), (~B)) ?
4*(~A)⨸((~f)*sqrt((~a) + (~b)))* elliptic_pi(-1, -asin( cos((~e) + (~f)*(~x))⨸(1 + sin((~e) + (~f)*(~x)))), -((~a) - (~b))⨸((~a) + (~b))) : nothing)

("4_1_3_40",
@rule ∫(((~A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))* sqrt((~d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~e), (~f), (~d), (~A), (~B), (~x)) &&
    gt((~b), 0) &&
    gt((~b)^2 - (~a)^2, 0) &&
    eq((~A), (~B)) ?
sqrt(sin((~e) + (~f)*(~x)))⨸sqrt((~d)*sin((~e) + (~f)*(~x)))* ∫(((~A) + (~B)*sin((~e) + (~f)*(~x)))⨸(sqrt(sin((~e) + (~f)*(~x)))* sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))), (~x)) : nothing)

("4_1_3_41",
@rule ∫(((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))/(sqrt((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))* sqrt((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    !eq((~a)^2 - (~b)^2, 0) &&
    !eq((~c)^2 - (~d)^2, 0) ?
(~B)⨸(~d)*∫(sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))⨸sqrt((~a) + (~b)*sin((~e) + (~f)*(~x))), (~x)) - ((~B)*(~c) - (~A)*(~d))⨸(~d)* ∫(1⨸(sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))*sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))), (~x)) : nothing)

# ("4_1_3_42",
# @rule ∫(((~!a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~m)*((~!c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~!n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x))),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~n), (~x)) &&
#     !eq((~b)*(~c) - (~a)*(~d), 0) &&
#     !eq((~a)^2 - (~b)^2, 0) &&
#     !eq((~c)^2 - (~d)^2, 0) ?
# Unintegrable[((~a) + (~b)*sin((~e) + (~f)*(~x)))^(~m)*((~c) + (~d)*sin((~e) + (~f)*(~x)))^ (~n)*((~A) + (~B)*sin((~e) + (~f)*(~x))), (~x)] : nothing)

#(* Int[(a_+b_.*sin[e_.+f_.*x_])^m_*(c_+d_.*sin[e_.+f_.*x_])^n_*(A_.+B_ .*sin[e_.+f_.*x_])^p_,x_Symbol] := a^m*c^m*Int[Cos[e+f*x]^(2*m)*(c+d*Sin[e+f*x])^(n-m)*(A+B*Sin[e+f*x]) ^p,x] /; FreeQ[{a,b,c,d,e,f,A,B,n,p},x] && EqQ[b*c+a*d,0] && EqQ[a^2-b^2,0] &&  IntegerQ[m] && Not[IntegerQ[n] && (LtQ[m,0] && GtQ[n,0] || LtQ[0,n,m] ||  LtQ[m,n,0])] *)
#(* Int[(a_+b_.*cos[e_.+f_.*x_])^m_*(c_+d_.*cos[e_.+f_.*x_])^n_*(A_.+B_ .*cos[e_.+f_.*x_])^p_,x_Symbol] := a^m*c^m*Int[Sin[e+f*x]^(2*m)*(c+d*Cos[e+f*x])^(n-m)*(A+B*Cos[e+f*x]) ^p,x] /; FreeQ[{a,b,c,d,e,f,A,B,n,p},x] && EqQ[b*c+a*d,0] && EqQ[a^2-b^2,0] &&  IntegerQ[m] && Not[IntegerQ[n] && (LtQ[m,0] && GtQ[n,0] || LtQ[0,n,m] ||  LtQ[m,n,0])] *)
("4_1_3_43",
@rule ∫(((~a) + (~!b)*sin((~!e) + (~!f)*(~x)))^(~!m)*((~c) + (~!d)*sin((~!e) + (~!f)*(~x)))^ (~!n)*((~!A) + (~!B)*sin((~!e) + (~!f)*(~x)))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) ?
sqrt((~a) + (~b)*sin((~e) + (~f)*(~x)))* sqrt((~c) + (~d)*sin((~e) + (~f)*(~x)))⨸((~f)*cos((~e) + (~f)*(~x)))* int_and_subst(((~a) + (~b)*(~x))^((~m) - 1⨸2)*((~c) + (~d)*(~x))^((~n) - 1⨸2)*((~A) + (~B)*(~x))^(~p),  (~x), (~x), sin((~e) + (~f)*(~x)), "4_1_3_43") : nothing)

("4_1_3_44",
@rule ∫(((~a) + (~!b)*cos((~!e) + (~!f)*(~x)))^(~!m)*((~c) + (~!d)*cos((~!e) + (~!f)*(~x)))^ (~!n)*((~!A) + (~!B)*cos((~!e) + (~!f)*(~x)))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~A), (~B), (~m), (~n), (~p), (~x)) &&
    eq((~b)*(~c) + (~a)*(~d), 0) &&
    eq((~a)^2 - (~b)^2, 0) ?
-sqrt((~a) + (~b)*cos((~e) + (~f)*(~x)))*sqrt((~c) + (~d)*cos((~e) + (~f)*(~x)))⨸((~f)*sin((~e) + (~f)*(~x)))* int_and_subst(((~a) + (~b)*(~x))^((~m) - 1⨸2)*((~c) + (~d)*(~x))^((~n) - 1⨸2)*((~A) + (~B)*(~x))^(~p),  (~x), (~x), cos((~e) + (~f)*(~x)), "4_1_3_44") : nothing)


]
