file_rules = [
#(* ::Subsection::Closed:: *)
#(* 4.1.6 (a+b cos+c sin)^n *)
("4_1_6_1",
@rule ∫(sqrt((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~a)^2 - (~b)^2 - (~c)^2, 0) ?
-2*((~c)*cos((~d) + (~e)*(~x)) - (~b)*sin((~d) + (~e)*(~x)))⨸((~e)* sqrt((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))) : nothing)

("4_1_6_2",
@rule ∫(((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    gt((~n), 0) ?
-((~c)*cos((~d) + (~e)*(~x)) - (~b)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) - 1)⨸((~e)*(~n)) + (~a)*(2*(~n) - 1)⨸(~n)* ∫(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) - 1), (~x)) : nothing)

("4_1_6_3",
@rule ∫(1/((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~a)^2 - (~b)^2 - (~c)^2, 0) ?
-((~c) - (~a)*sin((~d) + (~e)*(~x)))⨸((~c)*(~e)*((~c)*cos((~d) + (~e)*(~x)) - (~b)*sin((~d) + (~e)*(~x)))) : nothing)

("4_1_6_4",
@rule ∫(1/sqrt((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~a)^2 - (~b)^2 - (~c)^2, 0) ?
∫(1⨸sqrt((~a) + sqrt((~b)^2 + (~c)^2)*cos((~d) + (~e)*(~x) - atan((~b), (~c)))), (~x)) : nothing)

("4_1_6_5",
@rule ∫(((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    lt((~n), -1) ?
((~c)*cos((~d) + (~e)*(~x)) - (~b)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^ (~n)⨸((~a)*(~e)*(2*(~n) + 1)) + ((~n) + 1)⨸((~a)*(2*(~n) + 1))* ∫(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) + 1), (~x)) : nothing)

("4_1_6_6",
@rule ∫(sqrt((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~b)^2 + (~c)^2, 0) ?
(~b)⨸((~c)*(~e))* int_and_subst(sqrt((~a) + (~x))⨸(~x),  (~x), (~x), (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)), "4_1_6_6") : nothing)

("4_1_6_7",
@rule ∫(sqrt((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~b)^2 + (~c)^2, 0) &&
    gt((~a) + sqrt((~b)^2 + (~c)^2), 0) ?
∫(sqrt((~a) + sqrt((~b)^2 + (~c)^2)*cos((~d) + (~e)*(~x) - atan((~b), (~c)))), (~x)) : nothing)

("4_1_6_8",
@rule ∫(sqrt((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    !eq((~b)^2 + (~c)^2, 0) &&
    !(gt((~a) + sqrt((~b)^2 + (~c)^2), 0)) ?
sqrt((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸ sqrt(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸((~a) + sqrt((~b)^2 + (~c)^2)))* ∫( sqrt((~a)⨸((~a) + sqrt((~b)^2 + (~c)^2)) + sqrt((~b)^2 + (~c)^2)⨸((~a) + sqrt((~b)^2 + (~c)^2))* cos((~d) + (~e)*(~x) - atan((~b), (~c)))), (~x)) : nothing)

("4_1_6_9",
@rule ∫(((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    gt((~n), 1) ?
-((~c)*cos((~d) + (~e)*(~x)) - (~b)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) - 1)⨸((~e)*(~n)) + 1⨸(~n)* ∫(simp( (~n)*(~a)^2 + ((~n) - 1)*((~b)^2 + (~c)^2) + (~a)*(~b)*(2*(~n) - 1)*cos((~d) + (~e)*(~x)) + (~a)*(~c)*(2*(~n) - 1)*sin((~d) + (~e)*(~x)), (~x))* ((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) - 2), (~x)) : nothing)

#(* Int[1/(a_+b_.*cos[d_.+e_.*x_]+c_.*sin[d_.+e_.*x_]),x_Symbol] := x/Sqrt[a^2-b^2-c^2] + 2/(e*Sqrt[a^2-b^2-c^2])*ArcTan[(c*Cos[d+e*x]-b*Sin[d+e*x])/(a+Sqrt[ a^2-b^2-c^2]+b*Cos[d+e*x]+c*Sin[d+e*x])] /; FreeQ[{a,b,c,d,e},x] && GtQ[a^2-b^2-c^2,0] *)
#(* Int[1/(a_+b_.*cos[d_.+e_.*x_]+c_.*sin[d_.+e_.*x_]),x_Symbol] := Log[RemoveContent[b^2+c^2+(a*b-c*Rt[-a^2+b^2+c^2,2])*Cos[d+e*x]+(a* c+b*Sqrt[-a^2+b^2+c^2])*Sin[d+e*x],x]]/ (2*e*Rt[-a^2+b^2+c^2,2]) - Log[RemoveContent[b^2+c^2+(a*b+c*Rt[-a^2+b^2+c^2,2])*Cos[d+e*x]+(a* c-b*Sqrt[-a^2+b^2+c^2])*Sin[d+e*x],x]]/ (2*e*Rt[-a^2+b^2+c^2,2]) /; FreeQ[{a,b,c,d,e},x] && LtQ[a^2-b^2-c^2,0] *)
("4_1_6_10",
@rule ∫(1/((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~a) + (~b), 0) ?
-free_factors(cot(((~d) + (~e)*(~x))⨸2), (~x))⨸(~e)*int_and_subst(1⨸((~a) + (~c)*free_factors(cot(((~d) + (~e)*(~x))⨸2),  (~x))*(~x)), (~x), (~x), cot(((~d) + (~e)*(~x))⨸2)⨸free_factors(cot(((~d) + (~e)*(~x))⨸2), (~x)), "4_1_6_10") : nothing)

("4_1_6_11",
@rule ∫(1/((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~a) + (~c), 0) ?
free_factors(tan(((~d) + (~e)*(~x))⨸2 + π⨸4), (~x))⨸(~e)*int_and_subst(1⨸((~a) + (~b)*free_factors(tan(((~d) + (~e)*(~x))⨸2 + π⨸4),  (~x))*(~x)), (~x), (~x), tan(((~d) + (~e)*(~x))⨸2 + π⨸4)⨸free_factors(tan(((~d) + (~e)*(~x))⨸2 + π⨸4), (~x)), "4_1_6_11") : nothing)

("4_1_6_12",
@rule ∫(1/((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~a) - (~c), 0) &&
    !eq((~a) - (~b), 0) ?
-free_factors(cot(((~d) + (~e)*(~x))⨸2 + π⨸4), (~x))⨸(~e)* int_and_subst(1⨸((~a) + (~b)*free_factors(cot(((~d) + (~e)*(~x))⨸2 + π⨸4),  (~x))*(~x)), (~x), (~x), cot(((~d) + (~e)*(~x))⨸2 + π⨸4)⨸free_factors(cot(((~d) + (~e)*(~x))⨸2 + π⨸4), (~x)), "4_1_6_12") : nothing)

("4_1_6_13",
@rule ∫(1/((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) ?
2*free_factors(tan(((~d) + (~e)*(~x))⨸2), (~x))⨸(~e)* int_and_subst(1⨸((~a) + (~b) + 2*(~c)*free_factors(tan(((~d) + (~e)*(~x))⨸2),  (~x))*(~x) + ((~a) - (~b))*free_factors(tan(((~d) + (~e)*(~x))⨸2), (~x))^2*(~x)^2), (~x), (~x), tan(((~d) + (~e)*(~x))⨸2)⨸free_factors(tan(((~d) + (~e)*(~x))⨸2), (~x)), "4_1_6_13") : nothing)

("4_1_6_14",
@rule ∫(1/sqrt((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~b)^2 + (~c)^2, 0) ?
(~b)⨸((~c)*(~e))* int_and_subst(1⨸((~x)*sqrt((~a) + (~x))),  (~x), (~x), (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)), "4_1_6_14") : nothing)

("4_1_6_15",
@rule ∫(1/sqrt((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~b)^2 + (~c)^2, 0) &&
    gt((~a) + sqrt((~b)^2 + (~c)^2), 0) ?
∫(1⨸sqrt((~a) + sqrt((~b)^2 + (~c)^2)*cos((~d) + (~e)*(~x) - atan((~b), (~c)))), (~x)) : nothing)

("4_1_6_16",
@rule ∫(1/sqrt((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    !eq((~b)^2 + (~c)^2, 0) &&
    !(gt((~a) + sqrt((~b)^2 + (~c)^2), 0)) ?
sqrt(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸((~a) + sqrt((~b)^2 + (~c)^2)))⨸ sqrt((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))* ∫( 1⨸sqrt((~a)⨸((~a) + sqrt((~b)^2 + (~c)^2)) + sqrt((~b)^2 + (~c)^2)⨸((~a) + sqrt((~b)^2 + (~c)^2))* cos((~d) + (~e)*(~x) - atan((~b), (~c)))), (~x)) : nothing)

("4_1_6_17",
@rule ∫(1/((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(3//2),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) ?
2*((~c)*cos((~d) + (~e)*(~x)) - (~b)*sin((~d) + (~e)*(~x)))⨸((~e)*((~a)^2 - (~b)^2 - (~c)^2)* sqrt((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))) + 1⨸((~a)^2 - (~b)^2 - (~c)^2)* ∫(sqrt((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_6_18",
@rule ∫(((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    lt((~n), -1) &&
    !eq((~n), -3/2) ?
(-(~c)*cos((~d) + (~e)*(~x)) + (~b)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) + 1)⨸((~e)*((~n) + 1)*((~a)^2 - (~b)^2 - (~c)^2)) + 1⨸(((~n) + 1)*((~a)^2 - (~b)^2 - (~c)^2))* ∫(((~a)*((~n) + 1) - (~b)*((~n) + 2)*cos((~d) + (~e)*(~x)) - (~c)*((~n) + 2)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) + 1), (~x)) : nothing)

("4_1_6_19",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)) + (~!C)*sin((~!d) + (~!e)*(~x)))/((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~C), (~x)) &&
    eq((~b)^2 + (~c)^2, 0) ?
(2*(~a)*(~A) - (~b)*(~B) - (~c)*(~C))* (~x)⨸(2*(~a)^2) - ((~b)*(~B) + (~c)*(~C))*((~b)*cos((~d) + (~e)*(~x)) - (~c)*sin((~d) + (~e)*(~x)))⨸(2*(~a)*(~b)*(~c)*(~e)) + ((~a)^2*((~b)*(~B) - (~c)*(~C)) - 2*(~a)*(~A)*(~b)^2 + (~b)^2*((~b)*(~B) + (~c)*(~C)))* log((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸(2*(~a)^2* (~b)*(~c)*(~e)) : nothing)

("4_1_6_20",
@rule ∫(((~!A) + (~!C)*sin((~!d) + (~!e)*(~x)))/((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~C), (~x)) &&
    eq((~b)^2 + (~c)^2, 0) ?
(2*(~a)*(~A) - (~c)*(~C))*(~x)⨸(2*(~a)^2) - (~C)*cos((~d) + (~e)*(~x))⨸(2*(~a)*(~e)) + (~c)*(~C)*sin((~d) + (~e)*(~x))⨸(2*(~a)*(~b)*(~e)) + (-(~a)^2*(~C) + 2*(~a)*(~c)*(~A) + (~b)^2*(~C))* log((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸(2*(~a)^2* (~b)*(~e)) : nothing)

("4_1_6_21",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)))/((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    eq((~b)^2 + (~c)^2, 0) ?
(2*(~a)*(~A) - (~b)*(~B))*(~x)⨸(2*(~a)^2) - (~b)*(~B)*cos((~d) + (~e)*(~x))⨸(2*(~a)*(~c)*(~e)) + (~B)*sin((~d) + (~e)*(~x))⨸(2*(~a)*(~e)) + ((~a)^2*(~B) - 2*(~a)*(~b)*(~A) + (~b)^2*(~B))* log((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸(2*(~a)^2* (~c)*(~e)) : nothing)

("4_1_6_22",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)) + (~!C)*sin((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~C), (~x)) &&
    !eq((~b)^2 + (~c)^2, 0) &&
    eq((~A)*((~b)^2 + (~c)^2) - (~a)*((~b)*(~B) + (~c)*(~C)), 0) ?
((~b)*(~B) + (~c)*(~C))*(~x)⨸((~b)^2 + (~c)^2) + ((~c)*(~B) - (~b)*(~C))* log((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸((~e)*((~b)^2 + (~c)^2)) : nothing)

("4_1_6_23",
@rule ∫(((~!A) + (~!C)*sin((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~C), (~x)) &&
    !eq((~b)^2 + (~c)^2, 0) &&
    eq((~A)*((~b)^2 + (~c)^2) - (~a)*(~c)*(~C), 0) ?
(~c)*(~C)*(~x)⨸((~b)^2 + (~c)^2) - (~b)*(~C)*log((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸((~e)*((~b)^2 + (~c)^2)) : nothing)

("4_1_6_24",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    !eq((~b)^2 + (~c)^2, 0) &&
    eq((~A)*((~b)^2 + (~c)^2) - (~a)*(~b)*(~B), 0) ?
(~b)*(~B)*(~x)⨸((~b)^2 + (~c)^2) + (~c)*(~B)*log((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸((~e)*((~b)^2 + (~c)^2)) : nothing)

("4_1_6_25",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)) + (~!C)*sin((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~C), (~x)) &&
    !eq((~b)^2 + (~c)^2, 0) &&
    !eq((~A)*((~b)^2 + (~c)^2) - (~a)*((~b)*(~B) + (~c)*(~C)), 0) ?
((~b)*(~B) + (~c)*(~C))*(~x)⨸((~b)^2 + (~c)^2) + ((~c)*(~B) - (~b)*(~C))* log((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸((~e)*((~b)^2 + (~c)^2)) + ((~A)*((~b)^2 + (~c)^2) - (~a)*((~b)*(~B) + (~c)*(~C)))⨸((~b)^2 + (~c)^2)* ∫(1⨸((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_6_26",
@rule ∫(((~!A) + (~!C)*sin((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~C), (~x)) &&
    !eq((~b)^2 + (~c)^2, 0) &&
    !eq((~A)*((~b)^2 + (~c)^2) - (~a)*(~c)*(~C), 0) ?
(~c)*(~C)*((~d) + (~e)*(~x))⨸((~e)*((~b)^2 + (~c)^2)) - (~b)*(~C)*log((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸((~e)*((~b)^2 + (~c)^2)) + ((~A)*((~b)^2 + (~c)^2) - (~a)*(~c)*(~C))⨸((~b)^2 + (~c)^2)* ∫(1⨸((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_6_27",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    !eq((~b)^2 + (~c)^2, 0) &&
    !eq((~A)*((~b)^2 + (~c)^2) - (~a)*(~b)*(~B), 0) ?
(~b)*(~B)*((~d) + (~e)*(~x))⨸((~e)*((~b)^2 + (~c)^2)) + (~c)*(~B)*log((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))⨸((~e)*((~b)^2 + (~c)^2)) + ((~A)*((~b)^2 + (~c)^2) - (~a)*(~b)*(~B))⨸((~b)^2 + (~c)^2)* ∫(1⨸((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_6_28",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)) + (~!C)*sin((~!d) + (~!e)*(~x)))*((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~C), (~n), (~x)) &&
    !eq((~n), -1) &&
    eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    eq(((~b)*(~B) + (~c)*(~C))*(~n) + (~a)*(~A)*((~n) + 1), 0) ?
((~B)*(~c) - (~b)*(~C) - (~a)*(~C)*cos((~d) + (~e)*(~x)) + (~a)*(~B)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^ (~n)⨸((~a)*(~e)*((~n) + 1)) : nothing)

("4_1_6_29",
@rule ∫(((~!A) + (~!C)*sin((~!d) + (~!e)*(~x)))*((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~C), (~n), (~x)) &&
    !eq((~n), -1) &&
    eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    eq((~c)*(~C)*(~n) + (~a)*(~A)*((~n) + 1), 0) ?
-((~b)*(~C) + (~a)*(~C)*cos((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^ (~n)⨸((~a)*(~e)*((~n) + 1)) : nothing)

("4_1_6_30",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)))*((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~n), (~x)) &&
    !eq((~n), -1) &&
    eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    eq((~b)*(~B)*(~n) + (~a)*(~A)*((~n) + 1), 0) ?
((~B)*(~c) + (~a)*(~B)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^ (~n)⨸((~a)*(~e)*((~n) + 1)) : nothing)

("4_1_6_31",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)) + (~!C)*sin((~!d) + (~!e)*(~x)))*((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~C), (~n), (~x)) &&
    !eq((~n), -1) &&
    eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    !eq(((~b)*(~B) + (~c)*(~C))*(~n) + (~a)*(~A)*((~n) + 1), 0) ?
((~B)*(~c) - (~b)*(~C) - (~a)*(~C)*cos((~d) + (~e)*(~x)) + (~a)*(~B)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^ (~n)⨸((~a)*(~e)*((~n) + 1)) + (((~b)*(~B) + (~c)*(~C))*(~n) + (~a)*(~A)*((~n) + 1))⨸((~a)*((~n) + 1))* ∫(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^(~n), (~x)) : nothing)

("4_1_6_32",
@rule ∫(((~!A) + (~!C)*sin((~!d) + (~!e)*(~x)))*((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~C), (~n), (~x)) &&
    !eq((~n), -1) &&
    eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    !eq((~c)*(~C)*(~n) + (~a)*(~A)*((~n) + 1), 0) ?
-((~b)*(~C) + (~a)*(~C)*cos((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^ (~n)⨸((~a)*(~e)*((~n) + 1)) + ((~c)*(~C)*(~n) + (~a)*(~A)*((~n) + 1))⨸((~a)*((~n) + 1))* ∫(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^(~n), (~x)) : nothing)

("4_1_6_33",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)))*((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~n), (~x)) &&
    !eq((~n), -1) &&
    eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    !eq((~b)*(~B)*(~n) + (~a)*(~A)*((~n) + 1), 0) ?
((~B)*(~c) + (~a)*(~B)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^ (~n)⨸((~a)*(~e)*((~n) + 1)) + ((~b)*(~B)*(~n) + (~a)*(~A)*((~n) + 1))⨸((~a)*((~n) + 1))* ∫(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^(~n), (~x)) : nothing)

("4_1_6_34",
@rule ∫(((~!B)*cos((~!d) + (~!e)*(~x)) + (~!C)*sin((~!d) + (~!e)*(~x)))*((~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~b), (~c), (~d), (~e), (~B), (~C), (~x)) &&
    !eq((~n), -1) &&
    !eq((~b)^2 + (~c)^2, 0) &&
    eq((~b)*(~B) + (~c)*(~C), 0) ?
((~c)*(~B) - (~b)*(~C))*((~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) + 1)⨸((~e)*((~n) + 1)*((~b)^2 + (~c)^2)) : nothing)

("4_1_6_35",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)) + (~!C)*sin((~!d) + (~!e)*(~x)))*((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~C), (~x)) &&
    gt((~n), 0) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) ?
((~B)*(~c) - (~b)*(~C) - (~a)*(~C)*cos((~d) + (~e)*(~x)) + (~a)*(~B)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^ (~n)⨸((~a)*(~e)*((~n) + 1)) + 1⨸((~a)*((~n) + 1))*∫(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) - 1)* simp((~a)*((~b)*(~B) + (~c)*(~C))*(~n) + (~a)^2*(~A)*((~n) + 1) + ((~n)*((~a)^2*(~B) - (~B)*(~c)^2 + (~b)*(~c)*(~C)) + (~a)*(~b)*(~A)*((~n) + 1))* cos((~d) + (~e)*(~x)) + ((~n)*((~b)*(~B)*(~c) + (~a)^2*(~C) - (~b)^2*(~C)) + (~a)*(~c)*(~A)*((~n) + 1))* sin((~d) + (~e)*(~x)), (~x)), (~x)) : nothing)

("4_1_6_36",
@rule ∫(((~!A) + (~!C)*sin((~!d) + (~!e)*(~x)))*((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~C), (~x)) &&
    gt((~n), 0) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) ?
-((~b)*(~C) + (~a)*(~C)*cos((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^ (~n)⨸((~a)*(~e)*((~n) + 1)) + 1⨸((~a)*((~n) + 1))*∫(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) - 1)* simp((~a)*(~c)*(~C)*(~n) + (~a)^2*(~A)*((~n) + 1) + ((~c)*(~b)*(~C)*(~n) + (~a)*(~b)*(~A)*((~n) + 1))* cos((~d) + (~e)*(~x)) + ((~a)^2*(~C)*(~n) - (~b)^2*(~C)*(~n) + (~a)*(~c)*(~A)*((~n) + 1))* sin((~d) + (~e)*(~x)), (~x)), (~x)) : nothing)

("4_1_6_37",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)))*((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    gt((~n), 0) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) ?
((~B)*(~c) + (~a)*(~B)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^ (~n)⨸((~a)*(~e)*((~n) + 1)) + 1⨸((~a)*((~n) + 1))*∫(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) - 1)* simp((~a)*(~b)*(~B)*(~n) + (~a)^2*(~A)*((~n) + 1) + ((~a)^2*(~B)*(~n) - (~c)^2*(~B)*(~n) + (~a)*(~b)*(~A)*((~n) + 1))* cos((~d) + (~e)*(~x)) + ((~b)*(~c)*(~B)*(~n) + (~a)*(~c)*(~A)*((~n) + 1))*sin((~d) + (~e)*(~x)), (~x)), (~x)) : nothing)

("4_1_6_38",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)) + (~!C)*sin((~!d) + (~!e)*(~x)))/ sqrt((~a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~C), (~x)) &&
    eq((~B)*(~c) - (~b)*(~C), 0) &&
    !eq((~A)*(~b) - (~a)*(~B), 0) ?
(~B)⨸(~b)*∫(sqrt((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))), (~x)) + ((~A)*(~b) - (~a)*(~B))⨸(~b)* ∫(1⨸sqrt((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_6_39",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)) + (~!C)*sin((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^2,(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~C), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    eq((~a)*(~A) - (~b)*(~B) - (~c)*(~C), 0) ?
((~c)*(~B) - (~b)*(~C) - ((~a)*(~C) - (~c)*(~A))*cos((~d) + (~e)*(~x)) + ((~a)*(~B) - (~b)*(~A))*sin((~d) + (~e)*(~x)))⨸ ((~e)*((~a)^2 - (~b)^2 - (~c)^2)*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))) : nothing)

("4_1_6_40",
@rule ∫(((~!A) + (~!C)*sin((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^2,(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~C), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    eq((~a)*(~A) - (~c)*(~C), 0) ?
-((~b)*(~C) + ((~a)*(~C) - (~c)*(~A))*cos((~d) + (~e)*(~x)) + (~b)*(~A)*sin((~d) + (~e)*(~x)))⨸((~e)*((~a)^2 - (~b)^2 - (~c)^2)*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))) : nothing)

("4_1_6_41",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^2,(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    eq((~a)*(~A) - (~b)*(~B), 0) ?
((~c)*(~B) + (~c)*(~A)*cos((~d) + (~e)*(~x)) + ((~a)*(~B) - (~b)*(~A))* sin((~d) + (~e)*(~x)))⨸((~e)*((~a)^2 - (~b)^2 - (~c)^2)*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))) : nothing)

("4_1_6_42",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)) + (~!C)*sin((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^2,(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~C), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    !eq((~a)*(~A) - (~b)*(~B) - (~c)*(~C), 0) ?
((~c)*(~B) - (~b)*(~C) - ((~a)*(~C) - (~c)*(~A))*cos((~d) + (~e)*(~x)) + ((~a)*(~B) - (~b)*(~A))*sin((~d) + (~e)*(~x)))⨸ ((~e)*((~a)^2 - (~b)^2 - (~c)^2)*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))) + ((~a)*(~A) - (~b)*(~B) - (~c)*(~C))⨸((~a)^2 - (~b)^2 - (~c)^2)* ∫(1⨸((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_6_43",
@rule ∫(((~!A) + (~!C)*sin((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^2,(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~C), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    !eq((~a)*(~A) - (~c)*(~C), 0) ?
-((~b)*(~C) + ((~a)*(~C) - (~c)*(~A))*cos((~d) + (~e)*(~x)) + (~b)*(~A)*sin((~d) + (~e)*(~x)))⨸((~e)*((~a)^2 - (~b)^2 - (~c)^2)*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))) + ((~a)*(~A) - (~c)*(~C))⨸((~a)^2 - (~b)^2 - (~c)^2)* ∫(1⨸((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_6_44",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)))/((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^2,(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    !eq((~a)*(~A) - (~b)*(~B), 0) ?
((~c)*(~B) + (~c)*(~A)*cos((~d) + (~e)*(~x)) + ((~a)*(~B) - (~b)*(~A))* sin((~d) + (~e)*(~x)))⨸((~e)*((~a)^2 - (~b)^2 - (~c)^2)*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))) + ((~a)*(~A) - (~b)*(~B))⨸((~a)^2 - (~b)^2 - (~c)^2)* ∫(1⨸((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_6_45",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)) + (~!C)*sin((~!d) + (~!e)*(~x)))*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~C), (~x)) &&
    lt((~n), -1) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    !eq((~n), -2) ?
-((~c)*(~B) - (~b)*(~C) - ((~a)*(~C) - (~c)*(~A))*cos((~d) + (~e)*(~x)) + ((~a)*(~B) - (~b)*(~A))*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) + 1)⨸ ((~e)*((~n) + 1)*((~a)^2 - (~b)^2 - (~c)^2)) + 1⨸(((~n) + 1)*((~a)^2 - (~b)^2 - (~c)^2))* ∫(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) + 1)* simp(((~n) + 1)*((~a)*(~A) - (~b)*(~B) - (~c)*(~C)) + ((~n) + 2)*((~a)*(~B) - (~b)*(~A))* cos((~d) + (~e)*(~x)) + ((~n) + 2)*((~a)*(~C) - (~c)*(~A))*sin((~d) + (~e)*(~x)), (~x)), (~x)) : nothing)

("4_1_6_46",
@rule ∫(((~!A) + (~!C)*sin((~!d) + (~!e)*(~x)))*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~C), (~x)) &&
    lt((~n), -1) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    !eq((~n), -2) ?
((~b)*(~C) + ((~a)*(~C) - (~c)*(~A))*cos((~d) + (~e)*(~x)) + (~b)*(~A)*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) + 1)⨸ ((~e)*((~n) + 1)*((~a)^2 - (~b)^2 - (~c)^2)) + 1⨸(((~n) + 1)*((~a)^2 - (~b)^2 - (~c)^2))* ∫(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) + 1)* simp(((~n) + 1)*((~a)*(~A) - (~c)*(~C)) - ((~n) + 2)*(~b)*(~A)* cos((~d) + (~e)*(~x)) + ((~n) + 2)*((~a)*(~C) - (~c)*(~A))*sin((~d) + (~e)*(~x)), (~x)), (~x)) : nothing)

("4_1_6_47",
@rule ∫(((~!A) + (~!B)*cos((~!d) + (~!e)*(~x)))*((~!a) + (~!b)*cos((~!d) + (~!e)*(~x)) + (~!c)*sin((~!d) + (~!e)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~x)) &&
    lt((~n), -1) &&
    !eq((~a)^2 - (~b)^2 - (~c)^2, 0) &&
    !eq((~n), -2) ?
-((~c)*(~B) + (~c)*(~A)*cos((~d) + (~e)*(~x)) + ((~a)*(~B) - (~b)*(~A))*sin((~d) + (~e)*(~x)))*((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) + 1)⨸ ((~e)*((~n) + 1)*((~a)^2 - (~b)^2 - (~c)^2)) + 1⨸(((~n) + 1)*((~a)^2 - (~b)^2 - (~c)^2))* ∫(((~a) + (~b)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^((~n) + 1)* simp(((~n) + 1)*((~a)*(~A) - (~b)*(~B)) + ((~n) + 2)*((~a)*(~B) - (~b)*(~A))* cos((~d) + (~e)*(~x)) - ((~n) + 2)*(~c)*(~A)*sin((~d) + (~e)*(~x)), (~x)), (~x)) : nothing)

("4_1_6_48",
@rule ∫(1/((~!a) + (~!b)*sec((~!d) + (~!e)*(~x)) + (~!c)*tan((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) ?
∫(cos((~d) + (~e)*(~x))⨸((~b) + (~a)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_6_49",
@rule ∫(1/((~!a) + (~!b)*csc((~!d) + (~!e)*(~x)) + (~!c)*cot((~!d) + (~!e)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) ?
∫(sin((~d) + (~e)*(~x))⨸((~b) + (~a)*sin((~d) + (~e)*(~x)) + (~c)*cos((~d) + (~e)*(~x))), (~x)) : nothing)

("4_1_6_50",
@rule ∫(cos((~!d) + (~!e)*(~x))^ (~!n)*((~!a) + (~!b)*sec((~!d) + (~!e)*(~x)) + (~!c)*tan((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    ext_isinteger((~n)) ?
∫(((~b) + (~a)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^(~n), (~x)) : nothing)

("4_1_6_51",
@rule ∫(sin((~!d) + (~!e)*(~x))^ (~!n)*((~!a) + (~!b)*csc((~!d) + (~!e)*(~x)) + (~!c)*cot((~!d) + (~!e)*(~x)))^(~!n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    ext_isinteger((~n)) ?
∫(((~b) + (~a)*sin((~d) + (~e)*(~x)) + (~c)*cos((~d) + (~e)*(~x)))^(~n), (~x)) : nothing)

("4_1_6_52",
@rule ∫(cos((~!d) + (~!e)*(~x))^ (~n)*((~!a) + (~!b)*sec((~!d) + (~!e)*(~x)) + (~!c)*tan((~!d) + (~!e)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    !(ext_isinteger((~n))) ?
cos((~d) + (~e)*(~x))^ (~n)*((~a) + (~b)*sec((~d) + (~e)*(~x)) + (~c)*tan((~d) + (~e)*(~x)))^ (~n)⨸((~b) + (~a)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^(~n)* ∫(((~b) + (~a)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^(~n), (~x)) : nothing)

("4_1_6_53",
@rule ∫(sin((~!d) + (~!e)*(~x))^ (~n)*((~!a) + (~!b)*csc((~!d) + (~!e)*(~x)) + (~!c)*cot((~!d) + (~!e)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    !(ext_isinteger((~n))) ?
sin((~d) + (~e)*(~x))^ (~n)*((~a) + (~b)*csc((~d) + (~e)*(~x)) + (~c)*cot((~d) + (~e)*(~x)))^ (~n)⨸((~b) + (~a)*sin((~d) + (~e)*(~x)) + (~c)*cos((~d) + (~e)*(~x)))^(~n)* ∫(((~b) + (~a)*sin((~d) + (~e)*(~x)) + (~c)*cos((~d) + (~e)*(~x)))^(~n), (~x)) : nothing)

("4_1_6_54",
@rule ∫(sec((~!d) + (~!e)*(~x))^ (~!n)*((~!a) + (~!b)*sec((~!d) + (~!e)*(~x)) + (~!c)*tan((~!d) + (~!e)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~m) + (~n), 0) &&
    ext_isinteger((~n)) ?
∫(1⨸((~b) + (~a)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^(~n), (~x)) : nothing)

("4_1_6_55",
@rule ∫(csc((~!d) + (~!e)*(~x))^ (~!n)*((~!a) + (~!b)*csc((~!d) + (~!e)*(~x)) + (~!c)*cot((~!d) + (~!e)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~m) + (~n), 0) &&
    ext_isinteger((~n)) ?
∫(1⨸((~b) + (~a)*sin((~d) + (~e)*(~x)) + (~c)*cos((~d) + (~e)*(~x)))^(~n), (~x)) : nothing)

("4_1_6_56",
@rule ∫(sec((~!d) + (~!e)*(~x))^ (~!n)*((~!a) + (~!b)*sec((~!d) + (~!e)*(~x)) + (~!c)*tan((~!d) + (~!e)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~m) + (~n), 0) &&
    !(ext_isinteger((~n))) ?
sec((~d) + (~e)*(~x))^ (~n)*((~b) + (~a)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^ (~n)⨸((~a) + (~b)*sec((~d) + (~e)*(~x)) + (~c)*tan((~d) + (~e)*(~x)))^(~n)* ∫(1⨸((~b) + (~a)*cos((~d) + (~e)*(~x)) + (~c)*sin((~d) + (~e)*(~x)))^(~n), (~x)) : nothing)

("4_1_6_57",
@rule ∫(csc((~!d) + (~!e)*(~x))^ (~!n)*((~!a) + (~!b)*csc((~!d) + (~!e)*(~x)) + (~!c)*cot((~!d) + (~!e)*(~x)))^(~m),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    eq((~m) + (~n), 0) &&
    !(ext_isinteger((~n))) ?
csc((~d) + (~e)*(~x))^ (~n)*((~b) + (~a)*sin((~d) + (~e)*(~x)) + (~c)*cos((~d) + (~e)*(~x)))^ (~n)⨸((~a) + (~b)*csc((~d) + (~e)*(~x)) + (~c)*cot((~d) + (~e)*(~x)))^(~n)* ∫(1⨸((~b) + (~a)*sin((~d) + (~e)*(~x)) + (~c)*cos((~d) + (~e)*(~x)))^(~n), (~x)) : nothing)


]
