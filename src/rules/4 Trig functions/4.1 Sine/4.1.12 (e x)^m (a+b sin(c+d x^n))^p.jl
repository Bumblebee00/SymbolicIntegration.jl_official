file_rules = [
#(* ::Subsection::Closed:: *)
#(* 4.1.12 (e x)^m (a+b sin(c+d x^n))^p *)
("4_1_12_1",
@rule ∫(sin((~!d)*((~!e) + (~!f)*(~x))^2),(~x)) =>
    !contains_var((~d), (~e), (~f), (~x)) ?
sqrt(π⨸2)⨸((~f)*rt((~d), 2))*FresnelIntegrals.fresnels(sqrt(2⨸π)*rt((~d), 2)*((~e) + (~f)*(~x))) : nothing)

("4_1_12_2",
@rule ∫(cos((~!d)*((~!e) + (~!f)*(~x))^2),(~x)) =>
    !contains_var((~d), (~e), (~f), (~x)) ?
sqrt(π⨸2)⨸((~f)*rt((~d), 2))*FresnelIntegrals.fresnelc(sqrt(2⨸π)*rt((~d), 2)*((~e) + (~f)*(~x))) : nothing)

("4_1_12_3",
@rule ∫(sin((~c) + (~!d)*((~!e) + (~!f)*(~x))^2),(~x)) =>
    !contains_var((~c), (~d), (~e), (~f), (~x)) ?
sin((~c))*∫(cos((~d)*((~e) + (~f)*(~x))^2), (~x)) + cos((~c))*∫(sin((~d)*((~e) + (~f)*(~x))^2), (~x)) : nothing)

("4_1_12_4",
@rule ∫(cos((~c) + (~!d)*((~!e) + (~!f)*(~x))^2),(~x)) =>
    !contains_var((~c), (~d), (~e), (~f), (~x)) ?
cos((~c))*∫(cos((~d)*((~e) + (~f)*(~x))^2), (~x)) - sin((~c))*∫(sin((~d)*((~e) + (~f)*(~x))^2), (~x)) : nothing)

("4_1_12_5",
@rule ∫(sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~f), (~x)) &&
    igt((~n), 2) ?
(~I)⨸2*∫(ℯ^(-(~c)*(~I) - (~d)*(~I)*((~e) + (~f)*(~x))^(~n)), (~x)) - (~I)⨸2*∫(ℯ^((~c)*(~I) + (~d)*(~I)*((~e) + (~f)*(~x))^(~n)), (~x)) : nothing)

("4_1_12_6",
@rule ∫(cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~f), (~x)) &&
    igt((~n), 2) ?
1⨸2*∫(ℯ^(-(~c)*(~I) - (~d)*(~I)*((~e) + (~f)*(~x))^(~n)), (~x)) + 1⨸2*∫(ℯ^((~c)*(~I) + (~d)*(~I)*((~e) + (~f)*(~x))^(~n)), (~x)) : nothing)

# ("4_1_12_7",
# @rule ∫(((~!a) + (~!b)*sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~x)) &&
#     igt((~p), 1) &&
#     igt((~n), 1) ?
# ∫(ExpandTrigReduce[((~a) + (~b)*sin((~c) + (~d)*((~e) + (~f)*(~x))^(~n)))^(~p), (~x)], (~x)) : nothing)
# 
# ("4_1_12_8",
# @rule ∫(((~!a) + (~!b)*cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~x)) &&
#     igt((~p), 1) &&
#     igt((~n), 1) ?
# ∫(ExpandTrigReduce[((~a) + (~b)*cos((~c) + (~d)*((~e) + (~f)*(~x))^(~n)))^(~p), (~x)], (~x)) : nothing)

("4_1_12_9",
@rule ∫(((~!a) + (~!b)*sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~x)) &&
    igt((~p), 0) &&
    ilt((~n), 0) &&
    eq((~n), -2) ?
-1⨸(~f)*int_and_subst(((~a) + (~b)*sin((~c) + (~d)*(~x)^(-(~n))))^(~p)⨸(~x)^2,  (~x), (~x), 1⨸((~e) + (~f)*(~x)), "4_1_12_9") : nothing)

("4_1_12_10",
@rule ∫(((~!a) + (~!b)*cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~x)) &&
    igt((~p), 0) &&
    ilt((~n), 0) &&
    eq((~n), -2) ?
-1⨸(~f)*int_and_subst(((~a) + (~b)*cos((~c) + (~d)*(~x)^(-(~n))))^(~p)⨸(~x)^2,  (~x), (~x), 1⨸((~e) + (~f)*(~x)), "4_1_12_10") : nothing)

("4_1_12_11",
@rule ∫(((~!a) + (~!b)*sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~x)) &&
    igt((~p), 0) &&
    ext_isinteger(1/(~n)) ?
1⨸((~n)*(~f))* int_and_subst((~x)^(1⨸(~n) - 1)*((~a) + (~b)*sin((~c) + (~d)*(~x)))^(~p),  (~x), (~x), ((~e) + (~f)*(~x))^(~n), "4_1_12_11") : nothing)

("4_1_12_12",
@rule ∫(((~!a) + (~!b)*cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~x)) &&
    igt((~p), 0) &&
    ext_isinteger(1/(~n)) ?
1⨸((~n)*(~f))* int_and_subst((~x)^(1⨸(~n) - 1)*((~a) + (~b)*cos((~c) + (~d)*(~x)))^(~p),  (~x), (~x), ((~e) + (~f)*(~x))^(~n), "4_1_12_12") : nothing)

# ("4_1_12_13",
# @rule ∫(((~!a) + (~!b)*sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~x)) &&
#     igt((~p), 0) &&
#     isfraction((~n)) ?
# Module[{(~k) = ext_den((~n))}, (~k)⨸(~f)* int_and_subst((~x)^((~k) - 1)*((~a) + (~b)*sin((~c) + (~d)*(~x)^((~k)*(~n))))^(~p),  (~x), (~x), ((~e) + (~f)*(~x))^(1⨸(~k)), "4_1_12_13")] : nothing)
# 
# ("4_1_12_14",
# @rule ∫(((~!a) + (~!b)*cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~x)) &&
#     igt((~p), 0) &&
#     isfraction((~n)) ?
# Module[{(~k) = ext_den((~n))}, (~k)⨸(~f)* int_and_subst((~x)^((~k) - 1)*((~a) + (~b)*cos((~c) + (~d)*(~x)^((~k)*(~n))))^(~p),  (~x), (~x), ((~e) + (~f)*(~x))^(1⨸(~k)), "4_1_12_14")] : nothing)

("4_1_12_15",
@rule ∫(sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~f), (~n), (~x)) ?
(~I)⨸2*∫(ℯ^(-(~c)*(~I) - (~d)*(~I)*((~e) + (~f)*(~x))^(~n)), (~x)) - (~I)⨸2*∫(ℯ^((~c)*(~I) + (~d)*(~I)*((~e) + (~f)*(~x))^(~n)), (~x)) : nothing)

("4_1_12_16",
@rule ∫(cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~f), (~n), (~x)) ?
1⨸2*∫(ℯ^(-(~c)*(~I) - (~d)*(~I)*((~e) + (~f)*(~x))^(~n)), (~x)) + 1⨸2*∫(ℯ^((~c)*(~I) + (~d)*(~I)*((~e) + (~f)*(~x))^(~n)), (~x)) : nothing)

# ("4_1_12_17",
# @rule ∫(((~!a) + (~!b)*sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~x)) &&
#     igt((~p), 1) ?
# ∫(ExpandTrigReduce[((~a) + (~b)*sin((~c) + (~d)*((~e) + (~f)*(~x))^(~n)))^(~p), (~x)], (~x)) : nothing)
# 
# ("4_1_12_18",
# @rule ∫(((~!a) + (~!b)*cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~x)) &&
#     igt((~p), 1) ?
# ∫(ExpandTrigReduce[((~a) + (~b)*cos((~c) + (~d)*((~e) + (~f)*(~x))^(~n)))^(~p), (~x)], (~x)) : nothing)

# ("4_1_12_19",
# @rule ∫(((~!a) + (~!b)*sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~p), (~x)) ?
# Unintegrable[((~a) + (~b)*sin((~c) + (~d)*((~e) + (~f)*(~x))^(~n)))^(~p), (~x)] : nothing)

# ("4_1_12_20",
# @rule ∫(((~!a) + (~!b)*cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^(~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~n), (~p), (~x)) ?
# Unintegrable[((~a) + (~b)*cos((~c) + (~d)*((~e) + (~f)*(~x))^(~n)))^(~p), (~x)] : nothing)

("4_1_12_21",
@rule ∫(((~!a) + (~!b)*sin((~!c) + (~!d)*(~u)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~n), (~p), (~x)) &&
    linear((~u), (~x)) &&
    !(linear_without_simplify((~u), (~x))) ?
∫(((~a) + (~b)*sin((~c) + (~d)*expand_to_sum((~u), (~x))^(~n)))^(~p), (~x)) : nothing)

("4_1_12_22",
@rule ∫(((~!a) + (~!b)*cos((~!c) + (~!d)*(~u)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~n), (~p), (~x)) &&
    linear((~u), (~x)) &&
    !(linear_without_simplify((~u), (~x))) ?
∫(((~a) + (~b)*cos((~c) + (~d)*expand_to_sum((~u), (~x))^(~n)))^(~p), (~x)) : nothing)

("4_1_12_23",
@rule ∫(((~!a) + (~!b)*sin((~u)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~p), (~x)) &&
    binomial((~u), (~x)) &&
    !(binomial_without_simplify((~u), (~x))) ?
∫(((~a) + (~b)*sin(expand_to_sum((~u), (~x))))^(~p), (~x)) : nothing)

("4_1_12_24",
@rule ∫(((~!a) + (~!b)*cos((~u)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~p), (~x)) &&
    binomial((~u), (~x)) &&
    !(binomial_without_simplify((~u), (~x))) ?
∫(((~a) + (~b)*cos(expand_to_sum((~u), (~x))))^(~p), (~x)) : nothing)

("4_1_12_25",
@rule ∫(sin((~!d)*(~x)^(~n))/(~x),(~x)) =>
    !contains_var((~d), (~n), (~x)) ?
SymbolicUtils.sinint((~d)*(~x)^(~n))⨸(~n) : nothing)

("4_1_12_26",
@rule ∫(cos((~!d)*(~x)^(~n))/(~x),(~x)) =>
    !contains_var((~d), (~n), (~x)) ?
SymbolicUtils.cosint((~d)*(~x)^(~n))⨸(~n) : nothing)

("4_1_12_27",
@rule ∫(sin((~c) + (~!d)*(~x)^(~n))/(~x),(~x)) =>
    !contains_var((~c), (~d), (~n), (~x)) ?
sin((~c))*∫(cos((~d)*(~x)^(~n))⨸(~x), (~x)) + cos((~c))*∫(sin((~d)*(~x)^(~n))⨸(~x), (~x)) : nothing)

("4_1_12_28",
@rule ∫(cos((~c) + (~!d)*(~x)^(~n))/(~x),(~x)) =>
    !contains_var((~c), (~d), (~n), (~x)) ?
cos((~c))*∫(cos((~d)*(~x)^(~n))⨸(~x), (~x)) - sin((~c))*∫(sin((~d)*(~x)^(~n))⨸(~x), (~x)) : nothing)

("4_1_12_29",
@rule ∫((~x)^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~p), (~x)) &&
    ext_isinteger( simplify(((~m) + 1)/(~n))) &&
    (
        eq((~p), 1) ||
        eq((~m), (~n) - 1) ||
        ext_isinteger((~p)) &&
        gt(simplify(((~m) + 1)/(~n)), 0)
    ) ?
1⨸(~n)*int_and_subst((~x)^(simplify(((~m) + 1)⨸(~n)) - 1)*((~a) + (~b)*sin((~c) + (~d)*(~x)))^(~p),  (~x), (~x), (~x)^(~n), "4_1_12_29") : nothing)

("4_1_12_30",
@rule ∫((~x)^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~p), (~x)) &&
    ext_isinteger( simplify(((~m) + 1)/(~n))) &&
    (
        eq((~p), 1) ||
        eq((~m), (~n) - 1) ||
        ext_isinteger((~p)) &&
        gt(simplify(((~m) + 1)/(~n)), 0)
    ) ?
1⨸(~n)*int_and_subst((~x)^(simplify(((~m) + 1)⨸(~n)) - 1)*((~a) + (~b)*cos((~c) + (~d)*(~x)))^(~p),  (~x), (~x), (~x)^(~n), "4_1_12_30") : nothing)

("4_1_12_31",
@rule ∫(((~e)*(~x))^(~m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) &&
    ext_isinteger(simplify(((~m) + 1)/(~n))) ?
(~e)^intpart((~m))*((~e)*(~x))^fracpart((~m))⨸(~x)^fracpart((~m))* ∫((~x)^(~m)*((~a) + (~b)*sin((~c) + (~d)*(~x)^(~n)))^(~p), (~x)) : nothing)

("4_1_12_32",
@rule ∫(((~e)*(~x))^(~m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) &&
    ext_isinteger(simplify(((~m) + 1)/(~n))) ?
(~e)^intpart((~m))*((~e)*(~x))^fracpart((~m))⨸(~x)^fracpart((~m))* ∫((~x)^(~m)*((~a) + (~b)*cos((~c) + (~d)*(~x)^(~n)))^(~p), (~x)) : nothing)

("4_1_12_33",
@rule ∫((~x)^(~!m)*sin((~!a) + (~!b)*(~x)^(~n)),(~x)) =>
    !contains_var((~a), (~b), (~m), (~n), (~x)) &&
    eq((~m), (~n)/2 - 1) ?
2⨸(~n)*int_and_subst(sin((~a) + (~b)*(~x)^2),  (~x), (~x), (~x)^((~n)⨸2), "4_1_12_33") : nothing)

("4_1_12_34",
@rule ∫((~x)^(~!m)*cos((~!a) + (~!b)*(~x)^(~n)),(~x)) =>
    !contains_var((~a), (~b), (~m), (~n), (~x)) &&
    eq((~m), (~n)/2 - 1) ?
2⨸(~n)*int_and_subst(cos((~a) + (~b)*(~x)^2),  (~x), (~x), (~x)^((~n)⨸2), "4_1_12_34") : nothing)

("4_1_12_35",
@rule ∫(((~!e)*(~x))^(~!m)*sin((~!c) + (~!d)*(~x)^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~x)) &&
    igt((~n), 0) &&
    lt((~n), (~m) + 1) ?
-(~e)^((~n) - 1)*((~e)*(~x))^((~m) - (~n) + 1)*cos((~c) + (~d)*(~x)^(~n))⨸((~d)*(~n)) + (~e)^(~n)*((~m) - (~n) + 1)⨸((~d)*(~n))*∫(((~e)*(~x))^((~m) - (~n))*cos((~c) + (~d)*(~x)^(~n)), (~x)) : nothing)

("4_1_12_36",
@rule ∫(((~!e)*(~x))^(~!m)*cos((~!c) + (~!d)*(~x)^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~x)) &&
    igt((~n), 0) &&
    lt((~n), (~m) + 1) ?
(~e)^((~n) - 1)*((~e)*(~x))^((~m) - (~n) + 1)*sin((~c) + (~d)*(~x)^(~n))⨸((~d)*(~n)) - (~e)^(~n)*((~m) - (~n) + 1)⨸((~d)*(~n))*∫(((~e)*(~x))^((~m) - (~n))*sin((~c) + (~d)*(~x)^(~n)), (~x)) : nothing)

("4_1_12_37",
@rule ∫(((~!e)*(~x))^(~m)*sin((~!c) + (~!d)*(~x)^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~x)) &&
    igt((~n), 0) &&
    lt((~m), -1) ?
((~e)*(~x))^((~m) + 1)*sin((~c) + (~d)*(~x)^(~n))⨸((~e)*((~m) + 1)) - (~d)*(~n)⨸((~e)^(~n)*((~m) + 1))*∫(((~e)*(~x))^((~m) + (~n))*cos((~c) + (~d)*(~x)^(~n)), (~x)) : nothing)

("4_1_12_38",
@rule ∫(((~!e)*(~x))^(~m)*cos((~!c) + (~!d)*(~x)^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~x)) &&
    igt((~n), 0) &&
    lt((~m), -1) ?
((~e)*(~x))^((~m) + 1)*cos((~c) + (~d)*(~x)^(~n))⨸((~e)*((~m) + 1)) + (~d)*(~n)⨸((~e)^(~n)*((~m) + 1))*∫(((~e)*(~x))^((~m) + (~n))*sin((~c) + (~d)*(~x)^(~n)), (~x)) : nothing)

("4_1_12_39",
@rule ∫(((~!e)*(~x))^(~!m)*sin((~!c) + (~!d)*(~x)^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~m), (~x)) &&
    igt((~n), 0) ?
(~I)⨸2*∫(((~e)*(~x))^(~m)*ℯ^(-(~c)*(~I) - (~d)*(~I)*(~x)^(~n)), (~x)) - (~I)⨸2*∫(((~e)*(~x))^(~m)*ℯ^((~c)*(~I) + (~d)*(~I)*(~x)^(~n)), (~x)) : nothing)

("4_1_12_40",
@rule ∫(((~!e)*(~x))^(~!m)*cos((~!c) + (~!d)*(~x)^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~m), (~x)) &&
    igt((~n), 0) ?
1⨸2*∫(((~e)*(~x))^(~m)*ℯ^(-(~c)*(~I) - (~d)*(~I)*(~x)^(~n)), (~x)) + 1⨸2*∫(((~e)*(~x))^(~m)*ℯ^((~c)*(~I) + (~d)*(~I)*(~x)^(~n)), (~x)) : nothing)

("4_1_12_41",
@rule ∫((~x)^(~!m)*sin((~!a) + (~!b)*(~x)^(~n)/2)^2,(~x)) =>
    !contains_var((~a), (~b), (~m), (~n), (~x)) ?
1⨸2*∫((~x)^(~m), (~x)) - 1⨸2*∫((~x)^(~m)*cos(2*(~a) + (~b)*(~x)^(~n)), (~x)) : nothing)

("4_1_12_42",
@rule ∫((~x)^(~!m)*cos((~!a) + (~!b)*(~x)^(~n)/2)^2,(~x)) =>
    !contains_var((~a), (~b), (~m), (~n), (~x)) ?
1⨸2*∫((~x)^(~m), (~x)) + 1⨸2*∫((~x)^(~m)*cos(2*(~a) + (~b)*(~x)^(~n)), (~x)) : nothing)

("4_1_12_43",
@rule ∫((~x)^(~!m)*sin((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~x)) &&
    igt((~p), 1) &&
    eq((~m) + (~n), 0) &&
    !eq((~n), 1) &&
    ext_isinteger((~n)) ?
(~x)^((~m) + 1)*sin((~a) + (~b)*(~x)^(~n))^(~p)⨸((~m) + 1) - (~b)*(~n)*(~p)⨸((~m) + 1)*∫(sin((~a) + (~b)*(~x)^(~n))^((~p) - 1)*cos((~a) + (~b)*(~x)^(~n)), (~x)) : nothing)

("4_1_12_44",
@rule ∫((~x)^(~!m)*cos((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~x)) &&
    igt((~p), 1) &&
    eq((~m) + (~n), 0) &&
    !eq((~n), 1) &&
    ext_isinteger((~n)) ?
(~x)^((~m) + 1)*cos((~a) + (~b)*(~x)^(~n))^(~p)⨸((~m) + 1) + (~b)*(~n)*(~p)⨸((~m) + 1)*∫(cos((~a) + (~b)*(~x)^(~n))^((~p) - 1)*sin((~a) + (~b)*(~x)^(~n)), (~x)) : nothing)

("4_1_12_45",
@rule ∫((~x)^(~!m)*sin((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~m), (~n), (~x)) &&
    eq((~m) - 2*(~n) + 1, 0) &&
    gt((~p), 1) ?
(~n)*sin((~a) + (~b)*(~x)^(~n))^(~p)⨸((~b)^2*(~n)^2*(~p)^2) - (~x)^(~n)*cos((~a) + (~b)*(~x)^(~n))*sin((~a) + (~b)*(~x)^(~n))^((~p) - 1)⨸((~b)*(~n)*(~p)) + ((~p) - 1)⨸(~p)*∫((~x)^(~m)*sin((~a) + (~b)*(~x)^(~n))^((~p) - 2), (~x)) : nothing)

("4_1_12_46",
@rule ∫((~x)^(~!m)*cos((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~m), (~n), (~x)) &&
    eq((~m) - 2*(~n) + 1, 0) &&
    gt((~p), 1) ?
(~n)*cos((~a) + (~b)*(~x)^(~n))^(~p)⨸((~b)^2*(~n)^2*(~p)^2) + (~x)^(~n)*sin((~a) + (~b)*(~x)^(~n))*cos((~a) + (~b)*(~x)^(~n))^((~p) - 1)⨸((~b)*(~n)*(~p)) + ((~p) - 1)⨸(~p)*∫((~x)^(~m)*cos((~a) + (~b)*(~x)^(~n))^((~p) - 2), (~x)) : nothing)

("4_1_12_47",
@rule ∫((~x)^(~!m)*sin((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~x)) &&
    gt((~p), 1) &&
    igt((~n), 0) &&
    igt((~m), 2*(~n) - 1) ?
((~m) - (~n) + 1)*(~x)^((~m) - 2*(~n) + 1)*sin((~a) + (~b)*(~x)^(~n))^(~p)⨸((~b)^2*(~n)^2*(~p)^2) - (~x)^((~m) - (~n) + 1)*cos((~a) + (~b)*(~x)^(~n))*sin((~a) + (~b)*(~x)^(~n))^((~p) - 1)⨸((~b)*(~n)*(~p)) + ((~p) - 1)⨸(~p)*∫((~x)^(~m)*sin((~a) + (~b)*(~x)^(~n))^((~p) - 2), (~x)) - ((~m) - (~n) + 1)*((~m) - 2*(~n) + 1)⨸((~b)^2*(~n)^2*(~p)^2)* ∫((~x)^((~m) - 2*(~n))*sin((~a) + (~b)*(~x)^(~n))^(~p), (~x)) : nothing)

("4_1_12_48",
@rule ∫((~x)^(~!m)*cos((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~x)) &&
    gt((~p), 1) &&
    igt((~n), 0) &&
    igt((~m), 2*(~n) - 1) ?
((~m) - (~n) + 1)*(~x)^((~m) - 2*(~n) + 1)*cos((~a) + (~b)*(~x)^(~n))^(~p)⨸((~b)^2*(~n)^2*(~p)^2) + (~x)^((~m) - (~n) + 1)*sin((~a) + (~b)*(~x)^(~n))*cos((~a) + (~b)*(~x)^(~n))^((~p) - 1)⨸((~b)*(~n)*(~p)) + ((~p) - 1)⨸(~p)*∫((~x)^(~m)*cos((~a) + (~b)*(~x)^(~n))^((~p) - 2), (~x)) - ((~m) - (~n) + 1)*((~m) - 2*(~n) + 1)⨸((~b)^2*(~n)^2*(~p)^2)* ∫((~x)^((~m) - 2*(~n))*cos((~a) + (~b)*(~x)^(~n))^(~p), (~x)) : nothing)

("4_1_12_49",
@rule ∫((~x)^(~!m)*sin((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~x)) &&
    gt((~p), 1) &&
    igt((~n), 0) &&
    ilt((~m), -2*(~n) + 1) &&
    !eq((~m) + (~n) + 1, 0) ?
(~x)^((~m) + 1)*sin((~a) + (~b)*(~x)^(~n))^(~p)⨸((~m) + 1) - (~b)*(~n)*(~p)*(~x)^((~m) + (~n) + 1)*cos((~a) + (~b)*(~x)^(~n))* sin((~a) + (~b)*(~x)^(~n))^((~p) - 1)⨸(((~m) + 1)*((~m) + (~n) + 1)) - (~b)^2*(~n)^2*(~p)^2⨸(((~m) + 1)*((~m) + (~n) + 1))* ∫((~x)^((~m) + 2*(~n))*sin((~a) + (~b)*(~x)^(~n))^(~p), (~x)) + (~b)^2*(~n)^2*(~p)*((~p) - 1)⨸(((~m) + 1)*((~m) + (~n) + 1))* ∫((~x)^((~m) + 2*(~n))*sin((~a) + (~b)*(~x)^(~n))^((~p) - 2), (~x)) : nothing)

("4_1_12_50",
@rule ∫((~x)^(~!m)*cos((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~x)) &&
    gt((~p), 1) &&
    igt((~n), 0) &&
    ilt((~m), -2*(~n) + 1) &&
    !eq((~m) + (~n) + 1, 0) ?
(~x)^((~m) + 1)*cos((~a) + (~b)*(~x)^(~n))^(~p)⨸((~m) + 1) + (~b)*(~n)*(~p)*(~x)^((~m) + (~n) + 1)*sin((~a) + (~b)*(~x)^(~n))* cos((~a) + (~b)*(~x)^(~n))^((~p) - 1)⨸(((~m) + 1)*((~m) + (~n) + 1)) - (~b)^2*(~n)^2*(~p)^2⨸(((~m) + 1)*((~m) + (~n) + 1))* ∫((~x)^((~m) + 2*(~n))*cos((~a) + (~b)*(~x)^(~n))^(~p), (~x)) + (~b)^2*(~n)^2*(~p)*((~p) - 1)⨸(((~m) + 1)*((~m) + (~n) + 1))* ∫((~x)^((~m) + 2*(~n))*cos((~a) + (~b)*(~x)^(~n))^((~p) - 2), (~x)) : nothing)

("4_1_12_51",
@rule ∫(((~!e)*(~x))^(~m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    ext_isinteger((~p)) &&
    igt((~n), 0) &&
    isfraction((~m)) ?
ext_den((~m))⨸(~e)* int_and_subst((~x)^(ext_den((~m))*((~m) + 1) - 1)*((~a) + (~b)*sin((~c) + (~d)*(~x)^(ext_den((~m))*(~n))⨸(~e)^(~n)))^(~p),  (~x), (~x), ((~e)*(~x))^(1⨸ext_den((~m))), "4_1_12_51") : nothing)

("4_1_12_52",
@rule ∫(((~!e)*(~x))^(~m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    ext_isinteger((~p)) &&
    igt((~n), 0) &&
    isfraction((~m)) ?
ext_den((~m))⨸(~e)* int_and_subst((~x)^(ext_den((~m))*((~m) + 1) - 1)*((~a) + (~b)*cos((~c) + (~d)*(~x)^(ext_den((~m))*(~n))⨸(~e)^(~n)))^(~p),  (~x), (~x), ((~e)*(~x))^(1⨸ext_den((~m))), "4_1_12_52") : nothing)

# ("4_1_12_53",
# @rule ∫(((~!e)*(~x))^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~x)) &&
#     igt((~p), 1) &&
#     igt((~n), 0) ?
# ∫(ExpandTrigReduce[((~e)*(~x))^(~m), ((~a) + (~b)*sin((~c) + (~d)*(~x)^(~n)))^(~p), (~x)], (~x)) : nothing)
# 
# ("4_1_12_54",
# @rule ∫(((~!e)*(~x))^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~x)) &&
#     igt((~p), 1) &&
#     igt((~n), 0) ?
# ∫(ExpandTrigReduce[((~e)*(~x))^(~m), ((~a) + (~b)*cos((~c) + (~d)*(~x)^(~n)))^(~p), (~x)], (~x)) : nothing)

("4_1_12_55",
@rule ∫((~x)^(~!m)*sin((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~m), (~n), (~x)) &&
    eq((~m) - 2*(~n) + 1, 0) &&
    lt((~p), -1) &&
    !eq((~p), -2) ?
(~x)^(~n)*cos((~a) + (~b)*(~x)^(~n))*sin((~a) + (~b)*(~x)^(~n))^((~p) + 1)⨸((~b)*(~n)*((~p) + 1)) - (~n)*sin((~a) + (~b)*(~x)^(~n))^((~p) + 2)⨸((~b)^2*(~n)^2*((~p) + 1)*((~p) + 2)) + ((~p) + 2)⨸((~p) + 1)*∫((~x)^(~m)*sin((~a) + (~b)*(~x)^(~n))^((~p) + 2), (~x)) : nothing)

("4_1_12_56",
@rule ∫((~x)^(~!m)*cos((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~m), (~n), (~x)) &&
    eq((~m) - 2*(~n) + 1, 0) &&
    lt((~p), -1) &&
    !eq((~p), -2) ?
-(~x)^(~n)*sin((~a) + (~b)*(~x)^(~n))*cos((~a) + (~b)*(~x)^(~n))^((~p) + 1)⨸((~b)*(~n)*((~p) + 1)) - (~n)*cos((~a) + (~b)*(~x)^(~n))^((~p) + 2)⨸((~b)^2*(~n)^2*((~p) + 1)*((~p) + 2)) + ((~p) + 2)⨸((~p) + 1)*∫((~x)^(~m)*cos((~a) + (~b)*(~x)^(~n))^((~p) + 2), (~x)) : nothing)

("4_1_12_57",
@rule ∫((~x)^(~!m)*sin((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~x)) &&
    lt((~p), -1) &&
    !eq((~p), -2) &&
    igt((~n), 0) &&
    igt((~m), 2*(~n) - 1) ?
(~x)^((~m) - (~n) + 1)*cos((~a) + (~b)*(~x)^(~n))* sin((~a) + (~b)*(~x)^(~n))^((~p) + 1)⨸((~b)*(~n)*((~p) + 1)) - ((~m) - (~n) + 1)*(~x)^((~m) - 2*(~n) + 1)* sin((~a) + (~b)*(~x)^(~n))^((~p) + 2)⨸((~b)^2*(~n)^2*((~p) + 1)*((~p) + 2)) + ((~p) + 2)⨸((~p) + 1)*∫((~x)^(~m)*sin((~a) + (~b)*(~x)^(~n))^((~p) + 2), (~x)) + ((~m) - (~n) + 1)*((~m) - 2*(~n) + 1)⨸((~b)^2*(~n)^2*((~p) + 1)*((~p) + 2))* ∫((~x)^((~m) - 2*(~n))*sin((~a) + (~b)*(~x)^(~n))^((~p) + 2), (~x)) : nothing)

("4_1_12_58",
@rule ∫((~x)^(~!m)*cos((~!a) + (~!b)*(~x)^(~n))^(~p),(~x)) =>
    !contains_var((~a), (~b), (~x)) &&
    lt((~p), -1) &&
    !eq((~p), -2) &&
    igt((~n), 0) &&
    igt((~m), 2*(~n) - 1) ?
-(~x)^((~m) - (~n) + 1)*sin((~a) + (~b)*(~x)^(~n))*cos((~a) + (~b)*(~x)^(~n))^((~p) + 1)⨸((~b)*(~n)*((~p) + 1)) - ((~m) - (~n) + 1)*(~x)^((~m) - 2*(~n) + 1)* cos((~a) + (~b)*(~x)^(~n))^((~p) + 2)⨸((~b)^2*(~n)^2*((~p) + 1)*((~p) + 2)) + ((~p) + 2)⨸((~p) + 1)*∫((~x)^(~m)*cos((~a) + (~b)*(~x)^(~n))^((~p) + 2), (~x)) + ((~m) - (~n) + 1)*((~m) - 2*(~n) + 1)⨸((~b)^2*(~n)^2*((~p) + 1)*((~p) + 2))* ∫((~x)^((~m) - 2*(~n))*cos((~a) + (~b)*(~x)^(~n))^((~p) + 2), (~x)) : nothing)

("4_1_12_59",
@rule ∫((~x)^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    igt((~p), 0) &&
    ilt((~n), 0) &&
    ext_isinteger((~m)) &&
    eq((~n), -2) ?
-int_and_subst(((~a) + (~b)*sin((~c) + (~d)*(~x)^(-(~n))))^(~p)⨸(~x)^((~m) + 2),  (~x), (~x), 1⨸(~x), "4_1_12_59") : nothing)

("4_1_12_60",
@rule ∫((~x)^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    igt((~p), 0) &&
    ilt((~n), 0) &&
    ext_isinteger((~m)) &&
    eq((~n), -2) ?
-int_and_subst(((~a) + (~b)*cos((~c) + (~d)*(~x)^(-(~n))))^(~p)⨸(~x)^((~m) + 2),  (~x), (~x), 1⨸(~x), "4_1_12_60") : nothing)

("4_1_12_61",
@rule ∫(((~!e)*(~x))^(~m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    igt((~p), 0) &&
    ilt((~n), 0) &&
    isfraction((~m)) ?
-ext_den((~m))⨸(~e)* int_and_subst(((~a) + (~b)*sin((~c) + (~d)⨸((~e)^(~n)*(~x)^(ext_den((~m))*(~n)))))^(~p)⨸(~x)^(ext_den((~m))*((~m) + 1) + 1),  (~x), (~x), 1⨸((~e)*(~x))^(1⨸ext_den((~m))), "4_1_12_61") : nothing)

("4_1_12_62",
@rule ∫(((~!e)*(~x))^(~m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~x)) &&
    igt((~p), 0) &&
    ilt((~n), 0) &&
    isfraction((~m)) ?
-ext_den((~m))⨸(~e)* int_and_subst(((~a) + (~b)*cos((~c) + (~d)⨸((~e)^(~n)*(~x)^(ext_den((~m))*(~n)))))^(~p)⨸(~x)^(ext_den((~m))*((~m) + 1) + 1),  (~x), (~x), 1⨸((~e)*(~x))^(1⨸ext_den((~m))), "4_1_12_62") : nothing)

("4_1_12_63",
@rule ∫(((~!e)*(~x))^(~m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~x)) &&
    igt((~p), 0) &&
    ilt((~n), 0) &&
    !(isrational((~m))) ?
-((~e)*(~x))^(~m)*((~x)^(-1))^(~m)* int_and_subst(((~a) + (~b)*sin((~c) + (~d)*(~x)^(-(~n))))^(~p)⨸(~x)^((~m) + 2),  (~x), (~x), 1⨸(~x), "4_1_12_63") : nothing)

("4_1_12_64",
@rule ∫(((~!e)*(~x))^(~m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~x)) &&
    igt((~p), 0) &&
    ilt((~n), 0) &&
    !(isrational((~m))) ?
-((~e)*(~x))^(~m)*((~x)^(-1))^(~m)* int_and_subst(((~a) + (~b)*cos((~c) + (~d)*(~x)^(-(~n))))^(~p)⨸(~x)^((~m) + 2),  (~x), (~x), 1⨸(~x), "4_1_12_64") : nothing)

# ("4_1_12_65",
# @rule ∫((~x)^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~m), (~x)) &&
#     ext_isinteger((~p)) &&
#     isfraction((~n)) ?
# Module[{(~k) = ext_den((~n))}, (~k)*int_and_subst((~x)^((~k)*((~m) + 1) - 1)*((~a) + (~b)*sin((~c) + (~d)*(~x)^((~k)*(~n))))^(~p),  (~x), (~x), (~x)^(1⨸(~k)), "4_1_12_65")] : nothing)
# 
# ("4_1_12_66",
# @rule ∫((~x)^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~m), (~x)) &&
#     ext_isinteger((~p)) &&
#     isfraction((~n)) ?
# Module[{(~k) = ext_den((~n))}, (~k)*int_and_subst((~x)^((~k)*((~m) + 1) - 1)*((~a) + (~b)*cos((~c) + (~d)*(~x)^((~k)*(~n))))^(~p),  (~x), (~x), (~x)^(1⨸(~k)), "4_1_12_66")] : nothing)

("4_1_12_67",
@rule ∫(((~e)*(~x))^(~m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~x)) &&
    ext_isinteger((~p)) &&
    isfraction((~n)) ?
(~e)^intpart((~m))*((~e)*(~x))^fracpart((~m))⨸(~x)^fracpart((~m))* ∫((~x)^(~m)*((~a) + (~b)*sin((~c) + (~d)*(~x)^(~n)))^(~p), (~x)) : nothing)

("4_1_12_68",
@rule ∫(((~e)*(~x))^(~m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~x)) &&
    ext_isinteger((~p)) &&
    isfraction((~n)) ?
(~e)^intpart((~m))*((~e)*(~x))^fracpart((~m))⨸(~x)^fracpart((~m))* ∫((~x)^(~m)*((~a) + (~b)*cos((~c) + (~d)*(~x)^(~n)))^(~p), (~x)) : nothing)

("4_1_12_69",
@rule ∫((~x)^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~x)) &&
    ext_isinteger((~p)) &&
    !eq((~m), -1) &&
    igt(simplify((~n)/((~m) + 1)), 0) &&
    !(ext_isinteger((~n))) ?
1⨸((~m) + 1)* int_and_subst(((~a) + (~b)*sin((~c) + (~d)*(~x)^simplify((~n)⨸((~m) + 1))))^(~p),  (~x), (~x), (~x)^((~m) + 1), "4_1_12_69") : nothing)

("4_1_12_70",
@rule ∫((~x)^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~x)) &&
    ext_isinteger((~p)) &&
    !eq((~m), -1) &&
    igt(simplify((~n)/((~m) + 1)), 0) &&
    !(ext_isinteger((~n))) ?
1⨸((~m) + 1)* int_and_subst(((~a) + (~b)*cos((~c) + (~d)*(~x)^simplify((~n)⨸((~m) + 1))))^(~p),  (~x), (~x), (~x)^((~m) + 1), "4_1_12_70") : nothing)

("4_1_12_71",
@rule ∫(((~e)*(~x))^(~m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
    ext_isinteger((~p)) &&
    !eq((~m), -1) &&
    igt(simplify((~n)/((~m) + 1)), 0) &&
    !(ext_isinteger((~n))) ?
(~e)^intpart((~m))*((~e)*(~x))^fracpart((~m))⨸(~x)^fracpart((~m))* ∫((~x)^(~m)*((~a) + (~b)*sin((~c) + (~d)*(~x)^(~n)))^(~p), (~x)) : nothing)

("4_1_12_72",
@rule ∫(((~e)*(~x))^(~m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
    ext_isinteger((~p)) &&
    !eq((~m), -1) &&
    igt(simplify((~n)/((~m) + 1)), 0) &&
    !(ext_isinteger((~n))) ?
(~e)^intpart((~m))*((~e)*(~x))^fracpart((~m))⨸(~x)^fracpart((~m))* ∫((~x)^(~m)*((~a) + (~b)*cos((~c) + (~d)*(~x)^(~n)))^(~p), (~x)) : nothing)

("4_1_12_73",
@rule ∫(((~!e)*(~x))^(~!m)*sin((~!c) + (~!d)*(~x)^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~m), (~n), (~x)) ?
(~I)⨸2*∫(((~e)*(~x))^(~m)*ℯ^(-(~c)*(~I) - (~d)*(~I)*(~x)^(~n)), (~x)) - (~I)⨸2*∫(((~e)*(~x))^(~m)*ℯ^((~c)*(~I) + (~d)*(~I)*(~x)^(~n)), (~x)) : nothing)

("4_1_12_74",
@rule ∫(((~!e)*(~x))^(~!m)*cos((~!c) + (~!d)*(~x)^(~n)),(~x)) =>
    !contains_var((~c), (~d), (~e), (~m), (~n), (~x)) ?
1⨸2*∫(((~e)*(~x))^(~m)*ℯ^(-(~c)*(~I) - (~d)*(~I)*(~x)^(~n)), (~x)) + 1⨸2*∫(((~e)*(~x))^(~m)*ℯ^((~c)*(~I) + (~d)*(~I)*(~x)^(~n)), (~x)) : nothing)

# ("4_1_12_75",
# @rule ∫(((~!e)*(~x))^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
#     igt((~p), 0) ?
# ∫(ExpandTrigReduce[((~e)*(~x))^(~m), ((~a) + (~b)*sin((~c) + (~d)*(~x)^(~n)))^(~p), (~x)], (~x)) : nothing)
# 
# ("4_1_12_76",
# @rule ∫(((~!e)*(~x))^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~x)) &&
#     igt((~p), 0) ?
# ∫(ExpandTrigReduce[((~e)*(~x))^(~m), ((~a) + (~b)*cos((~c) + (~d)*(~x)^(~n)))^(~p), (~x)], (~x)) : nothing)

# ("4_1_12_77",
# @rule ∫(((~!e)*(~x))^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) ?
# Unintegrable[((~e)*(~x))^(~m)*((~a) + (~b)*sin((~c) + (~d)*(~x)^(~n)))^(~p), (~x)] : nothing)

# ("4_1_12_78",
# @rule ∫(((~!e)*(~x))^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~x)^(~n)))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~m), (~n), (~p), (~x)) ?
# Unintegrable[((~e)*(~x))^(~m)*((~a) + (~b)*cos((~c) + (~d)*(~x)^(~n)))^(~p), (~x)] : nothing)

("4_1_12_79",
@rule ∫(((~e)*(~x))^(~!m)*((~!a) + (~!b)*sin((~u)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~e), (~m), (~p), (~x)) &&
    binomial((~u), (~x)) &&
    !(binomial_without_simplify((~u), (~x))) ?
∫(((~e)*(~x))^(~m)*((~a) + (~b)*sin(expand_to_sum((~u), (~x))))^(~p), (~x)) : nothing)

("4_1_12_80",
@rule ∫(((~e)*(~x))^(~!m)*((~!a) + (~!b)*cos((~u)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~e), (~m), (~p), (~x)) &&
    binomial((~u), (~x)) &&
    !(binomial_without_simplify((~u), (~x))) ?
∫(((~e)*(~x))^(~m)*((~a) + (~b)*cos(expand_to_sum((~u), (~x))))^(~p), (~x)) : nothing)

("4_1_12_81",
@rule ∫(((~!g) + (~!h)*(~x))^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~m), (~x)) &&
    igt((~p), 0) &&
    ext_isinteger(1/(~n)) ?
1⨸((~n)*(~f))* int_and_subst( ext_expand(((~a) + (~b)*sin((~c) + (~d)*(~x)))^(~p),  (~x)^(1⨸(~n) - 1)*((~g) - (~e)*(~h)⨸(~f) + (~h)*(~x)^(1⨸(~n))⨸(~f))^(~m), (~x)), (~x), (~x), ((~e) + (~f)*(~x))^(~n), "4_1_12_81") : nothing)

("4_1_12_82",
@rule ∫(((~!g) + (~!h)*(~x))^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~m), (~x)) &&
    igt((~p), 0) &&
    ext_isinteger(1/(~n)) ?
1⨸((~n)*(~f))* int_and_subst( ext_expand(((~a) + (~b)*cos((~c) + (~d)*(~x)))^(~p),  (~x)^(1⨸(~n) - 1)*((~g) - (~e)*(~h)⨸(~f) + (~h)*(~x)^(1⨸(~n))⨸(~f))^(~m), (~x)), (~x), (~x), ((~e) + (~f)*(~x))^(~n), "4_1_12_82") : nothing)

#(* Int[(g_.+h_.*x_)^m_.*(a_.+b_.*Sin[c_.+d_.*(e_.+f_.*x_)^n_])^p_.,x_ Symbol] := 1/(n*f^(m+1))*Subst[Int[ExpandIntegrand[(a+b*Sin[c+d*x])^p,x^(1/n-1) *(f*g-e*h+h*x^(1/n))^m,x],x],x,(e+f*x)^n] /; FreeQ[{a,b,c,d,e,f,g,h},x] && IGtQ[p,0] && IntegerQ[m] &&  IntegerQ[1/n] *)
#(* Int[(g_.+h_.*x_)^m_.*(a_.+b_.*Cos[c_.+d_.*(e_.+f_.*x_)^n_])^p_.,x_ Symbol] := 1/(n*f^(m+1))*Subst[Int[ExpandIntegrand[(a+b*Cos[c+d*x])^p,x^(1/n-1) *(f*g-e*h+h*x^(1/n))^m,x],x],x,(e+f*x)^n] /; FreeQ[{a,b,c,d,e,f,g,h},x] && IGtQ[p,0] && IntegerQ[m] &&  IntegerQ[1/n] *)
# ("4_1_12_83",
# @rule ∫(((~!g) + (~!h)*(~x))^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^ (~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~x)) &&
#     igt((~p), 0) &&
#     igt((~m), 0) ?
# Module[{(~k) = (~If)[FractionQ[(~n)], ext_den((~n)), 1]}, (~k)⨸(~f)^((~m) + 1)* int_and_subst( ext_expand(((~a) + (~b)*sin((~c) + (~d)*(~x)^((~k)*(~n))))^(~p),  (~x)^((~k) - 1)*((~f)*(~g) - (~e)*(~h) + (~h)*(~x)^(~k))^(~m), (~x)), (~x), (~x), ((~e) + (~f)*(~x))^(1⨸(~k)), "4_1_12_83")] : nothing)
# 
# ("4_1_12_84",
# @rule ∫(((~!g) + (~!h)*(~x))^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^ (~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~x)) &&
#     igt((~p), 0) &&
#     igt((~m), 0) ?
# Module[{(~k) = (~If)[FractionQ[(~n)], ext_den((~n)), 1]}, (~k)⨸(~f)^((~m) + 1)* int_and_subst( ext_expand(((~a) + (~b)*cos((~c) + (~d)*(~x)^((~k)*(~n))))^(~p),  (~x)^((~k) - 1)*((~f)*(~g) - (~e)*(~h) + (~h)*(~x)^(~k))^(~m), (~x)), (~x), (~x), ((~e) + (~f)*(~x))^(1⨸(~k)), "4_1_12_84")] : nothing)

("4_1_12_85",
@rule ∫(((~!g) + (~!h)*(~x))^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~m), (~x)) &&
    igt((~p), 0) &&
    eq((~f)*(~g) - (~e)*(~h), 0) ?
1⨸(~f)*int_and_subst(((~h)*(~x)⨸(~f))^(~m)*((~a) + (~b)*sin((~c) + (~d)*(~x)^(~n)))^(~p),  (~x), (~x), (~e) + (~f)*(~x), "4_1_12_85") : nothing)

("4_1_12_86",
@rule ∫(((~!g) + (~!h)*(~x))^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~m), (~x)) &&
    igt((~p), 0) &&
    eq((~f)*(~g) - (~e)*(~h), 0) ?
1⨸(~f)*int_and_subst(((~h)*(~x)⨸(~f))^(~m)*((~a) + (~b)*cos((~c) + (~d)*(~x)^(~n)))^(~p),  (~x), (~x), (~e) + (~f)*(~x), "4_1_12_86") : nothing)

# ("4_1_12_87",
# @rule ∫(((~!g) + (~!h)*(~x))^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^ (~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~m), (~n), (~p), (~x)) ?
# Unintegrable[((~g) + (~h)*(~x))^(~m)*((~a) + (~b)*sin((~c) + (~d)*((~e) + (~f)*(~x))^(~n)))^(~p), (~x)] : nothing)

# ("4_1_12_88",
# @rule ∫(((~!g) + (~!h)*(~x))^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*((~!e) + (~!f)*(~x))^(~n)))^ (~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~m), (~n), (~p), (~x)) ?
# Unintegrable[((~g) + (~h)*(~x))^(~m)*((~a) + (~b)*cos((~c) + (~d)*((~e) + (~f)*(~x))^(~n)))^(~p), (~x)] : nothing)

("4_1_12_89",
@rule ∫((~v)^(~!m)*((~!a) + (~!b)*sin((~!c) + (~!d)*(~u)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~p), (~x)) &&
    linear((~u), (~x)) &&
    linear((~v), (~x)) &&
    !(
        linear_without_simplify((~u), (~x)) &&
        linear_without_simplify((~v), (~x))
    ) ?
∫(expand_to_sum((~v), (~x))^(~m)*((~a) + (~b)*sin((~c) + (~d)*expand_to_sum((~u), (~x))^(~n)))^(~p), (~x)) : nothing)

("4_1_12_90",
@rule ∫((~v)^(~!m)*((~!a) + (~!b)*cos((~!c) + (~!d)*(~u)^(~n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~m), (~n), (~p), (~x)) &&
    linear((~u), (~x)) &&
    linear((~v), (~x)) &&
    !(
        linear_without_simplify((~u), (~x)) &&
        linear_without_simplify((~v), (~x))
    ) ?
∫(expand_to_sum((~v), (~x))^(~m)*((~a) + (~b)*cos((~c) + (~d)*expand_to_sum((~u), (~x))^(~n)))^(~p), (~x)) : nothing)

("4_1_12_91",
@rule ∫((~x)^(~!m)*sin((~!a) + (~!b)*(~x)^(~!n))^(~!p)*cos((~!a) + (~!b)*(~x)^(~!n)),(~x)) =>
    !contains_var((~a), (~b), (~m), (~n), (~p), (~x)) &&
    eq((~m), (~n) - 1) &&
    !eq((~p), -1) ?
sin((~a) + (~b)*(~x)^(~n))^((~p) + 1)⨸((~b)*(~n)*((~p) + 1)) : nothing)

("4_1_12_92",
@rule ∫((~x)^(~!m)*cos((~!a) + (~!b)*(~x)^(~!n))^(~!p)*sin((~!a) + (~!b)*(~x)^(~!n)),(~x)) =>
    !contains_var((~a), (~b), (~m), (~n), (~p), (~x)) &&
    eq((~m), (~n) - 1) &&
    !eq((~p), -1) ?
-cos((~a) + (~b)*(~x)^(~n))^((~p) + 1)⨸((~b)*(~n)*((~p) + 1)) : nothing)

("4_1_12_93",
@rule ∫((~x)^(~!m)*sin((~!a) + (~!b)*(~x)^(~!n))^(~!p)*cos((~!a) + (~!b)*(~x)^(~!n)),(~x)) =>
    !contains_var((~a), (~b), (~p), (~x)) &&
    lt(0, (~n), (~m) + 1) &&
    !eq((~p), -1) ?
(~x)^((~m) - (~n) + 1)*sin((~a) + (~b)*(~x)^(~n))^((~p) + 1)⨸((~b)*(~n)*((~p) + 1)) - ((~m) - (~n) + 1)⨸((~b)*(~n)*((~p) + 1))* ∫((~x)^((~m) - (~n))*sin((~a) + (~b)*(~x)^(~n))^((~p) + 1), (~x)) : nothing)

("4_1_12_94",
@rule ∫((~x)^(~!m)*cos((~!a) + (~!b)*(~x)^(~!n))^(~!p)*sin((~!a) + (~!b)*(~x)^(~!n)),(~x)) =>
    !contains_var((~a), (~b), (~p), (~x)) &&
    lt(0, (~n), (~m) + 1) &&
    !eq((~p), -1) ?
-(~x)^((~m) - (~n) + 1)*cos((~a) + (~b)*(~x)^(~n))^((~p) + 1)⨸((~b)*(~n)*((~p) + 1)) + ((~m) - (~n) + 1)⨸((~b)*(~n)*((~p) + 1))* ∫((~x)^((~m) - (~n))*cos((~a) + (~b)*(~x)^(~n))^((~p) + 1), (~x)) : nothing)


]
