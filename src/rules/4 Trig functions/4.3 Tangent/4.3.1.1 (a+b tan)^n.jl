file_rules = [
#(* ::Subsection::Closed:: *)
#(* 4.3.1.1 (a+b tan)^n *)
("4_3_1_1_1",
@rule ∫(((~!b)*tan((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~b), (~c), (~d), (~x)) &&
    gt((~n), 1) ?
(~b)*((~b)*tan((~c) + (~d)*(~x)))^((~n) - 1)⨸((~d)*((~n) - 1)) - (~b)^2*∫(((~b)*tan((~c) + (~d)*(~x)))^((~n) - 2), (~x)) : nothing)

("4_3_1_1_2",
@rule ∫(((~!b)*tan((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~b), (~c), (~d), (~x)) &&
    lt((~n), -1) ?
((~b)*tan((~c) + (~d)*(~x)))^((~n) + 1)⨸((~b)*(~d)*((~n) + 1)) - 1⨸(~b)^2*∫(((~b)*tan((~c) + (~d)*(~x)))^((~n) + 2), (~x)) : nothing)

("4_3_1_1_3",
@rule ∫(tan((~!c) + (~!d)*(~x)),(~x)) =>
    !contains_var((~c), (~d), (~x)) ?
-log(cos((~c) + (~d)*(~x)))⨸(~d) : nothing)

#(* Int[1/tan[c_.+d_.*x_],x_Symbol] := Log[RemoveContent[Sin[c+d*x],x]]/d /; FreeQ[{c,d},x] *)
("4_3_1_1_4",
@rule ∫(((~!b)*tan((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~b), (~c), (~d), (~n), (~x)) &&
    !(ext_isinteger((~n))) ?
(~b)⨸(~d)*int_and_subst((~x)^(~n)⨸((~b)^2 + (~x)^2),  (~x), (~x), (~b)*tan((~c) + (~d)*(~x)), "4_3_1_1_4") : nothing)

("4_3_1_1_5",
@rule ∫(((~a) + (~!b)*tan((~!c) + (~!d)*(~x)))^2,(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) ?
((~a)^2 - (~b)^2)*(~x) + (~b)^2*tan((~c) + (~d)*(~x))⨸(~d) + 2*(~a)*(~b)*∫(tan((~c) + (~d)*(~x)), (~x)) : nothing)

#(* Int[(a_+b_.*tan[c_.+d_.*x_])^n_,x_Symbol] := Int[ExpandIntegrand[(a+b*Tan[c+d*x])^n,x],x] /; FreeQ[{a,b,c,d},x] && IGtQ[n,0] *)
("4_3_1_1_6",
@rule ∫(((~a) + (~!b)*tan((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~a)^2 + (~b)^2, 0) &&
    gt((~n), 1) ?
(~b)*((~a) + (~b)*tan((~c) + (~d)*(~x)))^((~n) - 1)⨸((~d)*((~n) - 1)) + 2*(~a)*∫(((~a) + (~b)*tan((~c) + (~d)*(~x)))^((~n) - 1), (~x)) : nothing)

("4_3_1_1_7",
@rule ∫(((~a) + (~!b)*tan((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~a)^2 + (~b)^2, 0) &&
    lt((~n), 0) ?
(~a)*((~a) + (~b)*tan((~c) + (~d)*(~x)))^(~n)⨸(2*(~b)*(~d)*(~n)) + 1⨸(2*(~a))*∫(((~a) + (~b)*tan((~c) + (~d)*(~x)))^((~n) + 1), (~x)) : nothing)

("4_3_1_1_8",
@rule ∫(sqrt((~a) + (~!b)*tan((~!c) + (~!d)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    eq((~a)^2 + (~b)^2, 0) ?
-2*(~b)⨸(~d)*int_and_subst(1⨸(2*(~a) - (~x)^2),  (~x), (~x), sqrt((~a) + (~b)*tan((~c) + (~d)*(~x))), "4_3_1_1_8") : nothing)

("4_3_1_1_9",
@rule ∫(((~a) + (~!b)*tan((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~n), (~x)) &&
    eq((~a)^2 + (~b)^2, 0) ?
-(~b)⨸(~d)*int_and_subst(((~a) + (~x))^((~n) - 1)⨸((~a) - (~x)),  (~x), (~x), (~b)*tan((~c) + (~d)*(~x)), "4_3_1_1_9") : nothing)

("4_3_1_1_10",
@rule ∫(((~a) + (~!b)*tan((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    gt((~n), 1) ?
(~b)*((~a) + (~b)*tan((~c) + (~d)*(~x)))^((~n) - 1)⨸((~d)*((~n) - 1)) + ∫(((~a)^2 - (~b)^2 + 2*(~a)*(~b)*tan((~c) + (~d)*(~x)))*((~a) + (~b)*tan((~c) + (~d)*(~x)))^((~n) - 2), (~x)) : nothing)

("4_3_1_1_11",
@rule ∫(((~a) + (~!b)*tan((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) &&
    lt((~n), -1) ?
(~b)*((~a) + (~b)*tan((~c) + (~d)*(~x)))^((~n) + 1)⨸((~d)*((~n) + 1)*((~a)^2 + (~b)^2)) + 1⨸((~a)^2 + (~b)^2)* ∫(((~a) - (~b)*tan((~c) + (~d)*(~x)))*((~a) + (~b)*tan((~c) + (~d)*(~x)))^((~n) + 1), (~x)) : nothing)

("4_3_1_1_12",
@rule ∫(1/((~a) + (~!b)*tan((~!c) + (~!d)*(~x))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) ?
(~a)*(~x)⨸((~a)^2 + (~b)^2) + (~b)⨸((~a)^2 + (~b)^2)*∫(((~b) - (~a)*tan((~c) + (~d)*(~x)))⨸((~a) + (~b)*tan((~c) + (~d)*(~x))), (~x)) : nothing)

("4_3_1_1_13",
@rule ∫(((~a) + (~!b)*tan((~!c) + (~!d)*(~x)))^(~n),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~n), (~x)) &&
    !eq((~a)^2 + (~b)^2, 0) ?
(~b)⨸(~d)*int_and_subst(((~a) + (~x))^(~n)⨸((~b)^2 + (~x)^2),  (~x), (~x), (~b)*tan((~c) + (~d)*(~x)), "4_3_1_1_13") : nothing)


]
