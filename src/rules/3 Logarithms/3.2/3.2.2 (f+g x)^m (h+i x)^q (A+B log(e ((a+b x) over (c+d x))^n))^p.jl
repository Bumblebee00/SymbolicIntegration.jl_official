file_rules = [
#(* ::Subsection::Closed:: *)
#(* 3.2.2 (f+g x)^m (h+i x)^q (A+B log(e ((a+b x) over (c+d x))^n))^p *)
("3_2_2_1",
@rule ∫(((~!f) + (~!g)*(~x))^ (~!m)*((~!h) + (~!i)*(~x))*((~!A) + (~!B)*log((~!e)*(((~!a) + (~!b)*(~x))/((~!c) + (~!d)*(~x)))^(~!n))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~m), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~b)*(~f) - (~a)*(~g), 0) &&
    eq((~d)*(~h) - (~c)*(~i), 0) &&
    igt((~m), -2) ?
((~f) + (~g)*(~x))^((~m) + 1)*((~h) + (~i)*(~x))*((~A) + (~B)*log((~e)*(((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)))^(~n)))⨸((~g)*((~m) + 2)) + (~i)*((~b)*(~c) - (~a)*(~d))⨸((~b)*(~d)*((~m) + 2))* ∫(((~f) + (~g)*(~x))^(~m)*((~A) - (~B)*(~n) + (~B)*log((~e)*(((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)))^(~n))), (~x)) : nothing)

("3_2_2_2",
@rule ∫(((~!f) + (~!g)*(~x))^ (~!m)*((~!h) + (~!i)*(~x))*((~!A) + (~!B)*log((~!e)*((~!a) + (~!b)*(~x))^(~!n)*((~!c) + (~!d)*(~x))^(~mn))),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~m), (~n), (~x)) &&
    eq((~n) + (~mn), 0) &&
    igt((~n), 0) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~b)*(~f) - (~a)*(~g), 0) &&
    eq((~d)*(~h) - (~c)*(~i), 0) &&
    igt((~m), -2) ?
((~f) + (~g)*(~x))^((~m) + 1)*((~h) + (~i)*(~x))*((~A) + (~B)*log((~e)*((~a) + (~b)*(~x))^(~n)⨸((~c) + (~d)*(~x))^(~n)))⨸((~g)*((~m) + 2)) + (~i)*((~b)*(~c) - (~a)*(~d))⨸((~b)*(~d)*((~m) + 2))* ∫(((~f) + (~g)*(~x))^(~m)*((~A) - (~B)*(~n) + (~B)*log((~e)*((~a) + (~b)*(~x))^(~n)⨸((~c) + (~d)*(~x))^(~n))), (~x)) : nothing)

("3_2_2_3",
@rule ∫(((~!f) + (~!g)*(~x))^(~!m)*((~!h) + (~!i)*(~x))^ (~!q)*((~!A) + (~!B)*log((~!e)*(((~!a) + (~!b)*(~x))/((~!c) + (~!d)*(~x)))^(~!n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~n), (~p), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~b)*(~f) - (~a)*(~g), 0) &&
    eq((~d)*(~h) - (~c)*(~i), 0) &&
    ext_isinteger((~m), (~q)) ?
((~b)*(~c) - (~a)*(~d))^((~m) + (~q) + 1)*((~g)⨸(~b))^(~m)*((~i)⨸(~d))^(~q)* int_and_subst((~x)^(~m)*((~A) + (~B)*log((~e)*(~x)^(~n)))^(~p)⨸((~b) - (~d)*(~x))^((~m) + (~q) + 2),  (~x), (~x), ((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)), "3_2_2_3") : nothing)

("3_2_2_4",
@rule ∫(((~!f) + (~!g)*(~x))^(~!m)*((~!h) + (~!i)*(~x))^ (~!q)*((~!A) + (~!B)*log((~!e)*((~!a) + (~!b)*(~x))^(~!n)*((~!c) + (~!d)*(~x))^(~mn)))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~n), (~p), (~x)) &&
    eq((~n) + (~mn), 0) &&
    igt((~n), 0) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~b)*(~f) - (~a)*(~g), 0) &&
    eq((~d)*(~h) - (~c)*(~i), 0) &&
    ext_isinteger((~m), (~q)) ?
((~b)*(~c) - (~a)*(~d))^((~m) + (~q) + 1)*((~g)⨸(~b))^(~m)*((~i)⨸(~d))^(~q)* int_and_subst((~x)^(~m)*((~A) + (~B)*log((~e)*(~x)^(~n)))^(~p)⨸((~b) - (~d)*(~x))^((~m) + (~q) + 2),  (~x), (~x), ((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)), "3_2_2_4") : nothing)

("3_2_2_5",
@rule ∫(((~!f) + (~!g)*(~x))^(~!m)*((~!h) + (~!i)*(~x))^ (~!q)*((~!A) + (~!B)*log((~!e)*(((~!a) + (~!b)*(~x))/((~!c) + (~!d)*(~x)))^(~!n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~m), (~n), (~p), (~q), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~b)*(~f) - (~a)*(~g), 0) &&
    eq((~d)*(~h) - (~c)*(~i), 0) &&
    eq((~m) + (~q) + 2, 0) ?
(~d)^2*((~g)*((~a) + (~b)*(~x))⨸(~b))^ (~m)⨸((~i)^2*((~b)*(~c) - (~a)*(~d))*((~i)*((~c) + (~d)*(~x))⨸(~d))^(~m)*(((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)))^(~m))* int_and_subst((~x)^(~m)*((~A) + (~B)*log((~e)*(~x)^(~n)))^(~p),  (~x), (~x), ((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)), "3_2_2_5") : nothing)

("3_2_2_6",
@rule ∫(((~!f) + (~!g)*(~x))^(~!m)*((~!h) + (~!i)*(~x))^ (~!q)*((~!A) + (~!B)*log((~!e)*((~!a) + (~!b)*(~x))^(~!n)*((~!c) + (~!d)*(~x))^(~mn)))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~m), (~n), (~p), (~q), (~x)) &&
    eq((~n) + (~mn), 0) &&
    igt((~n), 0) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    eq((~b)*(~f) - (~a)*(~g), 0) &&
    eq((~d)*(~h) - (~c)*(~i), 0) &&
    eq((~m) + (~q) + 2, 0) ?
(~d)^2*((~g)*((~a) + (~b)*(~x))⨸(~b))^ (~m)⨸((~i)^2*((~b)*(~c) - (~a)*(~d))*((~i)*((~c) + (~d)*(~x))⨸(~d))^(~m)*(((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)))^(~m))* int_and_subst((~x)^(~m)*((~A) + (~B)*log((~e)*(~x)^(~n)))^(~p),  (~x), (~x), ((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)), "3_2_2_6") : nothing)

#(* Int[(f_.+g_.*x_)^m_.*(h_.+i_.*x_)^q_.*(A_.+B_.*Log[e_.*(a_.+b_.*x_) ^n_.*(c_.+d_.*x_)^mn_])^p_.,x_Symbol] := b*d*(f+g*x)^(m+1)/(g*i*(b*c-a*d)*(h+i*x)^(m+1)*((a+b*x)/(c+d*x))^(m+ 1))* Subst[Int[x^m*(A+B*Log[e*x^n])^p,x],x,(a+b*x)/(c+d*x)] /; FreeQ[{a,b,c,d,e,f,g,h,i,A,B,m,n,p,q},x] && EqQ[n+mn,0] &&  NeQ[b*c-a*d,0] && EqQ[b*f-a*g,0] && EqQ[d*h-c*i,0] && EqQ[m+q+2,0] *)
("3_2_2_7",
@rule ∫(((~!f) + (~!g)*(~x))^(~!m)*((~!h) + (~!i)*(~x))^ (~!q)*((~!A) + (~!B)*log((~!e)*(((~!a) + (~!b)*(~x))/((~!c) + (~!d)*(~x)))^(~!n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    ext_isinteger((~m), (~q)) &&
    igt((~p), 0) &&
    eq((~d)*(~h) - (~c)*(~i), 0) ?
((~b)*(~c) - (~a)*(~d))^((~q) + 1)*((~i)⨸(~d))^(~q)* int_and_subst(((~b)*(~f) - (~a)*(~g) - ((~d)*(~f) - (~c)*(~g))*(~x))^ (~m)*((~A) + (~B)*log((~e)*(~x)^(~n)))^(~p)⨸((~b) - (~d)*(~x))^((~m) + (~q) + 2),  (~x), (~x), ((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)), "3_2_2_7") : nothing)

("3_2_2_8",
@rule ∫(((~!f) + (~!g)*(~x))^(~!m)*((~!h) + (~!i)*(~x))^ (~!q)*((~!A) + (~!B)*log((~!e)*((~!a) + (~!b)*(~x))^(~!n)*((~!c) + (~!d)*(~x))^(~mn)))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~n), (~x)) &&
    eq((~n) + (~mn), 0) &&
    igt((~n), 0) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    ext_isinteger((~m), (~q)) &&
    igt((~p), 0) &&
    eq((~d)*(~h) - (~c)*(~i), 0) ?
((~b)*(~c) - (~a)*(~d))^((~q) + 1)*((~i)⨸(~d))^(~q)* int_and_subst(((~b)*(~f) - (~a)*(~g) - ((~d)*(~f) - (~c)*(~g))*(~x))^ (~m)*((~A) + (~B)*log((~e)*(~x)^(~n)))^(~p)⨸((~b) - (~d)*(~x))^((~m) + (~q) + 2),  (~x), (~x), ((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)), "3_2_2_8") : nothing)

("3_2_2_9",
@rule ∫(((~!f) + (~!g)*(~x))^(~!m)*((~!h) + (~!i)*(~x))^ (~!q)*((~!A) + (~!B)*log((~!e)*(((~!a) + (~!b)*(~x))/((~!c) + (~!d)*(~x)))^(~!n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~n), (~x)) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    ext_isinteger((~m), (~q)) &&
    igt((~p), 0) ?
((~b)*(~c) - (~a)*(~d))* int_and_subst(((~b)*(~f) - (~a)*(~g) - ((~d)*(~f) - (~c)*(~g))*(~x))^ (~m)*((~b)*(~h) - (~a)*(~i) - ((~d)*(~h) - (~c)*(~i))*(~x))^ (~q)*((~A) + (~B)*log((~e)*(~x)^(~n)))^(~p)⨸((~b) - (~d)*(~x))^((~m) + (~q) + 2),  (~x), (~x), ((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)), "3_2_2_9") : nothing)

("3_2_2_10",
@rule ∫(((~!f) + (~!g)*(~x))^(~!m)*((~!h) + (~!i)*(~x))^ (~!q)*((~!A) + (~!B)*log((~!e)*((~!a) + (~!b)*(~x))^(~!n)*((~!c) + (~!d)*(~x))^(~mn)))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~n), (~x)) &&
    eq((~n) + (~mn), 0) &&
    igt((~n), 0) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    ext_isinteger((~m), (~q)) &&
    igt((~p), 0) ?
((~b)*(~c) - (~a)*(~d))* int_and_subst(((~b)*(~f) - (~a)*(~g) - ((~d)*(~f) - (~c)*(~g))*(~x))^ (~m)*((~b)*(~h) - (~a)*(~i) - ((~d)*(~h) - (~c)*(~i))*(~x))^ (~q)*((~A) + (~B)*log((~e)*(~x)^(~n)))^(~p)⨸((~b) - (~d)*(~x))^((~m) + (~q) + 2),  (~x), (~x), ((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)), "3_2_2_10") : nothing)

# ("3_2_2_11",
# @rule ∫(((~!f) + (~!g)*(~x))^(~!m)*((~!h) + (~!i)*(~x))^ (~!q)*((~!A) + (~!B)*log((~!e)*(((~!a) + (~!b)*(~x))/((~!c) + (~!d)*(~x)))^(~!n)))^(~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~m), (~n), (~p), (~q), (~x)) ?
# Unintegrable[((~f) + (~g)*(~x))^(~m)*((~h) + (~i)*(~x))^ (~q)*((~A) + (~B)*log((~e)*(((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)))^(~n)))^(~p), (~x)] : nothing)

# ("3_2_2_12",
# @rule ∫(((~!f) + (~!g)*(~x))^(~!m)*((~!h) + (~!i)*(~x))^ (~!q)*((~!A) + (~!B)*log((~!e)*((~!a) + (~!b)*(~x))^(~!n)*((~!c) + (~!d)*(~x))^(~mn)))^ (~!p),(~x)) =>
#     !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~i), (~A), (~B), (~m), (~n), (~p), (~q), (~x)) &&
#     eq((~n) + (~mn), 0) &&
#     ext_isinteger((~n)) ?
# Unintegrable[((~f) + (~g)*(~x))^(~m)*((~h) + (~i)*(~x))^ (~q)*((~A) + (~B)*log((~e)*((~a) + (~b)*(~x))^(~n)⨸((~c) + (~d)*(~x))^(~n)))^(~p), (~x)] : nothing)

("3_2_2_13",
@rule ∫((~w)^(~!m)*(~y)^(~!q)*((~!A) + (~!B)*log((~!e)*((~u)/(~v))^(~!n)))^(~!p),(~x)) =>
    !contains_var((~e), (~A), (~B), (~m), (~n), (~p), (~q), (~x)) &&
    linear((~u), (~v), (~w), (~y), (~x)) &&
    !(linear_without_simplify((~u), (~v), (~w), (~y), (~x))) ?
∫(expand_to_sum((~w), (~x))^(~m)* expand_to_sum((~y), (~x))^ (~q)*((~A) + (~B)*log((~e)*(expand_to_sum((~u), (~x))⨸expand_to_sum((~v), (~x)))^(~n)))^(~p), (~x)) : nothing)

("3_2_2_14",
@rule ∫((~w)^(~!m)*(~y)^(~!q)*((~!A) + (~!B)*log((~!e)*(~u)^(~!n)*(~v)^(~mn)))^(~!p),(~x)) =>
    !contains_var((~e), (~A), (~B), (~m), (~n), (~p), (~q), (~x)) &&
    eq((~n) + (~mn), 0) &&
    igt((~n), 0) &&
    linear((~u), (~v), (~w), (~y), (~x)) &&
    !(linear_without_simplify((~u), (~v), (~w), (~y), (~x))) ?
∫(expand_to_sum((~w), (~x))^(~m)* expand_to_sum((~y), (~x))^ (~q)*((~A) + (~B)*log((~e)*expand_to_sum((~u), (~x))^(~n)⨸expand_to_sum((~v), (~x))^(~n)))^(~p), (~x)) : nothing)

("3_2_2_15",
@rule ∫((~!w)*((~!A) + (~!B)*log((~!e)*(~u)^(~!n)*(~v)^(~mn)))^(~!p),(~x)) =>
    !contains_var((~e), (~A), (~B), (~n), (~p), (~x)) &&
    eq((~n) + (~mn), 0) &&
    linear((~u), (~v), (~x)) &&
    !(ext_isinteger((~n))) ?
int_and_subst((~w)*((~A) + (~B)*log((~e)*((~u)⨸(~v))^(~n)))^(~p),  (~x), (~e)*((~u)⨸(~v))^(~n), (~e)*(~u)^(~n)⨸(~v)^(~n), "3_2_2_15") : nothing)

#(* Int[w_.*(A_.+B_.*Log[e_.*(f_.*u_^q_.*v_^mq_)^n_.])^p_.,x_Symbol] := Subst[Int[w*(A+B*Log[e*f^n*(u/v)^(n*q)])^p,x],e*f^n*(u/v)^(n*q),e*( f*(u^q/v^q))^n] /; FreeQ[{e,f,A,B,n,p,q},x] && EqQ[q+mq,0] && LinearQ[{u,v},x] &&  Not[IntegerQ[n]] *)
("3_2_2_16",
@rule ∫(((~!f) + (~!g)*(~x) + (~!h)*(~x)^2)^ (~!m)*((~!A) + (~!B)*log((~!e)*(((~!a) + (~!b)*(~x))/((~!c) + (~!d)*(~x)))^(~!n)))^(~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~A), (~B), (~n), (~p), (~x)) &&
    eq((~b)*(~d)*(~f) - (~a)*(~c)*(~h), 0) &&
    eq((~b)*(~d)*(~g) - (~h)*((~b)*(~c) + (~a)*(~d)), 0) &&
    ext_isinteger((~m)) ?
(~h)^(~m)⨸((~b)^(~m)*(~d)^(~m))* ∫(((~a) + (~b)*(~x))^(~m)*((~c) + (~d)*(~x))^(~m)*((~A) + (~B)*log((~e)*(((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)))^(~n)))^ (~p), (~x)) : nothing)

("3_2_2_17",
@rule ∫(((~!f) + (~!g)*(~x) + (~!h)*(~x)^2)^ (~!m)*((~!A) + (~!B)*log((~!e)*((~!a) + (~!b)*(~x))^(~!n)*((~!c) + (~!d)*(~x))^(~mn)))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~f), (~g), (~h), (~A), (~B), (~n), (~p), (~x)) &&
    eq((~n) + (~mn), 0) &&
    igt((~n), 0) &&
    eq((~b)*(~d)*(~f) - (~a)*(~c)*(~h), 0) &&
    eq((~b)*(~d)*(~g) - (~h)*((~b)*(~c) + (~a)*(~d)), 0) &&
    ext_isinteger((~m)) ?
(~h)^(~m)⨸((~b)^(~m)*(~d)^(~m))* ∫(((~a) + (~b)*(~x))^(~m)*((~c) + (~d)*(~x))^(~m)*((~A) + (~B)*log((~e)*((~a) + (~b)*(~x))^(~n)⨸((~c) + (~d)*(~x))^(~n)))^ (~p), (~x)) : nothing)

("3_2_2_18",
@rule ∫((~Px)^(~!m)*((~!A) + (~!B)*log((~!e)*(((~!a) + (~!b)*(~x))/((~!c) + (~!d)*(~x)))^(~!n)))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~n), (~x)) &&
    poly((~Px), (~x), 2) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    ext_isinteger((~m)) &&
    igt((~p), 0) ?
((~b)*(~c) - (~a)*(~d))* int_and_subst(((~b)^2*ext_coeff((~Px),  (~x), 0) - (~a)*(~b)*ext_coeff((~Px), (~x), 1) + (~a)^2*ext_coeff((~Px), (~x), 2) - (2*(~b)*(~d)*ext_coeff((~Px), (~x), 0) - (~b)*(~c)*ext_coeff((~Px), (~x), 1) - (~a)*(~d)*ext_coeff((~Px), (~x), 1) + 2*(~a)*(~c)*ext_coeff((~Px), (~x), 2))* (~x) + ((~d)^2*ext_coeff((~Px), (~x), 0) - (~c)*(~d)*ext_coeff((~Px), (~x), 1) + (~c)^2*ext_coeff((~Px), (~x), 2))*(~x)^2)^(~m)*((~A) + (~B)*log((~e)*(~x)^(~n)))^(~p)⨸ ((~b) - (~d)*(~x))^(2*((~m) + 1)), (~x), (~x), ((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)), "3_2_2_18") : nothing)

("3_2_2_19",
@rule ∫((~Px)^ (~!m)*((~!A) + (~!B)*log((~!e)*((~!a) + (~!b)*(~x))^(~!n)*((~!c) + (~!d)*(~x))^(~mn)))^ (~!p),(~x)) =>
    !contains_var((~a), (~b), (~c), (~d), (~e), (~A), (~B), (~n), (~x)) &&
    poly((~Px), (~x), 2) &&
    eq((~n) + (~mn), 0) &&
    igt((~n), 0) &&
    !eq((~b)*(~c) - (~a)*(~d), 0) &&
    ext_isinteger((~m)) &&
    igt((~p), 0) ?
((~b)*(~c) - (~a)*(~d))* int_and_subst(((~b)^2*ext_coeff((~Px),  (~x), 0) - (~a)*(~b)*ext_coeff((~Px), (~x), 1) + (~a)^2*ext_coeff((~Px), (~x), 2) - (2*(~b)*(~d)*ext_coeff((~Px), (~x), 0) - (~b)*(~c)*ext_coeff((~Px), (~x), 1) - (~a)*(~d)*ext_coeff((~Px), (~x), 1) + 2*(~a)*(~c)*ext_coeff((~Px), (~x), 2))* (~x) + ((~d)^2*ext_coeff((~Px), (~x), 0) - (~c)*(~d)*ext_coeff((~Px), (~x), 1) + (~c)^2*ext_coeff((~Px), (~x), 2))*(~x)^2)^(~m)*((~A) + (~B)*log((~e)*(~x)^(~n)))^(~p)⨸ ((~b) - (~d)*(~x))^(2*((~m) + 1)), (~x), (~x), ((~a) + (~b)*(~x))⨸((~c) + (~d)*(~x)), "3_2_2_19") : nothing)


]
